import{_ as s,c as a,o as n,a as l}from"./app.dd805ce0.js";const o="/assets/image-20221105163155285.b97e917a.png",p="/assets/image-20221106145314947.f6848d9f.png",e="/assets/image-20221106142436123.b3c0757c.png",t="/assets/image-20221106142504364.f2225747.png",r="/assets/image-20221106142517637.e6d6cef8.png",c="/assets/image-20221106142526421.d29e8e88.png",g=JSON.parse('{"title":"Osgeo(Gdal3.4.3) --笔记","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、gdal","slug":"一、gdal","link":"#一、gdal","children":[{"level":3,"title":"1.打开栅格数据集","slug":"_1-打开栅格数据集","link":"#_1-打开栅格数据集","children":[]},{"level":3,"title":"2.查看栅格数据集的信息","slug":"_2-查看栅格数据集的信息","link":"#_2-查看栅格数据集的信息","children":[]},{"level":3,"title":"3.查看单波段信息","slug":"_3-查看单波段信息","link":"#_3-查看单波段信息","children":[]},{"level":3,"title":"4.创建一个栅格数据集","slug":"_4-创建一个栅格数据集","link":"#_4-创建一个栅格数据集","children":[]},{"level":3,"title":"5.矢量边界裁剪（掩膜提取）","slug":"_5-矢量边界裁剪-掩膜提取","link":"#_5-矢量边界裁剪-掩膜提取","children":[]},{"level":3,"title":"6.坐标转换","slug":"_6-坐标转换","link":"#_6-坐标转换","children":[]},{"level":3,"title":"7.波段运算（如NDVI）","slug":"_7-波段运算-如ndvi","link":"#_7-波段运算-如ndvi","children":[]},{"level":3,"title":"8.等高线","slug":"_8-等高线","link":"#_8-等高线","children":[]},{"level":3,"title":"9.坡度/坡向/山体阴影","slug":"_9-坡度-坡向-山体阴影","link":"#_9-坡度-坡向-山体阴影","children":[]}]},{"level":2,"title":"二、ogr","slug":"二、ogr","link":"#二、ogr","children":[{"level":3,"title":"1.driver","slug":"_1-driver","link":"#_1-driver","children":[]},{"level":3,"title":"2.datasocurce","slug":"_2-datasocurce","link":"#_2-datasocurce","children":[]},{"level":3,"title":"3.layer","slug":"_3-layer","link":"#_3-layer","children":[]},{"level":3,"title":"4.feature","slug":"_4-feature","link":"#_4-feature","children":[]},{"level":3,"title":"5.geometry","slug":"_5-geometry","link":"#_5-geometry","children":[]},{"level":3,"title":"6.geometry的常用空间分析","slug":"_6-geometry的常用空间分析","link":"#_6-geometry的常用空间分析","children":[]},{"level":3,"title":"7.layer的常用空间分析","slug":"_7-layer的常用空间分析","link":"#_7-layer的常用空间分析","children":[]}]}],"relativePath":"python/Osgeo.md","lastUpdated":1669705325000}'),F={name:"python/Osgeo.md"},D=l('<h1 id="osgeo-gdal3-4-3-笔记" tabindex="-1">Osgeo(Gdal3.4.3) --笔记 <a class="header-anchor" href="#osgeo-gdal3-4-3-笔记" aria-hidden="true">#</a></h1><blockquote><p>osgeo: gdal + ogr</p><p>具体再需要确定什么去官网 <a href="https://gdal.org/" target="_blank" rel="noreferrer">https://gdal.org/</a></p></blockquote><p><img src="'+o+'" alt="image-20221105163155285"></p><p><img src="'+p+`" alt="image-20221106145314947"></p><h2 id="一、gdal" tabindex="-1">一、gdal <a class="header-anchor" href="#一、gdal" aria-hidden="true">#</a></h2><h3 id="_1-打开栅格数据集" tabindex="-1">1.打开栅格数据集 <a class="header-anchor" href="#_1-打开栅格数据集" aria-hidden="true">#</a></h3><ul><li><p>Rasterdataset = ‘geotiff.tif’</p></li><li><p>Datasource = <strong>gdal.Open</strong>(RasterDataset)</p><ul><li>rasterDataset:栅格数据所在路径及栅格数据名称</li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">设置栅格配置信息</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@DriverName：具体的驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source：栅格数据的路径</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRasterConfig</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">DriverName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">DriverName</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#设置驱动</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> dataSource</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">读取栅格信息</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@RasterObject:已经得到的栅格数据集对象</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readRaster</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">RasterObject</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    xRowNum </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">RasterXSize</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">栅格数据x方向的像素数</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> xRowNum </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    yRowNum </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">RasterYSize</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">栅格数据y方向的像素数</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> yRowNum </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    bandCountNum </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">RasterCount</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">栅格数据的波段数（块）</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> bandCountNum </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    rasProjection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetProjection</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">获取栅格数据的坐标信息</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> rasProjection </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    rasSixList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetGeoTransform</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">列表信息六参数</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> rasSixList </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为4</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    band_arr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">ReadAsArray</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">这里我们测试波段一，共有7个波段</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> band_arr </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为5</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    sub_band </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">ReadAsArray</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">400</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">600</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">第400列，600行，10 * 10格子</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> sub_band </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">return索引值为6</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> xRowNum</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">yRowNum</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">bandCountNum</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">rasProjection</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">rasSixList</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">band_arr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">sub_band</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    tifpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">D:/data/python/gdal/image/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> tifpath </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">outPutImage/exampleOne</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    tifname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">enter_union.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    readResult </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRasterConfig</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> tifpath </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> tifname</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">readRaster</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">readResult</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div></li></ul><h3 id="_2-查看栅格数据集的信息" tabindex="-1">2.查看栅格数据集的信息 <a class="header-anchor" href="#_2-查看栅格数据集的信息" aria-hidden="true">#</a></h3><ul><li><p>Datasource.RasterXsize:栅格数据x方向的像素数</p></li><li><p>Datasource.RasterYsize:栅格数据y方向的像素数</p></li><li><p>Datasource.RasterCount:栅格数据的波段数（块）</p></li><li><p>Datasource.<strong>GetProjection</strong>()：获取栅格数据的坐标信息</p></li><li><p>Geoinfo <strong>=</strong> **datasource.**GetGeoTransform() //得到六参数信息</p><ul><li><p>返回的Geoinfo是一个列表(list)</p><ul><li>0：原点的X坐标</li><li>1：像素宽度，pixelwidth</li><li>2：x像素旋转（0°，正北向）</li><li>3.原点的Y坐标</li><li>4.y像素旋转（0°，正北向）</li><li>5.像素高度（负值）,pixelheight</li></ul></li><li><p>某一坐标对应像素的**相对位置（pixel,offset),即改坐标与左上角的相对位置</p><p>xOffset = int(x-originX)/PixelWidth</p><p>yOffset = int(y-originY)/PixelHeight</p></li></ul></li></ul><h3 id="_3-查看单波段信息" tabindex="-1">3.查看单波段信息 <a class="header-anchor" href="#_3-查看单波段信息" aria-hidden="true">#</a></h3><ul><li><p>Band = datasource.<strong>GetRasterBand</strong>(index):获取指定索引的波段</p><ul><li>Band.Xsize：某波段的x方向的像素数</li><li>Band.Ysize:某波段的y方向的像素数</li><li>Band.GetNoDataValue:NoData的值</li><li>Band.GetMaximum()：最大值</li><li>Band.GetMinimum()：最小值</li><li>Band.GetMetadata()：元数据</li><li>Band.ComputeRasterMinMax()：最大最小值</li></ul></li><li><p>读取波段某位置数值信息</p><ul><li><p><strong>Band.ReadAsArray</strong>([xoff],[yoff],[win_xsize],[win_ysize],[buf_xsize],[buf_ysize],[buf_obj])</p><ul><li>Xoff:列的起点，默认为0</li><li>Yoff:行的起点，默认为0</li><li>Win_xsize:要读取得列数，默认读取所有列</li><li>Win_ysize:要读取得行数，默认读取所有行</li><li>Buf_xsize:输出数组的列数，默认等于win_xsize,不等于数据将会重采样</li><li>Buf_ysize:输出数组的行数，默认等于win_ysize,不等于数据将会重采样</li><li>Buf_obj:存放数组，不同于numpy数组</li></ul></li><li><p>读取某个像素：ReadRasterAsArray(xoff,yoff,1,1):读取1*1矩阵</p><p>读取所有像素：ReadRasterAsArray(0,0,cols,rows)：读取cols*rows矩阵</p></li></ul></li></ul><h3 id="_4-创建一个栅格数据集" tabindex="-1">4.创建一个栅格数据集 <a class="header-anchor" href="#_4-创建一个栅格数据集" aria-hidden="true">#</a></h3><ul><li><strong>outRaster=Driver.Create</strong>(filename,xsize,ysize,[bands],[data_type],[options]) <ul><li>Filename:创建的栅格数据集路径</li><li>Xsize：创建的栅格数据集的行数</li><li>Ysize:创建的栅格数据集的列数</li><li>Bands：创建的栅格数据集的波段数，默认为1</li><li>Data_type:存储在创建的栅格数据集中的数据类型，默认是GDT_Byte</li><li>Options:字符串列表，基于所创建的数据集的类型</li></ul></li><li>outRaster.SetProjection(prjinfo) #设置地理坐标信息</li><li>outRaster.SetGeoTransform(geoinfo) #设置六参数信息</li><li>outband = outRaster.GetRasterBand(<strong>index</strong>) <ul><li>OutRaster:新建的单波段或多波段栅格数据集</li><li>Index:新建的单波段或多波段的波段索引号</li></ul></li><li>outband.WriteArray(bandArray) <ul><li>bandArray:待写入的栅格数组，栅格数组写入outband</li><li>FlushCache():把缓存数据写入磁盘</li></ul></li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">设置栅格配置信息</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@DriverName：具体的驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source：栅格数据的路径</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRasterConfig</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">DriverName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">DriverName</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#设置驱动</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> dataSource</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">导出单个波段栅格影像</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@RasterObject：数据集对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outPath：输出路径</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">exportSingleRaster</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">RasterObject</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outPath</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    bandCount </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">RasterCount</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#波段数</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">range</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">bandCount</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        band </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#读取第一波段</span></span>
<span class="line"><span style="color:#A6ACCD;">        band_arr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> band</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ReadAsArray</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#读取二维数组</span></span>
<span class="line"><span style="color:#A6ACCD;">        gtiffDriver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        outPutImage </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gtiffDriver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Create</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outPath </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/exmaple</span><span style="color:#89DDFF;">&#39;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Result.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">                                         band</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">XSize</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> band</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">YSize</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> band</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">DataType</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建tif</span></span>
<span class="line"><span style="color:#A6ACCD;">        outPutImage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetProjection</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetProjection</span><span style="color:#89DDFF;">())</span><span style="color:#676E95;font-style:italic;">#设置坐标系</span></span>
<span class="line"><span style="color:#A6ACCD;">        outPutImage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetGeoTransform</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">RasterObject</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetGeoTransform</span><span style="color:#89DDFF;">())</span><span style="color:#676E95;font-style:italic;">#设置六参数</span></span>
<span class="line"><span style="color:#A6ACCD;">        outband </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> outPutImage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建第一波段</span></span>
<span class="line"><span style="color:#A6ACCD;">        outband</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteArray</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">band_arr</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#写入数组</span></span>
<span class="line"><span style="color:#A6ACCD;">        outPutImage</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">FlushCache</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">del</span><span style="color:#A6ACCD;"> outPutImage</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    tifpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> tifpath </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">outPutImage/exampleTwo</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    tifname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">union1234567.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    readResult </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setRasterConfig</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">tifpath </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/unionResult/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> tifname</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">exportSingleRaster</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">readResult</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">outpath</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-矢量边界裁剪-掩膜提取" tabindex="-1">5.矢量边界裁剪（掩膜提取） <a class="header-anchor" href="#_5-矢量边界裁剪-掩膜提取" aria-hidden="true">#</a></h3><ul><li>gdal.<strong>Warp</strong>(outTif,originRaster,format,cutlineDSName) <ul><li>outTif:剪裁后的栅格数据</li><li>originRaster：待剪裁的栅格数据</li><li>Format:栅格数据类型</li><li>cutlineDSName:矢量边界</li></ul></li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">裁剪栅格</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outPut：输出裁剪结果影像的路径</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@intPut：被裁减的原始影像</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Geoformat：栅格数据类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@featureShp：矢量图层</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ClipRaster</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">outPut</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">intPut</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">Geoformat</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">featureShp</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    source </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">intPut</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ClipProcess </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warp</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outPut</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">                            source</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">                            </span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> Geoformat</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">                            </span><span style="color:#A6ACCD;font-style:italic;">cutlineDSName</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> featureShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">                            </span><span style="color:#A6ACCD;font-style:italic;">cropToCutline</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">True)</span><span style="color:#676E95;font-style:italic;">#wrap是裁剪命令具体参数意思见前边</span></span>
<span class="line"><span style="color:#A6ACCD;">    ClipProcess</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">FlushCache</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">del</span><span style="color:#A6ACCD;"> ClipProcess</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    tifpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleTwo/exmaple1Result.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleFive/ClipResRaster.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    ClipShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/clip.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">ClipRaster</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outpath</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">tifpath</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">ClipShp</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_6-坐标转换" tabindex="-1">6.坐标转换 <a class="header-anchor" href="#_6-坐标转换" aria-hidden="true">#</a></h3><ul><li><p>import osr：导入osr模块</p></li><li><p>srs = osr.SpatialReference():创建一个空间参考对象</p></li><li><p>srs.ImportFromEPSG(Index)：根据EPSG的索引编号获取空间坐标信息</p></li><li><p>srs.ExportToWkt()：空间坐标信息导出为WKT格式</p></li><li><p>Gdal.warp(outtif,intif,format,srcSRS,dstSRS)</p><ul><li>Outtif:输出的数据</li><li>Intif:原始数据</li><li>Format:数据格式</li><li>srcSRS:原始数据空间坐标信息</li><li>dstSRS:输出数据空间坐标信息</li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> osr</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#source 要被读取的数据源</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnSrcPro</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#读取数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSourcePro </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetProjection</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#读取做消息</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> dataSource</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">dataSourcePro</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#proNumber EPSG的索引编号，用来获取空间坐标信息</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnOutPrj</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">proNumber</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    resPro </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> osr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SpatialReference</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#创建一个空间参考对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    resPro</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ImportFromEPSG</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">proNumber</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#这是个CGCS2000</span></span>
<span class="line"><span style="color:#A6ACCD;">    cgcs2000 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> resPro</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ExportToWkt</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#转wkt格式</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> cgcs2000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">转换原始影像坐标系</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outTif：输出的文件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@oriDataSou：原始影像数据集</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@format：驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@oriDataPro：原始影像坐标系</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@resPro：输出文件的坐标系</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">transPro</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">oriDataSou</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">oriDataPro</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">resPro</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Warp</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">oriDataSou</span><span style="color:#89DDFF;">,\\</span></span>
<span class="line"><span style="color:#82AAFF;">              </span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> format</span><span style="color:#89DDFF;">,\\</span></span>
<span class="line"><span style="color:#82AAFF;">              </span><span style="color:#A6ACCD;font-style:italic;">srcSRS</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> oriDataPro</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">\\</span></span>
<span class="line"><span style="color:#82AAFF;">              </span><span style="color:#A6ACCD;font-style:italic;">dstSRS</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> resPro</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#裁剪</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    intif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleEight/exmaple1Result.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outTif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleEight/exmaple2Result.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataOri </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnSrcPro</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">intif</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    resPrj </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnOutPrj</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">4527</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">transPro</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">],</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">],</span><span style="color:#82AAFF;">resPrj</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div></li></ul><h3 id="_7-波段运算-如ndvi" tabindex="-1">7.波段运算（如NDVI） <a class="header-anchor" href="#_7-波段运算-如ndvi" aria-hidden="true">#</a></h3><ul><li>Ndvi =（NIR-R）/(NIR+R) <ul><li>NIR:近红外波段</li><li>R：红光波段</li></ul></li><li>Landsat8波段： <ul><li>红光波段： band4</li><li>近红外波段：band5</li></ul></li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#source 原始影像数据源</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnOri</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#打开数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    band4Red </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">4</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#读取第四波段</span></span>
<span class="line"><span style="color:#A6ACCD;">    band5Nir </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#读取第五波段</span></span>
<span class="line"><span style="color:#A6ACCD;">    red4Array </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> band4Red</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ReadAsArray</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#读取数组</span></span>
<span class="line"><span style="color:#A6ACCD;">    nir5Array </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> band5Nir</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ReadAsArray</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#读取数组</span></span>
<span class="line"><span style="color:#A6ACCD;">    resArray </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">nir5Array </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> red4Array</span><span style="color:#89DDFF;">)/(</span><span style="color:#A6ACCD;">nir5Array </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> red4Array</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#计算ndvi</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> band4Red</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">dataSource</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">resArray</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">波段计算--ndvi</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@format：驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outTif：输出文件位置及文件名</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Xnumber：X方向像素数目</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Ynumber：Y方向像素数目</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@bandNumber：生成影像的波段数目</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataType：生成影像的数据类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Target：原始影像数据源，为了后面用它的坐标系</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@BandArray：需要被写入生成影像中的二维数组</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createOutTif</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">Xnumber</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">Ynumber</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">bandNumber</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">dataType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">Target</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">BandArray</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">format</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    out_tif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Create</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Xnumber</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Ynumber</span><span style="color:#89DDFF;">,\\</span></span>
<span class="line"><span style="color:#82AAFF;">                            bandNumber</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataType</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建影像</span></span>
<span class="line"><span style="color:#A6ACCD;">    out_tif</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetProjection</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">Target</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetProjection</span><span style="color:#89DDFF;">())</span><span style="color:#676E95;font-style:italic;">#设置坐标系</span></span>
<span class="line"><span style="color:#A6ACCD;">    out_tif</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetGeoTransform</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">Target</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetGeoTransform</span><span style="color:#89DDFF;">())</span><span style="color:#676E95;font-style:italic;">#设置六参数</span></span>
<span class="line"><span style="color:#A6ACCD;">    outBand </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> out_tif</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建第一波段</span></span>
<span class="line"><span style="color:#A6ACCD;">    outBand</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WriteArray</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">BandArray</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#写入数组</span></span>
<span class="line"><span style="color:#A6ACCD;">    out_tif</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">FlushCache</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">del</span><span style="color:#A6ACCD;"> out_tif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    intif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleNine/union1234567.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outTif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleNine/exampleNine.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataOri </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">returnOri</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">intif</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">createOutTif</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">].</span><span style="color:#F07178;">XSize</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">].</span><span style="color:#F07178;">YSize</span><span style="color:#89DDFF;">,\\</span></span>
<span class="line"><span style="color:#82AAFF;">                 </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">gdal</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">GDT_Float32</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">],</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">])</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h3 id="_8-等高线" tabindex="-1">8.等高线 <a class="header-anchor" href="#_8-等高线" aria-hidden="true">#</a></h3><ul><li>gdal.ContourGenerate(0，1，2，3，4，5，6，7，8，9,10) <ul><li>0：srtBand:dem波段</li><li>1：ContourInterval:等高线间隔的单位距离</li><li>2：ContourBase:等高线起始高度</li><li>3：fixedLevelCount:等高线固定距离（像对于间隔距离）</li><li>4：useNodata：是否使用nodata</li><li>5：noDataValue:nodata的值</li><li>6：dstLayer:输出等高线的矢量图层</li><li>7：idField:shappefile中必须有的dbf文件字段名称，通常为ID</li><li>8:elevField:shapefile中必须有的dbf字段名称，高程值</li><li>9:Callback:回调函数</li><li>10:Callback_data:回调函数值</li></ul></li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ogr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#source 待被读取的原始数据</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readOriTif</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    datasource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> datasource</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">生成等高线</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@format：驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outShp：输出文件的位置及文件名</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@shpName：文件名，不包含后缀</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataSource：原始数据的数据集</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CreateConLine</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outShp</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">shpName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">dataSource</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">format</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_ds </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr_driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateDataSource</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outShp</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_lyr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr_ds</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateLayer</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">shpName</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">geom_type</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wkbLineString25D</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建图层</span></span>
<span class="line"><span style="color:#A6ACCD;">    field_defn </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">FieldDefn</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ID</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">OFTInteger</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建属性字段</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_lyr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateField</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">field_defn</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    field_defn </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">FieldDefn</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ELEV</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">OFTReal</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_lyr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateField</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">field_defn</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ContourGenerate</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">dataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetRasterBand</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">8100</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">[],</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ogr_lyr</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#设置等高线的参数信息</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr_ds </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    intif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleTen/result.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    shpName </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">contour_3000</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleTen/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> shpName </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataOri </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readOriTif</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">intif</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">CreateConLine</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">outShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">shpName</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataOri</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_9-坡度-坡向-山体阴影" tabindex="-1">9.坡度/坡向/山体阴影 <a class="header-anchor" href="#_9-坡度-坡向-山体阴影" aria-hidden="true">#</a></h3><ul><li>gdal.DEMProcessing(outname,srcDS,processing,options)</li><li>Outname:输出数据名称 <ul><li>srcDS:dem名称</li></ul></li><li>Processing:处理过程（”slope”,”aspect”,”hillshade”, &quot;Roughness”…） <ul><li>Option:选择项: format = “GTiff”</li></ul></li></ul><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span style="color:#A6ACCD;">__author__ </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SmallTiger</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> osgeo </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> gdal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">坡度、坡向、山体阴影</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source：原始数据源</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@ProcessType：具体处理方案，坡度/坡向/山体阴影</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outTif：输出文件位置及文件名</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@format：数据类型</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CreateSpeDemPro</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">ProcessType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#打开数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ProcessType </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">slope</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">DEMProcessing</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">dataSource</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">slope</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> format</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#坡度</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">elif</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ProcessType </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aspect</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">        gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">DEMProcessing</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> dataSource</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aspect</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">format</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#坡向</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        gdal</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">DEMProcessing</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outTif</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> dataSource</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hillshade</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">format</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#山体阴影</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    iniTiff </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleEleven/result.tif</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outNameArr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">slope_1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aspect_1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hillshade_1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    outTif </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/images/outPutImage/exampleEleven/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">CreateSpeDemPro</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">iniTiff</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">slope</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">outTif </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">]</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">CreateSpeDemPro</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">iniTiff</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aspect</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> outTif </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">]</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">CreateSpeDemPro</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">iniTiff</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hillshade</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> outTif </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">]</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.tif</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GTiff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="二、ogr" tabindex="-1">二、ogr <a class="header-anchor" href="#二、ogr" aria-hidden="true">#</a></h2><h3 id="_1-driver" tabindex="-1">1.driver <a class="header-anchor" href="#_1-driver" aria-hidden="true">#</a></h3><ul><li>Driver = <strong>ogr.GetDriver</strong>**(index)<strong>:按照索引设置某类数据的驱动</strong></li><li><strong>Driver = <strong>0gr.GetDriverByName（”name”）</strong>:按照名称设置某类型数据的驱动</strong><ul><li><strong>Num <strong>=</strong> <strong>ogr.GetDriverCount</strong></strong>()<strong>：返回支持的驱动数目</strong></li><li><strong>Driver.<strong>Open</strong>(datapath):打开矢量数据</strong></li><li>**Driver.<strong>CreateDataSource</strong>(outpath)：创建矢量数据</li></ul></li></ul><h3 id="_2-datasocurce" tabindex="-1">2.datasocurce <a class="header-anchor" href="#_2-datasocurce" aria-hidden="true">#</a></h3><ul><li>Datasource = driver.Open(inshp) <ul><li>GetName():获取矢量数据源（路径）</li><li>GetLayer():获取矢量数据的图层</li><li>CreateLayer():创建矢量数据图层</li><li>CopyLayer():复制矢量数据图层</li><li>DeleteLayer():删除矢量数据图层</li><li>GetLayerCount():获取矢量数据的图层数量</li><li>GetLayerByIndex():按照索引号获取矢量数据图层</li><li>GetLayerByName():按照名称获取矢量数据图层</li><li>FlushCache():清除缓存</li></ul></li></ul><h3 id="_3-layer" tabindex="-1">3.layer <a class="header-anchor" href="#_3-layer" aria-hidden="true">#</a></h3><ul><li><strong>Layer</strong> =datasource.GetLayer(index) <ul><li>GetName():获取layer的名称</li><li>CreateFeature()：在layer中创建一个新的feature</li><li>DeleteFeature():删除layer中的某index的feature</li><li>GetFeatureCount():获取layer中的feature数量</li><li>GetExtend():获取layer范围</li><li>FindFieldIndex(fieldname,True):查找field的索引号</li><li>CreateField(fielddefn):根据属性表字段属性创建字段</li><li>DeleteField(index):按照索引号删除字段</li></ul></li></ul><h3 id="_4-feature" tabindex="-1">4.feature <a class="header-anchor" href="#_4-feature" aria-hidden="true">#</a></h3><ul><li><strong>Feature</strong> = layer.GetFeature(index) <ul><li>GetDefnRef():获取feature定义</li><li>GetGeometryRef():获取geometry(几何结构)</li><li>GetFieldCount():获取属性字段数量</li><li>GetFieldDefnRef():获取field定义 <ul><li>GetName():获取feature所在Layer名称</li><li>GetFieldCount():获取feature的字段数量</li><li>GetFieldIndex(fieldname):获取字段索引</li><li>GetFieldDefn():获取字段定义 <ul><li>GetName:获取字段名称</li><li>GetNameRef:获取字段名称</li><li>GetTypeName:获取字段内容类型</li></ul></li></ul></li><li>GetFieldIndex(fieldname):获取属性字段索引号</li><li>GetFID():获取feature的FID</li><li>ExportToJson()：输出为json</li></ul></li></ul><h3 id="_5-geometry" tabindex="-1">5.geometry <a class="header-anchor" href="#_5-geometry" aria-hidden="true">#</a></h3><ul><li><strong>Geometry</strong> = Feature.GetGeometryRef() <ul><li>ExportToWkt:导出为wkt格式</li><li>ExportToJson:导出为JSON格式</li><li>GetGeometryName():获取几何名称</li><li>Lengh()：获取几何长度</li><li>Area():获取几何面积</li><li>GetPointCount():获取矢量点数量</li><li>GetPoints():获取几何点列表</li><li>GetPoint(index):获取某个点坐标</li><li>GetX(index):获取某个点的X坐标</li><li>GetY(index):获取某个点的Y坐标</li><li>GetZ(index):获取某个点的Z坐标</li></ul></li></ul><h3 id="_6-geometry的常用空间分析" tabindex="-1">6.geometry的常用空间分析 <a class="header-anchor" href="#_6-geometry的常用空间分析" aria-hidden="true">#</a></h3><ol><li><p>Intersect 相交</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source:原始shp文件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataType:驱动类型</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">test_intersect</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dataType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">dataType</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#驱动</span></span>
<span class="line"><span style="color:#A6ACCD;">    dataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#打开数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr0 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> dataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#第一个图层</span></span>
<span class="line"><span style="color:#A6ACCD;">    feat1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> lyr0</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetFeature</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#第一个feature</span></span>
<span class="line"><span style="color:#A6ACCD;">    geom1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> feat1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetGeometryRef</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#几何结构</span></span>
<span class="line"><span style="color:#A6ACCD;">    feat2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> lyr0</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetFeature</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#第二个feature</span></span>
<span class="line"><span style="color:#A6ACCD;">    geom2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> feat2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetGeometryRef</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">#几何结构</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">geom1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Intersect</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">geom2</span><span style="color:#89DDFF;">))</span><span style="color:#676E95;font-style:italic;">#是否相交</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    inShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleNine/polygon.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">test_intersect</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">inShp</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">test_withIn</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> inShp</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div></li><li><p>Contain 包含</p></li><li><p>Within 被包含</p></li><li><p>Centriod 中心点坐标</p></li><li><p>Distance 空间距离</p></li><li><p>Intersection 相交部分</p><p><img src="`+e+'" alt="image-20221106142436123"></p></li><li><p>Buffer 缓冲区</p></li><li><p>Union 联合</p><p><img src="'+t+'" alt="image-20221106142504364"></p></li><li><p>Difference 几何对象1去掉几何对象2的部分</p><p><img src="'+r+'" alt="image-20221106142517637"></p></li><li><p>SymDifference 交集取反</p><p><img src="'+c+`" alt="image-20221106142526421"></p></li></ol><h3 id="_7-layer的常用空间分析" tabindex="-1">7.layer的常用空间分析 <a class="header-anchor" href="#_7-layer的常用空间分析" aria-hidden="true">#</a></h3><ol><li><p>intersect</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataType:驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source1:原始shp文件1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source2:原始shp文件2</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outPath:输出相交区域的shp文件</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">layerIntersection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dataType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outPath</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">dataType</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#驱动</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#第一个图层</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateDataSource</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outPath</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建数据源</span></span>
<span class="line"><span style="color:#A6ACCD;">    newLyr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateLayer</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testpolygon</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">geom_type</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wkbPolygon</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#创建图层</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Layer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Intersection</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">lyr1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">lyr2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">newLyr</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#相交图层内容</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Destroy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    inSihuShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_sihu.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    inJiaweiShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_jiawei.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outNameArr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">interSec.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">union.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">symDiff.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">layerIntersection</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">inSihuShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">inJiaweiShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">outPath</span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;">outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">])</span></span>
<span class="line"></span></code></pre></div></li><li><p>union</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataType:驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source1:原始shp文件1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source2:原始shp文件2</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outPath:输出合并区域的shp文件</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">layerUnion</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dataType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outPath</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">dataType</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateDataSource</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outPath</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    newLyr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateLayer</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testpolygon</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">geom_type</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wkbPolygon</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Layer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Union</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">lyr1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">lyr2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">newLyr</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#合并图层内容</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Destroy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    inSihuShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_sihu.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    inJiaweiShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_jiawei.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outNameArr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">interSec.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">union.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">symDiff.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">layerUnion</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> inSihuShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> inJiaweiShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> outPath </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">])</span></span>
<span class="line"></span></code></pre></div></li><li><p>symdifference</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight has-diff" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@dataType:驱动类型</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source1:原始shp文件1</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@source2:原始shp文件2</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@outPath:输出交集取反区域的shp文件</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">layerSymdiff</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dataType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">source2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">outPath</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    driver </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetDriverByName</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">dataType</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">    ds2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">source2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    lyr2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ds2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetLayer</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> driver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateDataSource</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">outPath</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    newLyr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">CreateLayer</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">testpolygon</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">geom_type</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;"> ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">wkbPolygon</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ogr</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Layer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SymDifference</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">lyr1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">lyr2</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">newLyr</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">#交集取反图层内容</span></span>
<span class="line"><span style="color:#A6ACCD;">    newDataSource</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Destroy</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    inSihuShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_sihu.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    inJiaweiShp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/polygon_jiawei.shp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">E:/ArcpyGIS/seconeTerm/shapeFile/exampleTen/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    outNameArr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">interSec.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">union.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">symDiff.shp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">layerSymdiff</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ESRI Shapefile</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> inSihuShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> inJiaweiShp</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> outPath </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> outNameArr</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">])</span></span>
<span class="line"></span></code></pre></div></li></ol><p>​</p>`,44),y=[D];function i(A,C,u,f,d,h){return n(),a("div",null,y)}const E=s(F,[["render",i]]);export{g as __pageData,E as default};
