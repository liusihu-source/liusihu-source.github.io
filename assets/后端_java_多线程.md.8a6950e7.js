import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.a7175731.js";const p="/assets/image-20230927104218212.144bce07.png",o="/assets/image-20230927104336369.26ef0710.png",e="/assets/image-20230927104427601.767ed1c2.png",t="/assets/image-20230927104442929.d39b2600.png",c="/assets/image-20230927104458885.cf163d8b.png",r="/assets/image-20230930190005687.48c7befb.png",E="/assets/image-20230927105116494.edf3c349.png",y="/assets/image-20230927105121034.31ad5900.png",i="/assets/image-20230927105141376.cbb0086a.png",F="/assets/image-20230927105148188.c1ff49c7.png",u="/assets/image-20231007183201654.d1e0fb48.png",d="/assets/image-20231007183328772.eb74457e.png",A="/assets/image-20231007183338745.95d2c692.png",h="/assets/image-20231007183416972.2beb3f9b.png",C="/assets/image-20231009180453045.48d12f9b.png",D="/assets/image-20231009181529118.d5b74b59.png",B="/assets/image-20231011121647445.e37e7eca.png",g="/assets/image-20231016161333269.243576c1.png",_=JSON.parse('{"title":"å¤šçº¿ç¨‹ --ç¬”è®°","description":"","frontmatter":{},"headers":[],"relativePath":"åç«¯/java/å¤šçº¿ç¨‹.md","filePath":"åç«¯/java/å¤šçº¿ç¨‹.md","lastUpdated":null}'),b={name:"åç«¯/java/å¤šçº¿ç¨‹.md"},m=l('<h1 id="å¤šçº¿ç¨‹-ç¬”è®°" tabindex="-1">å¤šçº¿ç¨‹ --ç¬”è®° <a class="header-anchor" href="#å¤šçº¿ç¨‹-ç¬”è®°" aria-label="Permalink to &quot;å¤šçº¿ç¨‹ --ç¬”è®°&quot;">â€‹</a></h1><h2 id="ä¸€ã€-ç›¸å…³æ¦‚å¿µ" tabindex="-1">ä¸€ã€ ç›¸å…³æ¦‚å¿µ <a class="header-anchor" href="#ä¸€ã€-ç›¸å…³æ¦‚å¿µ" aria-label="Permalink to &quot;ä¸€ã€ ç›¸å…³æ¦‚å¿µ&quot;">â€‹</a></h2><h3 id="_1-1-ç¨‹åºã€è¿›ç¨‹ä¸çº¿ç¨‹" tabindex="-1">1.1 ç¨‹åºã€è¿›ç¨‹ä¸çº¿ç¨‹ <a class="header-anchor" href="#_1-1-ç¨‹åºã€è¿›ç¨‹ä¸çº¿ç¨‹" aria-label="Permalink to &quot;1.1 ç¨‹åºã€è¿›ç¨‹ä¸çº¿ç¨‹&quot;">â€‹</a></h3><ul><li><p><strong>ç¨‹åºï¼ˆprogramï¼‰</strong>ï¼šä¸ºå®Œæˆç‰¹å®šä»»åŠ¡ï¼Œç”¨æŸç§è¯­è¨€ç¼–å†™çš„<code>ä¸€ç»„æŒ‡ä»¤çš„é›†åˆ</code>ã€‚å³æŒ‡<code>ä¸€æ®µé™æ€çš„ä»£ç </code>ï¼Œé™æ€å¯¹è±¡ã€‚</p></li><li><p><strong>è¿›ç¨‹ï¼ˆprocessï¼‰</strong>ï¼šç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ–æ˜¯æ­£åœ¨å†…å­˜ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚å¦‚ï¼šè¿è¡Œä¸­çš„QQï¼Œè¿è¡Œä¸­çš„ç½‘æ˜“éŸ³ä¹æ’­æ”¾å™¨ã€‚</p><ul><li>æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºã€è¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰</li><li>ç¨‹åºæ˜¯é™æ€çš„ï¼Œè¿›ç¨‹æ˜¯åŠ¨æ€çš„</li><li>è¿›ç¨‹ä½œä¸º<code>æ“ä½œç³»ç»Ÿè°ƒåº¦å’Œåˆ†é…èµ„æºçš„æœ€å°å•ä½</code>ï¼ˆäº¦æ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼‰ï¼Œç³»ç»Ÿåœ¨è¿è¡Œæ—¶ä¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸åŒçš„å†…å­˜åŒºåŸŸã€‚</li><li>ç°ä»£çš„æ“ä½œç³»ç»Ÿï¼Œå¤§éƒ½æ˜¯æ”¯æŒå¤šè¿›ç¨‹çš„ï¼Œæ”¯æŒåŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºã€‚æ¯”å¦‚ï¼šç°åœ¨æˆ‘ä»¬ä¸Šè¯¾ä¸€è¾¹ä½¿ç”¨ç¼–è¾‘å™¨ï¼Œä¸€è¾¹ä½¿ç”¨å½•å±è½¯ä»¶ï¼ŒåŒæ—¶è¿˜å¼€ç€ç”»å›¾æ¿ï¼Œdosçª—å£ç­‰è½¯ä»¶ã€‚</li></ul></li><li><p><strong>çº¿ç¨‹ï¼ˆthreadï¼‰</strong>ï¼šè¿›ç¨‹å¯è¿›ä¸€æ­¥ç»†åŒ–ä¸ºçº¿ç¨‹ï¼Œæ˜¯ç¨‹åºå†…éƒ¨çš„<code>ä¸€æ¡æ‰§è¡Œè·¯å¾„</code>ã€‚ä¸€ä¸ªè¿›ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p><ul><li><p>ä¸€ä¸ªè¿›ç¨‹åŒä¸€æ—¶é—´è‹¥<code>å¹¶è¡Œ</code>æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå°±æ˜¯æ”¯æŒå¤šçº¿ç¨‹çš„ã€‚</p><p><img src="'+p+'" alt="image-20230927104218212"></p></li><li><p>çº¿ç¨‹ä½œä¸º<code>CPUè°ƒåº¦å’Œæ‰§è¡Œçš„æœ€å°å•ä½</code>ã€‚</p></li><li><p>ä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å…±äº«ç›¸åŒçš„å†…å­˜å•å…ƒï¼Œå®ƒä»¬ä»åŒä¸€ä¸ªå †ä¸­åˆ†é…å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®ç›¸åŒçš„å˜é‡å’Œå¯¹è±¡ã€‚è¿™å°±ä½¿å¾—çº¿ç¨‹é—´é€šä¿¡æ›´ç®€ä¾¿ã€é«˜æ•ˆã€‚ä½†å¤šä¸ªçº¿ç¨‹æ“ä½œå…±äº«çš„ç³»ç»Ÿèµ„æºå¯èƒ½å°±ä¼šå¸¦æ¥<code>å®‰å…¨çš„éšæ‚£</code>ã€‚</p></li><li><p>ä¸‹å›¾ä¸­ï¼Œçº¢æ¡†çš„è“è‰²åŒºåŸŸä¸ºçº¿ç¨‹ç‹¬äº«ï¼Œé»„è‰²åŒºåŸŸä¸ºçº¿ç¨‹å…±äº«ã€‚</p></li></ul></li></ul><p><img src="'+o+'" alt="image-20230927104336369"></p><blockquote><p>æ³¨æ„ï¼š</p><p>ä¸åŒçš„è¿›ç¨‹ä¹‹é—´æ˜¯ä¸å…±äº«å†…å­˜çš„ã€‚</p><p>è¿›ç¨‹ä¹‹é—´çš„æ•°æ®äº¤æ¢å’Œé€šä¿¡çš„æˆæœ¬å¾ˆé«˜ã€‚</p></blockquote><h3 id="_1-2-æŸ¥çœ‹è¿›ç¨‹å’Œçº¿ç¨‹" tabindex="-1">1.2 æŸ¥çœ‹è¿›ç¨‹å’Œçº¿ç¨‹ <a class="header-anchor" href="#_1-2-æŸ¥çœ‹è¿›ç¨‹å’Œçº¿ç¨‹" aria-label="Permalink to &quot;1.2 æŸ¥çœ‹è¿›ç¨‹å’Œçº¿ç¨‹&quot;">â€‹</a></h3><p>æˆ‘ä»¬å¯ä»¥åœ¨ç”µè„‘åº•éƒ¨ä»»åŠ¡æ ï¼Œå³é”®-----&gt;æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ä»»åŠ¡çš„è¿›ç¨‹ï¼š</p><p>1ã€æ¯ä¸ªåº”ç”¨ç¨‹åºçš„è¿è¡Œéƒ½æ˜¯ä¸€ä¸ªè¿›ç¨‹</p><p><img src="'+e+'" alt="image-20230927104427601"></p><p>2ã€ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å¤šæ¬¡è¿è¡Œï¼Œå°±æ˜¯å¤šä¸ªè¿›ç¨‹</p><p><img src="'+t+'" alt="image-20230927104442929"></p><p>3ã€ä¸€ä¸ªè¿›ç¨‹ä¸­åŒ…å«å¤šä¸ªçº¿ç¨‹</p><p><img src="'+c+'" alt="image-20230927104458885"></p><h3 id="_1-3-çº¿ç¨‹è°ƒåº¦" tabindex="-1">1.3 çº¿ç¨‹è°ƒåº¦ <a class="header-anchor" href="#_1-3-çº¿ç¨‹è°ƒåº¦" aria-label="Permalink to &quot;1.3 çº¿ç¨‹è°ƒåº¦&quot;">â€‹</a></h3><ul><li><p><strong>åˆ†æ—¶è°ƒåº¦</strong></p><p>æ‰€æœ‰çº¿ç¨‹<code>è½®æµä½¿ç”¨</code> CPU çš„ä½¿ç”¨æƒï¼Œå¹¶ä¸”å¹³å‡åˆ†é…æ¯ä¸ªçº¿ç¨‹å ç”¨ CPU çš„æ—¶é—´ã€‚</p></li><li><p><strong>æŠ¢å å¼è°ƒåº¦</strong></p><p>è®©<code>ä¼˜å…ˆçº§é«˜</code>çš„çº¿ç¨‹ä»¥<code>è¾ƒå¤§çš„æ¦‚ç‡</code>ä¼˜å…ˆä½¿ç”¨ CPUã€‚å¦‚æœçº¿ç¨‹çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œé‚£ä¹ˆä¼šéšæœºé€‰æ‹©ä¸€ä¸ª(çº¿ç¨‹éšæœºæ€§)ï¼ŒJavaä½¿ç”¨çš„ä¸ºæŠ¢å å¼è°ƒåº¦ã€‚</p></li></ul><p><img src="'+r+'" alt="image-20230930190005687"></p><h3 id="_1-4-å¤šçº¿ç¨‹ç¨‹åºçš„ä¼˜ç‚¹" tabindex="-1">1.4 å¤šçº¿ç¨‹ç¨‹åºçš„ä¼˜ç‚¹ <a class="header-anchor" href="#_1-4-å¤šçº¿ç¨‹ç¨‹åºçš„ä¼˜ç‚¹" aria-label="Permalink to &quot;1.4 å¤šçº¿ç¨‹ç¨‹åºçš„ä¼˜ç‚¹&quot;">â€‹</a></h3><p>**èƒŒæ™¯ï¼š**ä»¥å•æ ¸CPUä¸ºä¾‹ï¼Œåªä½¿ç”¨å•ä¸ªçº¿ç¨‹å…ˆåå®Œæˆå¤šä¸ªä»»åŠ¡ï¼ˆè°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼‰ï¼Œè‚¯å®šæ¯”ç”¨å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆç”¨çš„æ—¶é—´æ›´çŸ­ï¼Œä¸ºä½•ä»éœ€å¤šçº¿ç¨‹å‘¢ï¼Ÿ</p><p><strong>å¤šçº¿ç¨‹ç¨‹åºçš„ä¼˜ç‚¹ï¼š</strong></p><ol><li><p>æé«˜åº”ç”¨ç¨‹åºçš„å“åº”ã€‚å¯¹å›¾å½¢åŒ–ç•Œé¢æ›´æœ‰æ„ä¹‰ï¼Œå¯å¢å¼ºç”¨æˆ·ä½“éªŒã€‚</p></li><li><p>æé«˜è®¡ç®—æœºç³»ç»ŸCPUçš„åˆ©ç”¨ç‡</p></li><li><p>æ”¹å–„ç¨‹åºç»“æ„ã€‚å°†æ—¢é•¿åˆå¤æ‚çš„è¿›ç¨‹åˆ†ä¸ºå¤šä¸ªçº¿ç¨‹ï¼Œç‹¬ç«‹è¿è¡Œï¼Œåˆ©äºç†è§£å’Œä¿®æ”¹</p></li></ol><h3 id="_1-5-è¡¥å……æ¦‚å¿µ" tabindex="-1">1.5 è¡¥å……æ¦‚å¿µ <a class="header-anchor" href="#_1-5-è¡¥å……æ¦‚å¿µ" aria-label="Permalink to &quot;1.5 è¡¥å……æ¦‚å¿µ&quot;">â€‹</a></h3><h4 id="_1-5-1-å•æ ¸cpuå’Œå¤šæ ¸cpu" tabindex="-1">1.5.1 å•æ ¸CPUå’Œå¤šæ ¸CPU <a class="header-anchor" href="#_1-5-1-å•æ ¸cpuå’Œå¤šæ ¸cpu" aria-label="Permalink to &quot;1.5.1 å•æ ¸CPUå’Œå¤šæ ¸CPU&quot;">â€‹</a></h4><p>å•æ ¸CPUï¼Œåœ¨ä¸€ä¸ªæ—¶é—´å•å…ƒå†…ï¼Œåªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æŠŠCPUçœ‹æˆæ˜¯åŒ»é™¢çš„åŒ»ç”Ÿè¯Šå®¤ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…åªèƒ½ç»™ä¸€ä¸ªç—…äººè¯Šæ–­æ²»ç–—ã€‚æ‰€ä»¥å•æ ¸CPUå°±æ˜¯ï¼Œä»£ç ç»è¿‡å‰é¢ä¸€ç³»åˆ—çš„å‰å¯¼æ“ä½œï¼ˆç±»ä¼¼äºåŒ»é™¢æŒ‚å·ï¼Œæ¯”å¦‚æœ‰10ä¸ªçª—å£æŒ‚å·ï¼‰ï¼Œç„¶ååˆ°cpuå¤„æ‰§è¡Œæ—¶å‘ç°ï¼Œå°±åªæœ‰ä¸€ä¸ªCPUï¼ˆå¯¹åº”ä¸€ä¸ªåŒ»ç”Ÿï¼‰ï¼Œå¤§å®¶æ’é˜Ÿæ‰§è¡Œã€‚</p><p>è¿™æ—¶å€™æƒ³è¦æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œåªæœ‰ä¸¤ä¸ªåŠæ³•ï¼Œè¦ä¹ˆæå‡CPUæ€§èƒ½ï¼ˆè®©åŒ»ç”Ÿçœ‹ç—…å¿«ç‚¹ï¼‰ï¼Œè¦ä¹ˆå¤šåŠ å‡ ä¸ªCPUï¼ˆå¤šæ•´å‡ ä¸ªåŒ»ç”Ÿï¼‰ï¼Œå³ä¸ºå¤šæ ¸çš„CPUã€‚</p><p><code>é—®é¢˜ï¼šå¤šæ ¸çš„æ•ˆç‡æ˜¯å•æ ¸çš„å€æ•°å—ï¼Ÿ</code>è­¬å¦‚4æ ¸A53çš„cpuï¼Œæ€§èƒ½æ˜¯å•æ ¸A53çš„4å€å—ï¼Ÿç†è®ºä¸Šæ˜¯ï¼Œä½†æ˜¯å®é™…ä¸å¯èƒ½ï¼Œè‡³å°‘æœ‰ä¸¤æ–¹é¢çš„æŸè€—ã€‚</p><ul><li><code>ä¸€ä¸ªæ˜¯å¤šä¸ªæ ¸å¿ƒçš„å…¶ä»–å…±ç”¨èµ„æºé™åˆ¶</code>ã€‚è­¬å¦‚ï¼Œ4æ ¸CPUå¯¹åº”çš„å†…å­˜ã€cacheã€å¯„å­˜å™¨å¹¶æ²¡æœ‰åŒæ­¥æ‰©å……4å€ã€‚è¿™å°±å¥½åƒåŒ»é™¢ä¸€æ ·ï¼Œ1ä¸ªåŒ»ç”Ÿæ¢4ä¸ªåŒ»ç”Ÿï¼Œä½†æ˜¯åšBè¶…æ£€æŸ¥çš„è¿˜æ˜¯ä¸€å°æœºå™¨ï¼Œæ€§èƒ½ç“¶é¢ˆå°±ä»åŒ»ç”Ÿè½¬åˆ°Bè¶…æ£€æŸ¥äº†ã€‚</li><li><code>å¦ä¸€ä¸ªæ˜¯å¤šæ ¸CPUä¹‹é—´çš„åè°ƒç®¡ç†æŸè€—</code>ã€‚è­¬å¦‚å¤šä¸ªæ ¸å¿ƒåŒæ—¶è¿è¡Œä¸¤ä¸ªç›¸å…³çš„ä»»åŠ¡ï¼Œéœ€è¦è€ƒè™‘ä»»åŠ¡åŒæ­¥ï¼Œè¿™ä¹Ÿéœ€è¦æ¶ˆè€—é¢å¤–æ€§èƒ½ã€‚å¥½æ¯”å…¬å¸å·¥ä½œï¼Œä¸€ä¸ªäººçš„æ—¶å€™è‡³å°‘ä¸ç”¨å¼€ä¼šæµªè´¹æ—¶é—´ï¼Œè‡ªå·±è·Ÿè‡ªå·±å•†é‡å°±è¡Œäº†ã€‚ä¸¤ä¸ªäººå°±è¦å¼€ä¼šåŒæ­¥å·¥ä½œï¼Œåè°ƒåˆ†é…ï¼Œæ‰€ä»¥å·¥ä½œæ•ˆç‡ç»å¯¹ä¸å¯èƒ½è¾¾åˆ°2å€ã€‚</li></ul><h4 id="_1-5-2-å¹¶è¡Œä¸å¹¶å‘" tabindex="-1">1.5.2 å¹¶è¡Œä¸å¹¶å‘ <a class="header-anchor" href="#_1-5-2-å¹¶è¡Œä¸å¹¶å‘" aria-label="Permalink to &quot;1.5.2 å¹¶è¡Œä¸å¹¶å‘&quot;">â€‹</a></h4><ul><li><strong>å¹¶è¡Œï¼ˆparallelï¼‰</strong>ï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨<code>åŒä¸€æ—¶åˆ»</code>å‘ç”Ÿï¼ˆåŒæ—¶å‘ç”Ÿï¼‰ã€‚æŒ‡åœ¨åŒä¸€æ—¶åˆ»ï¼Œæœ‰<code>å¤šæ¡æŒ‡ä»¤</code>åœ¨<code>å¤šä¸ªCPU</code>ä¸Š<code>åŒæ—¶</code>æ‰§è¡Œã€‚æ¯”å¦‚ï¼šå¤šä¸ªäººåŒæ—¶åšä¸åŒçš„äº‹ã€‚</li></ul><p><img src="'+E+'" alt="image-20230927105116494"></p><p><img src="'+y+'" alt="image-20230927105121034"></p><ul><li><p><strong>å¹¶å‘ï¼ˆconcurrencyï¼‰</strong>ï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨<code>åŒä¸€ä¸ªæ—¶é—´æ®µå†…</code>å‘ç”Ÿã€‚å³åœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œæœ‰<code>å¤šæ¡æŒ‡ä»¤</code>åœ¨<code>å•ä¸ªCPU</code>ä¸Š<code>å¿«é€Ÿè½®æ¢ã€äº¤æ›¿</code>æ‰§è¡Œï¼Œä½¿å¾—åœ¨å®è§‚ä¸Šå…·æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œçš„æ•ˆæœã€‚</p><p><img src="'+i+'" alt="image-20230927105141376"></p><p><img src="'+F+`" alt="image-20230927105148188"></p></li></ul><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œå¯åŠ¨äº†å¤šä¸ªç¨‹åºï¼Œ<code>å¹¶å‘</code>æŒ‡çš„æ˜¯åœ¨ä¸€æ®µæ—¶é—´å†…å®è§‚ä¸Šæœ‰å¤šä¸ªç¨‹åºåŒæ—¶è¿è¡Œï¼Œè¿™åœ¨å•æ ¸ CPU ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªç¨‹åºæ‰§è¡Œï¼Œå³å¾®è§‚ä¸Šè¿™äº›ç¨‹åºæ˜¯åˆ†æ—¶çš„äº¤æ›¿è¿è¡Œï¼Œåªä¸è¿‡æ˜¯ç»™äººçš„æ„Ÿè§‰æ˜¯åŒæ—¶è¿è¡Œï¼Œé‚£æ˜¯å› ä¸ºåˆ†æ—¶äº¤æ›¿è¿è¡Œçš„æ—¶é—´æ˜¯éå¸¸çŸ­çš„ã€‚</p><p>è€Œåœ¨å¤šæ ¸ CPU ç³»ç»Ÿä¸­ï¼Œåˆ™è¿™äº›å¯ä»¥<code>å¹¶å‘</code>æ‰§è¡Œçš„ç¨‹åºä¾¿å¯ä»¥åˆ†é…åˆ°å¤šä¸ªCPUä¸Šï¼Œå®ç°å¤šä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œå³åˆ©ç”¨æ¯ä¸ªå¤„ç†å™¨æ¥å¤„ç†ä¸€ä¸ªå¯ä»¥å¹¶å‘æ‰§è¡Œçš„ç¨‹åºï¼Œè¿™æ ·å¤šä¸ªç¨‹åºä¾¿å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚ç›®å‰ç”µè„‘å¸‚åœºä¸Šè¯´çš„å¤šæ ¸ CPUï¼Œä¾¿æ˜¯å¤šæ ¸å¤„ç†å™¨ï¼Œæ ¸è¶Šå¤šï¼Œ<code>å¹¶è¡Œ</code>å¤„ç†çš„ç¨‹åºè¶Šå¤šï¼Œèƒ½å¤§å¤§çš„æé«˜ç”µè„‘è¿è¡Œçš„æ•ˆç‡ã€‚</p><h2 id="äºŒ-åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹" tabindex="-1">äºŒ.åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹ <a class="header-anchor" href="#äºŒ-åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹" aria-label="Permalink to &quot;äºŒ.åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹&quot;">â€‹</a></h2><h3 id="_2-1-æ¦‚è¿°" tabindex="-1">2.1 æ¦‚è¿° <a class="header-anchor" href="#_2-1-æ¦‚è¿°" aria-label="Permalink to &quot;2.1 æ¦‚è¿°&quot;">â€‹</a></h3><ul><li><p>Javaè¯­è¨€çš„JVMå…è®¸ç¨‹åºè¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œä½¿ç”¨<code>java.lang.Thread</code>ç±»ä»£è¡¨<strong>çº¿ç¨‹</strong>ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å¯¹è±¡éƒ½å¿…é¡»æ˜¯Threadç±»æˆ–å…¶å­ç±»çš„å®ä¾‹ã€‚</p></li><li><p>Threadç±»çš„ç‰¹æ€§</p><ul><li>æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯é€šè¿‡æŸä¸ªç‰¹å®šThreadå¯¹è±¡çš„run()æ–¹æ³•æ¥å®Œæˆæ“ä½œçš„ï¼Œå› æ­¤æŠŠrun()æ–¹æ³•ä½“ç§°ä¸º<code>çº¿ç¨‹æ‰§è¡Œä½“</code>ã€‚</li><li>é€šè¿‡è¯¥Threadå¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¿™ä¸ªçº¿ç¨‹ï¼Œè€Œéç›´æ¥è°ƒç”¨run()</li><li>è¦æƒ³å®ç°å¤šçº¿ç¨‹ï¼Œå¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºæ–°çš„çº¿ç¨‹å¯¹è±¡ã€‚</li></ul></li></ul><h3 id="_2-2-æ–¹å¼1-ç»§æ‰¿threadç±»" tabindex="-1">2.2 æ–¹å¼1ï¼šç»§æ‰¿Threadç±» <a class="header-anchor" href="#_2-2-æ–¹å¼1-ç»§æ‰¿threadç±»" aria-label="Permalink to &quot;2.2 æ–¹å¼1ï¼šç»§æ‰¿Threadç±»&quot;">â€‹</a></h3><p>Javaé€šè¿‡ç»§æ‰¿Threadç±»æ¥<strong>åˆ›å»º</strong>å¹¶<strong>å¯åŠ¨å¤šçº¿ç¨‹</strong>çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å®šä¹‰Threadç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„run()æ–¹æ³•ï¼Œè¯¥run()æ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹éœ€è¦å®Œæˆçš„ä»»åŠ¡</li><li>åˆ›å»ºThreadå­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡</li><li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹</li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.thread;</span></span>
<span class="line"><span style="color:#6A737D;">//è‡ªå®šä¹‰çº¿ç¨‹ç±»</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//å®šä¹‰æŒ‡å®šçº¿ç¨‹åç§°çš„æ„é€ æ–¹æ³•</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyThread</span><span style="color:#E1E4E8;">(String </span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//è°ƒç”¨çˆ¶ç±»çš„Stringå‚æ•°çš„æ„é€ æ–¹æ³•ï¼ŒæŒ‡å®šçº¿ç¨‹çš„åç§°</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">super</span><span style="color:#E1E4E8;">(name);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#6A737D;">    /**</span></span>
<span class="line"><span style="color:#6A737D;">     * é‡å†™runæ–¹æ³•ï¼Œå®Œæˆè¯¥çº¿ç¨‹æ‰§è¡Œçš„é€»è¾‘</span></span>
<span class="line"><span style="color:#6A737D;">     */</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;ï¼šæ­£åœ¨æ‰§è¡Œï¼&quot;</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">i);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.thread;</span></span>
<span class="line"><span style="color:#6A737D;">//è‡ªå®šä¹‰çº¿ç¨‹ç±»</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å®šä¹‰æŒ‡å®šçº¿ç¨‹åç§°çš„æ„é€ æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyThread</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">name</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è°ƒç”¨çˆ¶ç±»çš„Stringå‚æ•°çš„æ„é€ æ–¹æ³•ï¼ŒæŒ‡å®šçº¿ç¨‹çš„åç§°</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">super</span><span style="color:#24292E;">(name);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#6A737D;">    /**</span></span>
<span class="line"><span style="color:#6A737D;">     * é‡å†™runæ–¹æ³•ï¼Œå®Œæˆè¯¥çº¿ç¨‹æ‰§è¡Œçš„é€»è¾‘</span></span>
<span class="line"><span style="color:#6A737D;">     */</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;ï¼šæ­£åœ¨æ‰§è¡Œï¼&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">i);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>æµ‹è¯•ç±»ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestMyThread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹å¯¹è±¡1</span></span>
<span class="line"><span style="color:#E1E4E8;">        MyThread mt1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyThread</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å­çº¿ç¨‹1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//å¼€å¯å­çº¿ç¨‹1</span></span>
<span class="line"><span style="color:#E1E4E8;">        mt1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹å¯¹è±¡2</span></span>
<span class="line"><span style="color:#E1E4E8;">        MyThread mt2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyThread</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å­çº¿ç¨‹2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//å¼€å¯å­çº¿ç¨‹2</span></span>
<span class="line"><span style="color:#E1E4E8;">        mt2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//åœ¨ä¸»æ–¹æ³•ä¸­æ‰§è¡Œforå¾ªç¯</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;mainçº¿ç¨‹ï¼&quot;</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">i);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestMyThread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹å¯¹è±¡1</span></span>
<span class="line"><span style="color:#24292E;">        MyThread mt1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyThread</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å­çº¿ç¨‹1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//å¼€å¯å­çº¿ç¨‹1</span></span>
<span class="line"><span style="color:#24292E;">        mt1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹å¯¹è±¡2</span></span>
<span class="line"><span style="color:#24292E;">        MyThread mt2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyThread</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å­çº¿ç¨‹2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//å¼€å¯å­çº¿ç¨‹2</span></span>
<span class="line"><span style="color:#24292E;">        mt2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åœ¨ä¸»æ–¹æ³•ä¸­æ‰§è¡Œforå¾ªç¯</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;mainçº¿ç¨‹ï¼&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">i);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><blockquote><p>æ³¨æ„ï¼š</p><ol><li><p>å¦‚æœè‡ªå·±æ‰‹åŠ¨è°ƒç”¨run()æ–¹æ³•ï¼Œé‚£ä¹ˆå°±åªæ˜¯æ™®é€šæ–¹æ³•ï¼Œæ²¡æœ‰å¯åŠ¨å¤šçº¿ç¨‹æ¨¡å¼ã€‚</p></li><li><p>run()æ–¹æ³•ç”±JVMè°ƒç”¨ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼Œæ‰§è¡Œçš„è¿‡ç¨‹æ§åˆ¶éƒ½æœ‰æ“ä½œç³»ç»Ÿçš„CPUè°ƒåº¦å†³å®šã€‚</p></li><li><p>æƒ³è¦å¯åŠ¨å¤šçº¿ç¨‹ï¼Œå¿…é¡»è°ƒç”¨startæ–¹æ³•ã€‚</p></li><li><p>ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åªèƒ½è°ƒç”¨ä¸€æ¬¡start()æ–¹æ³•å¯åŠ¨ï¼Œå¦‚æœé‡å¤è°ƒç”¨äº†ï¼Œåˆ™å°†æŠ›å‡ºä»¥ä¸Šçš„å¼‚å¸¸â€œ<code>IllegalThreadStateException</code>â€ã€‚</p></li></ol></blockquote><h3 id="_2-3-æ–¹å¼2-å®ç°runnableæ¥å£" tabindex="-1">2.3 æ–¹å¼2ï¼šå®ç°Runnableæ¥å£ <a class="header-anchor" href="#_2-3-æ–¹å¼2-å®ç°runnableæ¥å£" aria-label="Permalink to &quot;2.3 æ–¹å¼2ï¼šå®ç°Runnableæ¥å£&quot;">â€‹</a></h3><p>Javaæœ‰å•ç»§æ‰¿çš„é™åˆ¶ï¼Œå½“æˆ‘ä»¬æ— æ³•ç»§æ‰¿Threadç±»æ—¶ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•åšå‘¢ï¼Ÿåœ¨æ ¸å¿ƒç±»åº“ä¸­æä¾›äº†Runnableæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°Runnableæ¥å£ï¼Œé‡å†™run()æ–¹æ³•ï¼Œç„¶åå†é€šè¿‡Threadç±»çš„å¯¹è±¡ä»£ç†å¯åŠ¨å’Œæ‰§è¡Œæˆ‘ä»¬çš„çº¿ç¨‹ä½“run()æ–¹æ³•</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>å®šä¹‰Runnableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶é‡å†™è¯¥æ¥å£çš„run()æ–¹æ³•ï¼Œè¯¥run()æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</p></li><li><p>åˆ›å»ºRunnableå®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä»¥æ­¤å®ä¾‹ä½œä¸ºThreadçš„targetå‚æ•°æ¥åˆ›å»ºThreadå¯¹è±¡ï¼Œè¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£ çš„çº¿ç¨‹å¯¹è±¡ã€‚</p></li><li><p>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•ï¼Œå¯åŠ¨çº¿ç¨‹ã€‚è°ƒç”¨Runnableæ¥å£å®ç°ç±»çš„runæ–¹æ³•ã€‚</p></li></ol><p>ä»£ç å¦‚ä¸‹</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyRunnable</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Â &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyRunnable</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Â &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>æµ‹è¯•ç±»ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestMyRunnable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰ç±»å¯¹è±¡  çº¿ç¨‹ä»»åŠ¡å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        MyRunnable mr </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyRunnable</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(mr, </span><span style="color:#9ECBFF;">&quot;é•¿æ±Ÿ&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        t.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;é»„æ²³ &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.thread;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestMyRunnable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ›å»ºè‡ªå®šä¹‰ç±»å¯¹è±¡  çº¿ç¨‹ä»»åŠ¡å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        MyRunnable mr </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyRunnable</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        Thread t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(mr, </span><span style="color:#032F62;">&quot;é•¿æ±Ÿ&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        t.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;é»„æ²³ &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><code> é€šè¿‡å®ç°Runnableæ¥å£ï¼Œä½¿å¾—è¯¥ç±»æœ‰äº†å¤šçº¿ç¨‹ç±»çš„ç‰¹å¾ã€‚æ‰€æœ‰çš„åˆ†çº¿ç¨‹è¦æ‰§è¡Œçš„ä»£ç éƒ½åœ¨runæ–¹æ³•é‡Œé¢ã€‚</code></p><p><strong>åœ¨å¯åŠ¨çš„å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦å…ˆé€šè¿‡Threadç±»çš„æ„é€ æ–¹æ³•Thread(Runnable target) æ„é€ å‡ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨Threadå¯¹è±¡çš„start()æ–¹æ³•æ¥è¿è¡Œå¤šçº¿ç¨‹ä»£ç ã€‚</strong></p><p><strong>å®é™…ä¸Šï¼Œæ‰€æœ‰çš„å¤šçº¿ç¨‹ä»£ç éƒ½æ˜¯é€šè¿‡è¿è¡ŒThreadçš„start()æ–¹æ³•æ¥è¿è¡Œçš„ã€‚å› æ­¤ï¼Œä¸ç®¡æ˜¯ç»§æ‰¿Threadç±»è¿˜æ˜¯å®ç°</strong><strong>Runnableæ¥å£æ¥å®ç°å¤šçº¿ç¨‹ï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡Threadçš„å¯¹è±¡çš„APIæ¥æ§åˆ¶çº¿ç¨‹çš„ï¼Œç†Ÿæ‚‰Threadç±»çš„APIæ˜¯è¿›è¡Œå¤šçº¿ç¨‹ç¼–ç¨‹çš„åŸºç¡€ã€‚</strong></p><p>ğŸ’¡ è¯´æ˜ï¼šRunnableå¯¹è±¡ä»…ä»…ä½œä¸ºThreadå¯¹è±¡çš„targetï¼ŒRunnableå®ç°ç±»é‡ŒåŒ…å«çš„run()æ–¹æ³•ä»…ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ã€‚ è€Œå®é™…çš„çº¿ç¨‹å¯¹è±¡ä¾ç„¶æ˜¯Threadå®ä¾‹ï¼Œåªæ˜¯è¯¥Threadçº¿ç¨‹è´Ÿè´£æ‰§è¡Œå…¶targetçš„run()æ–¹æ³•ã€‚</p><h3 id="_2-4-å˜å½¢å†™æ³•" tabindex="-1">2.4 å˜å½¢å†™æ³• <a class="header-anchor" href="#_2-4-å˜å½¢å†™æ³•" aria-label="Permalink to &quot;2.4 å˜å½¢å†™æ³•&quot;">â€‹</a></h3><p><strong>ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»å¯¹è±¡æ¥å®ç°çº¿ç¨‹çš„åˆ›å»ºå’Œå¯åŠ¨</strong></p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ–°çš„çº¿ç¨‹ï¼&quot;</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;ï¼šæ­£åœ¨æ‰§è¡Œï¼&quot;</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">i);</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ–°çš„çº¿ç¨‹ï¼&quot;</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;ï¼šæ­£åœ¨æ‰§è¡Œï¼&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">i);</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}).</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}).</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span></code></pre></div><h3 id="_2-5-å¯¹æ¯”ä¸¤ç§æ–¹å¼" tabindex="-1">2.5 å¯¹æ¯”ä¸¤ç§æ–¹å¼ <a class="header-anchor" href="#_2-5-å¯¹æ¯”ä¸¤ç§æ–¹å¼" aria-label="Permalink to &quot;2.5 å¯¹æ¯”ä¸¤ç§æ–¹å¼&quot;">â€‹</a></h3><p><strong>è”ç³»</strong></p><p>Threadç±»å®é™…ä¸Šä¹Ÿæ˜¯å®ç°äº†Runnableæ¥å£çš„ç±»ã€‚å³ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span></span></code></pre></div><p><strong>åŒºåˆ«</strong></p><ul><li><p>ç»§æ‰¿Threadï¼šçº¿ç¨‹ä»£ç å­˜æ”¾Threadå­ç±»runæ–¹æ³•ä¸­ã€‚</p></li><li><p>å®ç°Runnableï¼šçº¿ç¨‹ä»£ç å­˜åœ¨æ¥å£çš„å­ç±»çš„runæ–¹æ³•ã€‚</p></li></ul><p><strong>å®ç°Runnableæ¥å£æ¯”ç»§æ‰¿Threadç±»æ‰€å…·æœ‰çš„ä¼˜åŠ¿</strong></p><ul><li>é¿å…äº†å•ç»§æ‰¿çš„å±€é™æ€§</li><li>å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ªæ¥å£å®ç°ç±»çš„å¯¹è±¡ï¼Œéå¸¸é€‚åˆå¤šä¸ªç›¸åŒçº¿ç¨‹æ¥å¤„ç†åŒä¸€ä»½èµ„æºã€‚</li><li>å¢åŠ ç¨‹åºçš„å¥å£®æ€§ï¼Œå®ç°è§£è€¦æ“ä½œï¼Œä»£ç å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œä»£ç å’Œçº¿ç¨‹ç‹¬ç«‹ã€‚</li></ul><h2 id="ä¸‰ã€threadç±»çš„å¸¸ç”¨ç»“æ„" tabindex="-1">ä¸‰ã€Threadç±»çš„å¸¸ç”¨ç»“æ„ <a class="header-anchor" href="#ä¸‰ã€threadç±»çš„å¸¸ç”¨ç»“æ„" aria-label="Permalink to &quot;ä¸‰ã€Threadç±»çš„å¸¸ç”¨ç»“æ„&quot;">â€‹</a></h2><h3 id="_3-1-æ„é€ å™¨" tabindex="-1">3.1 æ„é€ å™¨ <a class="header-anchor" href="#_3-1-æ„é€ å™¨" aria-label="Permalink to &quot;3.1 æ„é€ å™¨&quot;">â€‹</a></h3><ul><li>public Thread() :åˆ†é…ä¸€ä¸ªæ–°çš„çº¿ç¨‹å¯¹è±¡ã€‚</li><li>public Thread(String name) :åˆ†é…ä¸€ä¸ªæŒ‡å®šåå­—çš„æ–°çš„çº¿ç¨‹å¯¹è±¡ã€‚</li><li>public Thread(Runnable target) :æŒ‡å®šåˆ›å»ºçº¿ç¨‹çš„ç›®æ ‡å¯¹è±¡ï¼Œå®ƒå®ç°äº†Runnableæ¥å£ä¸­çš„runæ–¹æ³•</li><li>public Thread(Runnable target,String name) :åˆ†é…ä¸€ä¸ªå¸¦æœ‰æŒ‡å®šç›®æ ‡æ–°çš„çº¿ç¨‹å¯¹è±¡å¹¶æŒ‡å®šåå­—ã€‚</li></ul><h3 id="_3-2-å¸¸ç”¨æ–¹æ³•ç³»åˆ—1" tabindex="-1">3.2 å¸¸ç”¨æ–¹æ³•ç³»åˆ—1 <a class="header-anchor" href="#_3-2-å¸¸ç”¨æ–¹æ³•ç³»åˆ—1" aria-label="Permalink to &quot;3.2 å¸¸ç”¨æ–¹æ³•ç³»åˆ—1&quot;">â€‹</a></h3><ul><li>public void run() :æ­¤çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡åœ¨æ­¤å¤„å®šä¹‰ä»£ç ã€‚</li><li>public void start() :å¯¼è‡´æ­¤çº¿ç¨‹å¼€å§‹æ‰§è¡Œ; Javaè™šæ‹Ÿæœºè°ƒç”¨æ­¤çº¿ç¨‹çš„runæ–¹æ³•ã€‚</li><li>public String getName() :è·å–å½“å‰çº¿ç¨‹åç§°ã€‚</li><li>public void setName(String name)ï¼šè®¾ç½®è¯¥çº¿ç¨‹åç§°ã€‚</li><li>public static Thread currentThread() :è¿”å›å¯¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨Threadå­ç±»ä¸­å°±æ˜¯thisï¼Œé€šå¸¸ç”¨äºä¸»çº¿ç¨‹å’ŒRunnableå®ç°ç±»</li><li>public static void sleep(long millis) :ä½¿å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä»¥æŒ‡å®šçš„æ¯«ç§’æ•°æš‚åœï¼ˆæš‚æ—¶åœæ­¢æ‰§è¡Œï¼‰ã€‚</li><li>public static void yield()ï¼šyieldåªæ˜¯è®©å½“å‰çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œè®©ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å™¨é‡æ–°è°ƒåº¦ä¸€æ¬¡ï¼Œå¸Œæœ›ä¼˜å…ˆçº§ä¸å½“å‰çº¿ç¨‹ç›¸åŒæˆ–æ›´é«˜çš„å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿè·å¾—æ‰§è¡Œæœºä¼šï¼Œä½†æ˜¯è¿™ä¸ªä¸èƒ½ä¿è¯ï¼Œå®Œå…¨æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯ï¼Œå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†yieldæ–¹æ³•æš‚åœä¹‹åï¼Œçº¿ç¨‹è°ƒåº¦å™¨åˆå°†å…¶è°ƒåº¦å‡ºæ¥é‡æ–°æ‰§è¡Œã€‚</li></ul><h3 id="_3-3-å¸¸ç”¨æ–¹æ³•ç³»åˆ—2" tabindex="-1">3.3 å¸¸ç”¨æ–¹æ³•ç³»åˆ—2 <a class="header-anchor" href="#_3-3-å¸¸ç”¨æ–¹æ³•ç³»åˆ—2" aria-label="Permalink to &quot;3.3 å¸¸ç”¨æ–¹æ³•ç³»åˆ—2&quot;">â€‹</a></h3><ul><li><p>public final boolean isAlive()ï¼šæµ‹è¯•çº¿ç¨‹æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚å¦‚æœçº¿ç¨‹å·²ç»å¯åŠ¨ä¸”å°šæœªç»ˆæ­¢ï¼Œåˆ™ä¸ºæ´»åŠ¨çŠ¶æ€ã€‚</p></li><li><p>void join() ï¼šç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢ã€‚</p><p>void join(long millis) ï¼šç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢çš„æ—¶é—´æœ€é•¿ä¸º millis æ¯«ç§’ã€‚å¦‚æœmillisæ—¶é—´åˆ°ï¼Œå°†ä¸å†ç­‰å¾…ã€‚</p><p>void join(long millis, int nanos) ï¼šç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢çš„æ—¶é—´æœ€é•¿ä¸º millis æ¯«ç§’ + nanos çº³ç§’ã€‚</p></li><li><p>public final void stop()ï¼š<code>å·²è¿‡æ—¶</code>ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚å¼ºè¡Œç»“æŸä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œï¼Œç›´æ¥è¿›å…¥æ­»äº¡çŠ¶æ€ã€‚run()å³åˆ»åœæ­¢ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ¸…ç†æ€§çš„å·¥ä½œå¾—ä¸åˆ°å®Œæˆï¼Œå¦‚æ–‡ä»¶ï¼Œæ•°æ®åº“ç­‰çš„å…³é—­ã€‚åŒæ—¶ï¼Œä¼šç«‹å³é‡Šæ”¾è¯¥çº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰çš„é”ï¼Œå¯¼è‡´æ•°æ®å¾—ä¸åˆ°åŒæ­¥çš„å¤„ç†ï¼Œå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p></li><li><p>void suspend() / void resume() : è¿™ä¸¤ä¸ªæ“ä½œå°±å¥½æ¯”æ’­æ”¾å™¨çš„æš‚åœå’Œæ¢å¤ã€‚äºŒè€…å¿…é¡»æˆå¯¹å‡ºç°ï¼Œå¦åˆ™éå¸¸å®¹æ˜“å‘ç”Ÿæ­»é”ã€‚suspend()è°ƒç”¨ä¼šå¯¼è‡´çº¿ç¨‹æš‚åœï¼Œä½†ä¸ä¼šé‡Šæ”¾ä»»ä½•é”èµ„æºï¼Œå¯¼è‡´å…¶å®ƒçº¿ç¨‹éƒ½æ— æ³•è®¿é—®è¢«å®ƒå ç”¨çš„é”ï¼Œç›´åˆ°è°ƒç”¨resume()ã€‚<code>å·²è¿‡æ—¶</code>ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</p></li></ul><h3 id="_3-4-å¸¸ç”¨æ–¹æ³•ç³»åˆ—3" tabindex="-1">3.4 å¸¸ç”¨æ–¹æ³•ç³»åˆ—3 <a class="header-anchor" href="#_3-4-å¸¸ç”¨æ–¹æ³•ç³»åˆ—3" aria-label="Permalink to &quot;3.4 å¸¸ç”¨æ–¹æ³•ç³»åˆ—3&quot;">â€‹</a></h3><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€å®šçš„ä¼˜å…ˆçº§ï¼ŒåŒä¼˜å…ˆçº§çº¿ç¨‹ç»„æˆå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆå…ˆåˆ°å…ˆæœåŠ¡ï¼‰ï¼Œä½¿ç”¨åˆ†æ—¶è°ƒåº¦ç­–ç•¥ã€‚ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹é‡‡ç”¨æŠ¢å å¼ç­–ç•¥ï¼Œè·å¾—è¾ƒå¤šçš„æ‰§è¡Œæœºä¼šã€‚æ¯ä¸ªçº¿ç¨‹é»˜è®¤çš„ä¼˜å…ˆçº§éƒ½ä¸åˆ›å»ºå®ƒçš„çˆ¶çº¿ç¨‹å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ã€‚</p><ul><li>Threadç±»çš„ä¸‰ä¸ªä¼˜å…ˆçº§å¸¸é‡ï¼š <ul><li>MAX_PRIORITYï¼ˆ10ï¼‰ï¼šæœ€é«˜ä¼˜å…ˆçº§</li><li>MIN _PRIORITY ï¼ˆ1ï¼‰ï¼šæœ€ä½ä¼˜å…ˆçº§</li><li>NORM_PRIORITY ï¼ˆ5ï¼‰ï¼šæ™®é€šä¼˜å…ˆçº§ï¼Œé»˜è®¤æƒ…å†µä¸‹mainçº¿ç¨‹å…·æœ‰æ™®é€šä¼˜å…ˆçº§ã€‚</li></ul></li></ul><ul><li>public final int getPriority() ï¼šè¿”å›çº¿ç¨‹ä¼˜å…ˆçº§</li><li>public final void setPriority(int newPriority) ï¼šæ”¹å˜çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼ŒèŒƒå›´åœ¨[1,10]ä¹‹é—´ã€‚</li></ul><p>ç»ƒä¹ ï¼šè·å–mainçº¿ç¨‹å¯¹è±¡çš„åç§°å’Œä¼˜å…ˆçº§ã€‚</p><p>å£°æ˜ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ç»§æ‰¿Threadç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œåœ¨runæ–¹æ³•ä¸­è·å–çº¿ç¨‹åç§°å’Œä¼˜å…ˆçº§ã€‚è®¾ç½®è¯¥çº¿ç¨‹ä¼˜å…ˆçº§ä¸ºæœ€é«˜ä¼˜å…ˆçº§å¹¶å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] args) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		Thread t </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">				System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;çš„ä¼˜å…ˆçº§ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getPriority</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		};</span></span>
<span class="line"><span style="color:#E1E4E8;">		t.</span><span style="color:#B392F0;">setPriority</span><span style="color:#E1E4E8;">(Thread.MAX_PRIORITY);</span></span>
<span class="line"><span style="color:#E1E4E8;">		t.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#9ECBFF;">&quot;çš„ä¼˜å…ˆçº§ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> 		                                          Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getPriority</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] args) {</span></span>
<span class="line"><span style="color:#24292E;">		Thread t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">				System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;çš„ä¼˜å…ˆçº§ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getPriority</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		};</span></span>
<span class="line"><span style="color:#24292E;">		t.</span><span style="color:#6F42C1;">setPriority</span><span style="color:#24292E;">(Thread.MAX_PRIORITY);</span></span>
<span class="line"><span style="color:#24292E;">		t.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;çš„ä¼˜å…ˆçº§ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> 		                                          Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getPriority</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span></code></pre></div><p>æ¡ˆä¾‹ï¼š</p><ul><li><p>å£°æ˜ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ç»§æ‰¿Threadç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œå®ç°æ‰“å°[1,100]ä¹‹é—´çš„å¶æ•°ï¼Œè¦æ±‚æ¯éš”1ç§’æ‰“å°1ä¸ªå¶æ•°ã€‚</p></li><li><p>å£°æ˜ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ç»§æ‰¿Threadç±»ï¼Œé‡å†™runæ–¹æ³•ï¼Œå®ç°æ‰“å°[1,100]ä¹‹é—´çš„å¥‡æ•°ï¼Œ</p><ul><li>å½“æ‰“å°åˆ°5æ—¶ï¼Œè®©å¥‡æ•°çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œå†ç»§ç»­ã€‚</li><li>å½“æ‰“å°åˆ°5æ—¶ï¼Œè®©å¥‡æ•°çº¿ç¨‹åœä¸‹æ¥ï¼Œè®©å¶æ•°çº¿ç¨‹æ‰§è¡Œå®Œå†æ‰“å°ã€‚</li></ul></li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.api;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestThreadStateChange</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread te </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">            @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å¶æ•°çº¿ç¨‹ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">                    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        te.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Thread to </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">            @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å¥‡æ•°çº¿ç¨‹ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">//                        Thread.yield();</span></span>
<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                            te.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                        }</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        to.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.api;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestThreadStateChange</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        Thread te </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">            @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å¶æ•°çº¿ç¨‹ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                        Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                        e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        te.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Thread to </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">            @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å¥‡æ•°çº¿ç¨‹ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#6A737D;">//                        Thread.yield();</span></span>
<span class="line"><span style="color:#24292E;">                        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                            te.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                        }</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        to.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="å››ã€å¤šçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1">å››ã€å¤šçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ <a class="header-anchor" href="#å››ã€å¤šçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" aria-label="Permalink to &quot;å››ã€å¤šçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ&quot;">â€‹</a></h2><p>Javaè¯­è¨€ä½¿ç”¨Threadç±»åŠå…¶å­ç±»çš„å¯¹è±¡æ¥è¡¨ç¤ºçº¿ç¨‹ï¼Œåœ¨å®ƒçš„ä¸€ä¸ªå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸä¸­é€šå¸¸è¦ç»å†å¦‚ä¸‹ä¸€äº›çŠ¶æ€ï¼š</p><h3 id="_4-1-jdk1-5ä¹‹å‰-5ç§çŠ¶æ€" tabindex="-1">4.1 JDK1.5ä¹‹å‰ï¼š5ç§çŠ¶æ€ <a class="header-anchor" href="#_4-1-jdk1-5ä¹‹å‰-5ç§çŠ¶æ€" aria-label="Permalink to &quot;4.1 JDK1.5ä¹‹å‰ï¼š5ç§çŠ¶æ€&quot;">â€‹</a></h3><p>çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæœ‰äº”ç§çŠ¶æ€ï¼šæ–°å»ºï¼ˆNewï¼‰ã€å°±ç»ªï¼ˆRunnableï¼‰ã€è¿è¡Œï¼ˆRunningï¼‰ã€é˜»å¡ï¼ˆBlockedï¼‰ã€æ­»äº¡ï¼ˆDeadï¼‰ã€‚CPUéœ€è¦åœ¨å¤šæ¡çº¿ç¨‹ä¹‹é—´åˆ‡æ¢ï¼Œäºæ˜¯çº¿ç¨‹çŠ¶æ€ä¼šå¤šæ¬¡åœ¨è¿è¡Œã€é˜»å¡ã€å°±ç»ªä¹‹é—´åˆ‡æ¢ã€‚</p><p><img src="`+u+`" alt="image-20231007183201654"></p><p><strong>1.æ–°å»º</strong></p><p>å½“ä¸€ä¸ªThreadç±»æˆ–å…¶å­ç±»çš„å¯¹è±¡è¢«å£°æ˜å¹¶åˆ›å»ºæ—¶ï¼Œæ–°ç”Ÿçš„çº¿ç¨‹å¯¹è±¡å¤„äºæ–°å»ºçŠ¶æ€ã€‚æ­¤æ—¶å®ƒå’Œå…¶ä»–Javaå¯¹è±¡ä¸€æ ·ï¼Œä»…ä»…ç”±JVMä¸ºå…¶åˆ†é…äº†å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–äº†å®ä¾‹å˜é‡çš„å€¼ã€‚æ­¤æ—¶çš„çº¿ç¨‹å¯¹è±¡å¹¶æ²¡æœ‰ä»»ä½•çº¿ç¨‹çš„åŠ¨æ€ç‰¹å¾ï¼Œç¨‹åºä¹Ÿä¸ä¼šæ‰§è¡Œå®ƒçš„çº¿ç¨‹ä½“run()ã€‚</p><p><strong>2.å°±ç»ª</strong></p><p>ä½†æ˜¯å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†start()æ–¹æ³•ä¹‹åï¼Œå°±ä¸ä¸€æ ·äº†ï¼Œçº¿ç¨‹å°±ä»æ–°å»ºçŠ¶æ€è½¬ä¸ºå°±ç»ªçŠ¶æ€ã€‚JVMä¼šä¸ºå…¶åˆ›å»ºæ–¹æ³•è°ƒç”¨æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œå½“ç„¶ï¼Œå¤„äºè¿™ä¸ªçŠ¶æ€ä¸­çš„çº¿ç¨‹å¹¶æ²¡æœ‰å¼€å§‹è¿è¡Œï¼Œåªæ˜¯è¡¨ç¤ºå·²å…·å¤‡äº†è¿è¡Œçš„æ¡ä»¶ï¼Œéšæ—¶å¯ä»¥è¢«è°ƒåº¦ã€‚è‡³äºä»€ä¹ˆæ—¶å€™è¢«è°ƒåº¦ï¼Œå–å†³äºJVMé‡Œçº¿ç¨‹è°ƒåº¦å™¨çš„è°ƒåº¦ã€‚</p><blockquote><p>æ³¨æ„ï¼š</p><p>ç¨‹åºåªèƒ½å¯¹æ–°å»ºçŠ¶æ€çš„çº¿ç¨‹è°ƒç”¨start()ï¼Œå¹¶ä¸”åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœå¯¹éæ–°å»ºçŠ¶æ€çš„çº¿ç¨‹ï¼Œå¦‚å·²å¯åŠ¨çš„çº¿ç¨‹æˆ–å·²æ­»äº¡çš„çº¿ç¨‹è°ƒç”¨start()éƒ½ä¼šæŠ¥é”™IllegalThreadStateExceptionå¼‚å¸¸ã€‚</p></blockquote><p><strong>3.è¿è¡Œ</strong></p><p>å¦‚æœå¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å¾—äº†CPUèµ„æºæ—¶ï¼Œå¼€å§‹æ‰§è¡Œrun()æ–¹æ³•çš„çº¿ç¨‹ä½“ä»£ç ï¼Œåˆ™è¯¥çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¦‚æœè®¡ç®—æœºåªæœ‰ä¸€ä¸ªCPUæ ¸å¿ƒï¼Œåœ¨ä»»ä½•æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœè®¡ç®—æœºæœ‰å¤šä¸ªæ ¸å¿ƒï¼Œå°†ä¼šæœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œ(Parallel)æ‰§è¡Œã€‚</p><p>å½“ç„¶ï¼Œç¾å¥½çš„æ—¶å…‰æ€»æ˜¯çŸ­æš‚çš„ï¼Œè€Œä¸”CPUè®²ç©¶é›¨éœ²å‡æ²¾ã€‚å¯¹äºæŠ¢å å¼ç­–ç•¥çš„ç³»ç»Ÿè€Œè¨€ï¼Œç³»ç»Ÿä¼šç»™æ¯ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹ä¸€ä¸ªå°æ—¶é—´æ®µæ¥å¤„ç†ä»»åŠ¡ï¼Œå½“è¯¥æ—¶é—´ç”¨å®Œï¼Œç³»ç»Ÿä¼šå‰¥å¤ºè¯¥çº¿ç¨‹æ‰€å ç”¨çš„èµ„æºï¼Œè®©å…¶å›åˆ°å°±ç»ªçŠ¶æ€ç­‰å¾…ä¸‹ä¸€æ¬¡è¢«è°ƒåº¦ã€‚æ­¤æ—¶å…¶ä»–çº¿ç¨‹å°†è·å¾—æ‰§è¡Œæœºä¼šï¼Œè€Œåœ¨é€‰æ‹©ä¸‹ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œç³»ç»Ÿä¼šé€‚å½“è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p><p><strong>4.é˜»å¡</strong></p><p>å½“åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„çº¿ç¨‹é‡åˆ°å¦‚ä¸‹æƒ…å†µæ—¶ï¼Œä¼šè®©å‡º CPU å¹¶ä¸´æ—¶ä¸­æ­¢è‡ªå·±çš„æ‰§è¡Œï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼š</p><ul><li>çº¿ç¨‹è°ƒç”¨äº†sleep()æ–¹æ³•ï¼Œä¸»åŠ¨æ”¾å¼ƒæ‰€å ç”¨çš„CPUèµ„æºï¼›</li><li>çº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªåŒæ­¥ç›‘è§†å™¨ï¼Œä½†è¯¥åŒæ­¥ç›‘è§†å™¨æ­£è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼›</li><li>çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŒæ­¥ç›‘è§†å™¨è°ƒç”¨äº†wait()ï¼Œè®©å®ƒç­‰å¾…æŸä¸ªé€šçŸ¥ï¼ˆnotifyï¼‰ï¼›</li><li>çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŒæ­¥ç›‘è§†å™¨è°ƒç”¨äº†wait(time)</li><li>çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†å…¶ä»–çº¿ç¨‹å¯¹è±¡çš„åŠ å¡ï¼ˆjoinï¼‰ï¼›</li><li>çº¿ç¨‹è¢«è°ƒç”¨suspendæ–¹æ³•è¢«æŒ‚èµ·ï¼ˆå·²è¿‡æ—¶ï¼Œå› ä¸ºå®¹æ˜“å‘ç”Ÿæ­»é”ï¼‰ï¼›</li></ul><p>å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è¢«é˜»å¡åï¼Œå…¶ä»–çº¿ç¨‹å°±æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚é’ˆå¯¹å¦‚ä¸Šæƒ…å†µï¼Œå½“å‘ç”Ÿå¦‚ä¸‹æƒ…å†µæ—¶ä¼šè§£é™¤é˜»å¡ï¼Œè®©è¯¥çº¿ç¨‹é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç­‰å¾…çº¿ç¨‹è°ƒåº¦å™¨å†æ¬¡è°ƒåº¦å®ƒï¼š</p><ul><li>çº¿ç¨‹çš„sleep()æ—¶é—´åˆ°ï¼›</li><li>çº¿ç¨‹æˆåŠŸè·å¾—äº†åŒæ­¥ç›‘è§†å™¨ï¼›</li><li>çº¿ç¨‹ç­‰åˆ°äº†é€šçŸ¥(notify)ï¼›</li><li>çº¿ç¨‹waitçš„æ—¶é—´åˆ°äº†</li><li>åŠ å¡çš„çº¿ç¨‹ç»“æŸäº†ï¼›</li><li>è¢«æŒ‚èµ·çš„çº¿ç¨‹åˆè¢«è°ƒç”¨äº†resumeæ¢å¤æ–¹æ³•ï¼ˆå·²è¿‡æ—¶ï¼Œå› ä¸ºå®¹æ˜“å‘ç”Ÿæ­»é”ï¼‰ï¼›</li></ul><p><strong>5.æ­»äº¡</strong></p><p>çº¿ç¨‹ä¼šä»¥ä»¥ä¸‹ä¸‰ç§æ–¹å¼ä¹‹ä¸€ç»“æŸï¼Œç»“æŸåçš„çº¿ç¨‹å°±å¤„äºæ­»äº¡çŠ¶æ€ï¼š</p><ul><li>run()æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œçº¿ç¨‹æ­£å¸¸ç»“æŸ</li><li>çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸ï¼ˆExceptionï¼‰æˆ–é”™è¯¯ï¼ˆErrorï¼‰</li><li>ç›´æ¥è°ƒç”¨è¯¥çº¿ç¨‹çš„stop()æ¥ç»“æŸè¯¥çº¿ç¨‹ï¼ˆå·²è¿‡æ—¶ï¼‰</li></ul><h3 id="_4-2-jdk1-5åŠä¹‹å-6ç§çŠ¶æ€" tabindex="-1">4.2 JDK1.5åŠä¹‹åï¼š6ç§çŠ¶æ€ <a class="header-anchor" href="#_4-2-jdk1-5åŠä¹‹å-6ç§çŠ¶æ€" aria-label="Permalink to &quot;4.2 JDK1.5åŠä¹‹åï¼š6ç§çŠ¶æ€&quot;">â€‹</a></h3><p>åœ¨java.lang.Thread.Stateçš„æšä¸¾ç±»ä¸­è¿™æ ·å®šä¹‰ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">enum</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">State</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">NEW</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">RUNNABLE</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">BLOCKED</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">WAITING</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">TIMED_WAITING</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">TERMINATED</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">enum</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">State</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">NEW</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">RUNNABLE</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">BLOCKED</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">WAITING</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">TIMED_WAITING</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">TERMINATED</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li><p><code>NEWï¼ˆæ–°å»ºï¼‰</code>ï¼šçº¿ç¨‹åˆšè¢«åˆ›å»ºï¼Œä½†æ˜¯å¹¶æœªå¯åŠ¨ã€‚è¿˜æ²¡è°ƒç”¨startæ–¹æ³•ã€‚</p></li><li><p><code>RUNNABLEï¼ˆå¯è¿è¡Œï¼‰</code>ï¼šè¿™é‡Œæ²¡æœ‰åŒºåˆ†å°±ç»ªå’Œè¿è¡ŒçŠ¶æ€ã€‚å› ä¸ºå¯¹äºJavaå¯¹è±¡æ¥è¯´ï¼Œåªèƒ½æ ‡è®°ä¸ºå¯è¿è¡Œï¼Œè‡³äºä»€ä¹ˆæ—¶å€™è¿è¡Œï¼Œä¸æ˜¯JVMæ¥æ§åˆ¶çš„äº†ï¼Œæ˜¯OSæ¥è¿›è¡Œè°ƒåº¦çš„ï¼Œè€Œä¸”æ—¶é—´éå¸¸çŸ­æš‚ï¼Œå› æ­¤å¯¹äºJavaå¯¹è±¡çš„çŠ¶æ€æ¥è¯´ï¼Œæ— æ³•åŒºåˆ†ã€‚</p></li><li><p><code>Teminatedï¼ˆè¢«ç»ˆæ­¢ï¼‰</code>ï¼šè¡¨æ˜æ­¤çº¿ç¨‹å·²ç»ç»“æŸç”Ÿå‘½å‘¨æœŸï¼Œç»ˆæ­¢è¿è¡Œã€‚</p></li><li><p>é‡ç‚¹è¯´æ˜ï¼Œæ ¹æ®Thread.Stateçš„å®šä¹‰ï¼Œ<strong>é˜»å¡çŠ¶æ€åˆ†ä¸ºä¸‰ç§</strong>ï¼š<code>BLOCKED</code>ã€<code>WAITING</code>ã€<code>TIMED_WAITING</code>ã€‚</p><ul><li><code>BLOCKEDï¼ˆé”é˜»å¡ï¼‰</code>ï¼šåœ¨APIä¸­çš„ä»‹ç»ä¸ºï¼šä¸€ä¸ªæ­£åœ¨é˜»å¡ã€ç­‰å¾…ä¸€ä¸ªç›‘è§†å™¨é”ï¼ˆé”å¯¹è±¡ï¼‰çš„çº¿ç¨‹å¤„äºè¿™ä¸€çŠ¶æ€ã€‚åªæœ‰è·å¾—é”å¯¹è±¡çš„çº¿ç¨‹æ‰èƒ½æœ‰æ‰§è¡Œæœºä¼šã€‚ <ul><li>æ¯”å¦‚ï¼Œçº¿ç¨‹Aä¸çº¿ç¨‹Bä»£ç ä¸­ä½¿ç”¨åŒä¸€é”ï¼Œå¦‚æœçº¿ç¨‹Aè·å–åˆ°é”ï¼Œçº¿ç¨‹Aè¿›å…¥åˆ°RunnableçŠ¶æ€ï¼Œé‚£ä¹ˆçº¿ç¨‹Bå°±è¿›å…¥åˆ°Blockedé”é˜»å¡çŠ¶æ€ã€‚</li></ul></li><li><code>TIMED_WAITINGï¼ˆè®¡æ—¶ç­‰å¾…ï¼‰</code>ï¼šåœ¨APIä¸­çš„ä»‹ç»ä¸ºï¼šä¸€ä¸ªæ­£åœ¨é™æ—¶ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªï¼ˆå”¤é†’ï¼‰åŠ¨ä½œçš„çº¿ç¨‹å¤„äºè¿™ä¸€çŠ¶æ€ã€‚ <ul><li>å½“å‰çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°Threadç±»çš„<code>sleep</code>æˆ–<code>join</code>ï¼ŒObjectç±»çš„<code>wait</code>ï¼ŒLockSupportç±»çš„<code>park</code>æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œ<code>è®¾ç½®äº†æ—¶é—´</code>ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹ä¼šè¿›å…¥TIMED_WAITINGï¼Œç›´åˆ°æ—¶é—´åˆ°ï¼Œæˆ–è¢«ä¸­æ–­ã€‚</li></ul></li><li><code>WAITINGï¼ˆæ— é™ç­‰å¾…ï¼‰</code>ï¼šåœ¨APIä¸­ä»‹ç»ä¸ºï¼šä¸€ä¸ªæ­£åœ¨æ— é™æœŸç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªç‰¹åˆ«çš„ï¼ˆå”¤é†’ï¼‰åŠ¨ä½œçš„çº¿ç¨‹å¤„äºè¿™ä¸€çŠ¶æ€ã€‚ <ul><li>å½“å‰çº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é‡åˆ°Objectç±»çš„<code>wait</code>ï¼ŒThreadç±»çš„<code>join</code>ï¼ŒLockSupportç±»çš„<code>park</code>æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œ<code>æ²¡æœ‰æŒ‡å®šæ—¶é—´</code>ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹ä¼šè¿›å…¥WAITINGçŠ¶æ€ï¼Œç›´åˆ°è¢«å”¤é†’ã€‚ <ul><li>é€šè¿‡Objectç±»çš„waitè¿›å…¥WAITINGçŠ¶æ€çš„è¦æœ‰Objectçš„notify/notifyAllå”¤é†’ï¼›</li><li>é€šè¿‡Conditionçš„awaitè¿›å…¥WAITINGçŠ¶æ€çš„è¦æœ‰Conditionçš„signalæ–¹æ³•å”¤é†’ï¼›</li><li>é€šè¿‡LockSupportç±»çš„parkæ–¹æ³•è¿›å…¥WAITINGçŠ¶æ€çš„è¦æœ‰LockSupportç±»çš„unparkæ–¹æ³•å”¤é†’</li><li>é€šè¿‡Threadç±»çš„joinè¿›å…¥WAITINGçŠ¶æ€ï¼Œåªæœ‰è°ƒç”¨joinæ–¹æ³•çš„çº¿ç¨‹å¯¹è±¡ç»“æŸæ‰èƒ½è®©å½“å‰çº¿ç¨‹æ¢å¤ï¼›</li></ul></li></ul></li></ul></li></ul><p>è¯´æ˜ï¼šå½“ä»WAITINGæˆ–TIMED_WAITINGæ¢å¤åˆ°RunnableçŠ¶æ€æ—¶ï¼Œå¦‚æœå‘ç°å½“å‰çº¿ç¨‹æ²¡æœ‰å¾—åˆ°ç›‘è§†å™¨é”ï¼Œé‚£ä¹ˆä¼šç«‹åˆ»è½¬å…¥BLOCKEDçŠ¶æ€ã€‚</p><p><img src="`+d+'" alt="image-20231007183328772"></p><p>æˆ–</p><p><img src="'+A+`" alt="image-20231007183338745"></p><blockquote><p>æˆ‘ä»¬åœ¨ç¿»é˜…APIçš„æ—¶å€™ä¼šå‘ç°Timed Waitingï¼ˆè®¡æ—¶ç­‰å¾…ï¼‰ ä¸ Waitingï¼ˆæ— é™ç­‰å¾…ï¼‰ çŠ¶æ€è”ç³»è¿˜æ˜¯å¾ˆç´§å¯†çš„ï¼Œ æ¯”å¦‚Waitingï¼ˆæ— é™ç­‰å¾…ï¼‰ çŠ¶æ€ä¸­waitæ–¹æ³•æ˜¯ç©ºå‚çš„ï¼Œè€Œtimed waitingï¼ˆè®¡æ—¶ç­‰å¾…ï¼‰ ä¸­waitæ–¹æ³•æ˜¯å¸¦å‚çš„ã€‚ è¿™ç§å¸¦å‚çš„æ–¹æ³•ï¼Œå…¶å®æ˜¯ä¸€ç§å€’è®¡æ—¶æ“ä½œï¼Œç›¸å½“äºæˆ‘ä»¬ç”Ÿæ´»ä¸­çš„å°é—¹é’Ÿï¼Œæˆ‘ä»¬è®¾å®šå¥½æ—¶é—´ï¼Œåˆ°æ—¶é€šçŸ¥ï¼Œå¯æ˜¯ å¦‚æœæå‰å¾—åˆ°ï¼ˆå”¤é†’ï¼‰é€šçŸ¥ï¼Œé‚£ä¹ˆè®¾å®šå¥½æ—¶é—´åœ¨é€šçŸ¥ä¹Ÿå°±æ˜¾å¾—å¤šæ­¤ä¸€ä¸¾äº†ï¼Œé‚£ä¹ˆè¿™ç§è®¾è®¡æ–¹æ¡ˆå…¶å®æ˜¯ä¸€ä¸¾ä¸¤ å¾—ã€‚å¦‚æœæ²¡æœ‰å¾—åˆ°ï¼ˆå”¤é†’ï¼‰é€šçŸ¥ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±å¤„äºTimed WaitingçŠ¶æ€ï¼Œç›´åˆ°å€’è®¡æ—¶å®Œæ¯•è‡ªåŠ¨é†’æ¥ï¼›å¦‚æœåœ¨å€’ è®¡æ—¶æœŸé—´å¾—åˆ°ï¼ˆå”¤é†’ï¼‰é€šçŸ¥ï¼Œé‚£ä¹ˆçº¿ç¨‹ä»Timed WaitingçŠ¶æ€ç«‹åˆ»å”¤é†’ã€‚</p></blockquote><p>ä¸¾ä¾‹</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#F97583;">@author</span><span style="color:#6A737D;"> å°šç¡…è°·-å®‹çº¢åº·</span></span>
<span class="line"><span style="color:#6A737D;"> * @create 22:15</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ThreadStateTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">throws</span><span style="color:#E1E4E8;"> InterruptedException {</span></span>
<span class="line"><span style="color:#E1E4E8;">        SubThread t </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SubThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(t.</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; çŠ¶æ€ &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> t.</span><span style="color:#B392F0;">getState</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">        t.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (Thread.State.TERMINATED </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> t.</span><span style="color:#B392F0;">getState</span><span style="color:#E1E4E8;">()) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(t.</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; çŠ¶æ€ &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> t.</span><span style="color:#B392F0;">getState</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">            Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(t.</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; çŠ¶æ€ &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> t.</span><span style="color:#B392F0;">getState</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SubThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ‰“å°ï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">                } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">break</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#D73A49;">@author</span><span style="color:#6A737D;"> å°šç¡…è°·-å®‹çº¢åº·</span></span>
<span class="line"><span style="color:#6A737D;"> * @create 22:15</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ThreadStateTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> InterruptedException {</span></span>
<span class="line"><span style="color:#24292E;">        SubThread t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SubThread</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(t.</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; çŠ¶æ€ &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> t.</span><span style="color:#6F42C1;">getState</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        t.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (Thread.State.TERMINATED </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> t.</span><span style="color:#6F42C1;">getState</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(t.</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; çŠ¶æ€ &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> t.</span><span style="color:#6F42C1;">getState</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">            Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">500</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(t.</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; çŠ¶æ€ &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> t.</span><span style="color:#6F42C1;">getState</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SubThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ‰“å°ï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                    Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">break</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>å‘½ä»¤è¡Œæ¼”ç¤ºï¼š</p><p><img src="`+h+'" alt="image-20231007183416972"></p><h2 id="äº”ã€çº¿ç¨‹å®‰å…¨é—®é¢˜åŠè§£å†³" tabindex="-1">äº”ã€çº¿ç¨‹å®‰å…¨é—®é¢˜åŠè§£å†³ <a class="header-anchor" href="#äº”ã€çº¿ç¨‹å®‰å…¨é—®é¢˜åŠè§£å†³" aria-label="Permalink to &quot;äº”ã€çº¿ç¨‹å®‰å…¨é—®é¢˜åŠè§£å†³&quot;">â€‹</a></h2><p>å½“æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªçº¿ç¨‹è®¿é—®<strong>åŒä¸€èµ„æº</strong>ï¼ˆå¯ä»¥æ˜¯åŒä¸€ä¸ªå˜é‡ã€åŒä¸€ä¸ªæ–‡ä»¶ã€åŒä¸€æ¡è®°å½•ç­‰ï¼‰çš„æ—¶å€™ï¼Œè‹¥å¤šä¸ªçº¿ç¨‹<code>åªæœ‰è¯»æ“ä½œ</code>ï¼Œé‚£ä¹ˆä¸ä¼šå‘ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹ä¸­å¯¹èµ„æºæœ‰<code>è¯»å’Œå†™</code>çš„æ“ä½œï¼Œå°±å®¹æ˜“å‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><p>ä¸¾ä¾‹ï¼š</p><p><img src="'+C+`" alt="image-20231009180453045"></p><h3 id="_5-1-åŒä¸€ä¸ªèµ„æºé—®é¢˜å’Œçº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1">5.1 åŒä¸€ä¸ªèµ„æºé—®é¢˜å’Œçº¿ç¨‹å®‰å…¨é—®é¢˜ <a class="header-anchor" href="#_5-1-åŒä¸€ä¸ªèµ„æºé—®é¢˜å’Œçº¿ç¨‹å®‰å…¨é—®é¢˜" aria-label="Permalink to &quot;5.1 åŒä¸€ä¸ªèµ„æºé—®é¢˜å’Œçº¿ç¨‹å®‰å…¨é—®é¢˜&quot;">â€‹</a></h3><p>æ¡ˆä¾‹ï¼š</p><p>ç«è½¦ç«™è¦å–ç¥¨ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿç«è½¦ç«™çš„å–ç¥¨è¿‡ç¨‹ã€‚å› ä¸ºç–«æƒ…æœŸé—´ï¼Œæœ¬æ¬¡åˆ—è½¦çš„åº§ä½å…±100ä¸ªï¼ˆå³ï¼Œåªèƒ½å‡ºå”®100å¼ ç«è½¦ç¥¨ï¼‰ã€‚æ¨¡æ‹Ÿè½¦ç«™çš„å”®ç¥¨çª—å£ï¼Œå®ç°å¤šä¸ªçª—å£åŒæ—¶å”®ç¥¨çš„è¿‡ç¨‹ã€‚æ³¨æ„ï¼šä¸èƒ½å‡ºç°é”™ç¥¨ã€é‡ç¥¨ã€‚</p><h4 id="_5-1-1-å±€éƒ¨å˜é‡ä¸èƒ½å…±äº«" tabindex="-1">5.1.1 å±€éƒ¨å˜é‡ä¸èƒ½å…±äº« <a class="header-anchor" href="#_5-1-1-å±€éƒ¨å˜é‡ä¸èƒ½å…±äº«" aria-label="Permalink to &quot;5.1.1 å±€éƒ¨å˜é‡ä¸èƒ½å…±äº«&quot;">â€‹</a></h4><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo1</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Window w1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        Window w2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        Window w3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        w1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        w2.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        w3.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£3&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        w1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        w2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        w3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo1</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        Window w1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        Window w2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        Window w3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        w1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        w2.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        w3.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£3&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        w1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        w2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        w3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç»“æœï¼šå‘ç°å–å‡º300å¼ ç¥¨ã€‚</p><p>é—®é¢˜ï¼šå±€éƒ¨å˜é‡æ˜¯æ¯æ¬¡è°ƒç”¨æ–¹æ³•éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹çš„run()çš„ticketæ˜¯ç‹¬ç«‹çš„ï¼Œä¸æ˜¯å…±äº«æ•°æ®ã€‚</p><h4 id="_5-1-2-ä¸åŒå¯¹è±¡çš„å®ä¾‹å˜é‡ä¸å…±äº«" tabindex="-1">5.1.2 ä¸åŒå¯¹è±¡çš„å®ä¾‹å˜é‡ä¸å…±äº« <a class="header-anchor" href="#_5-1-2-ä¸åŒå¯¹è±¡çš„å®ä¾‹å˜é‡ä¸å…±äº«" aria-label="Permalink to &quot;5.1.2 ä¸åŒå¯¹è±¡çš„å®ä¾‹å˜é‡ä¸å…±äº«&quot;">â€‹</a></h4><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketWindow</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo2</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketWindow w1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketWindow</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketWindow w2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketWindow</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketWindow w3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketWindow</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        w1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        w2.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        w3.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£3&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        w1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        w2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        w3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketWindow</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo2</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        TicketWindow w1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketWindow</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketWindow w2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketWindow</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketWindow w3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketWindow</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        w1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        w2.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        w3.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£3&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        w1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        w2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        w3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç»“æœï¼šå‘ç°å–å‡º300å¼ ç¥¨ã€‚</p><p>é—®é¢˜ï¼šä¸åŒçš„å®ä¾‹å¯¹è±¡çš„å®ä¾‹å˜é‡æ˜¯ç‹¬ç«‹çš„ã€‚</p><h4 id="_5-1-3-é™æ€å˜é‡æ˜¯å…±äº«çš„" tabindex="-1">5.1.3 é™æ€å˜é‡æ˜¯å…±äº«çš„ <a class="header-anchor" href="#_5-1-3-é™æ€å˜é‡æ˜¯å…±äº«çš„" aria-label="Permalink to &quot;5.1.3 é™æ€å˜é‡æ˜¯å…±äº«çš„&quot;">â€‹</a></h4><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">//åŠ å…¥è¿™ä¸ªï¼Œä½¿å¾—é—®é¢˜æš´éœ²çš„æ›´æ˜æ˜¾</span></span>
<span class="line"><span style="color:#E1E4E8;">            } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo3</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£3&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.unsafe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//åŠ å…¥è¿™ä¸ªï¼Œä½¿å¾—é—®é¢˜æš´éœ²çš„æ›´æ˜æ˜¾</span></span>
<span class="line"><span style="color:#24292E;">            } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo3</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£3&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>è¿è¡Œç»“æœï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span>
<span class="line"><span style="color:#B392F0;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:100</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:97</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:94</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:91</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:88</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:85</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:82</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:79</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:76</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:73</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:70</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:67</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:64</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:61</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:58</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:55</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:52</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:49</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:46</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:43</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:40</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:37</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:34</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:31</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:28</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:25</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:22</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:19</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:16</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:13</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:10</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:7</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:4</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£3å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£2å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span>
<span class="line"><span style="color:#6F42C1;">çª—å£1å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:1</span></span></code></pre></div><h4 id="_5-1-4-åŒä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡å…±äº«" tabindex="-1">5.1.4 åŒä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡å…±äº« <a class="header-anchor" href="#_5-1-4-åŒä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡å…±äº«" aria-label="Permalink to &quot;5.1.4 åŒä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡å…±äº«&quot;">â€‹</a></h4><p>ç¤ºä¾‹ä»£ç ï¼šå¤šä¸ªThreadçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªRunnableå¯¹è±¡</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleRunnable</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">//åŠ å…¥è¿™ä¸ªï¼Œä½¿å¾—é—®é¢˜æš´éœ²çš„æ›´æ˜æ˜¾</span></span>
<span class="line"><span style="color:#E1E4E8;">            } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo4</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleRunnable tr </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleRunnable</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£ä¸€&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£äºŒ&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleRunnable</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//åŠ å…¥è¿™ä¸ªï¼Œä½¿å¾—é—®é¢˜æš´éœ²çš„æ›´æ˜æ˜¾</span></span>
<span class="line"><span style="color:#24292E;">            } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo4</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleRunnable tr </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleRunnable</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£ä¸€&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£äºŒ&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Thread t3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç»“æœï¼šå‘ç°å–å‡ºè¿‘100å¼ ç¥¨ã€‚</p><p>é—®é¢˜ï¼šä½†æ˜¯æœ‰é‡å¤ç¥¨æˆ–è´Ÿæ•°ç¥¨é—®é¢˜ã€‚</p><p>åŸå› ï¼šçº¿ç¨‹å®‰å…¨é—®é¢˜</p><h3 id="_5-2-åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1">5.2 åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ <a class="header-anchor" href="#_5-2-åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜" aria-label="Permalink to &quot;5.2 åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜&quot;">â€‹</a></h3><p>è¦è§£å†³ä¸Šè¿°å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¸€ä¸ªèµ„æºçš„å®‰å…¨æ€§é—®é¢˜:ä¹Ÿå°±æ˜¯è§£å†³é‡å¤ç¥¨ä¸ä¸å­˜åœ¨ç¥¨é—®é¢˜ï¼ŒJavaä¸­æä¾›äº†åŒæ­¥æœºåˆ¶ (synchronized)æ¥è§£å†³ã€‚</p><p><img src="`+D+`" alt="image-20231009181529118"></p><h4 id="_5-2-1-åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„åŸç†" tabindex="-1">5.2.1 åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„åŸç† <a class="header-anchor" href="#_5-2-1-åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„åŸç†" aria-label="Permalink to &quot;5.2.1 åŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„åŸç†&quot;">â€‹</a></h4><p>åŒæ­¥æœºåˆ¶çš„åŸç†ï¼Œå…¶å®å°±ç›¸å½“äºç»™æŸæ®µä»£ç åŠ â€œé”â€ï¼Œä»»ä½•çº¿ç¨‹æƒ³è¦æ‰§è¡Œè¿™æ®µä»£ç ï¼Œéƒ½è¦å…ˆè·å¾—â€œé”â€ï¼Œæˆ‘ä»¬ç§°å®ƒä¸ºåŒæ­¥é”ã€‚å› ä¸ºJavaå¯¹è±¡åœ¨å †ä¸­çš„æ•°æ®åˆ†ä¸ºåˆ†ä¸ºå¯¹è±¡å¤´ã€å®ä¾‹å˜é‡ã€ç©ºç™½çš„å¡«å……ã€‚è€Œå¯¹è±¡å¤´ä¸­åŒ…å«ï¼š</p><ul><li>Mark Wordï¼šè®°å½•äº†å’Œå½“å‰å¯¹è±¡æœ‰å…³çš„GCã€é”æ ‡è®°ç­‰ä¿¡æ¯ã€‚</li><li>æŒ‡å‘ç±»çš„æŒ‡é’ˆï¼šæ¯ä¸€ä¸ªå¯¹è±¡éœ€è¦è®°å½•å®ƒæ˜¯ç”±å“ªä¸ªç±»åˆ›å»ºå‡ºæ¥çš„ã€‚</li><li>æ•°ç»„é•¿åº¦ï¼ˆåªæœ‰æ•°ç»„å¯¹è±¡æ‰æœ‰ï¼‰</li></ul><p>å“ªä¸ªçº¿ç¨‹è·å¾—äº†â€œåŒæ­¥é”â€å¯¹è±¡ä¹‹åï¼Œâ€åŒæ­¥é”â€œå¯¹è±¡å°±ä¼šè®°å½•è¿™ä¸ªçº¿ç¨‹çš„IDï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹å°±åªèƒ½ç­‰å¾…äº†ï¼Œé™¤éè¿™ä¸ªçº¿ç¨‹â€é‡Šæ”¾â€œäº†é”å¯¹è±¡ï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½é‡æ–°è·å¾—/å ç”¨â€åŒæ­¥é”â€œå¯¹è±¡ã€‚</p><h4 id="_5-2-2-åŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•" tabindex="-1">5.2.2 åŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³• <a class="header-anchor" href="#_5-2-2-åŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•" aria-label="Permalink to &quot;5.2.2 åŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•&quot;">â€‹</a></h4><p><strong>åŒæ­¥ä»£ç å—</strong>ï¼šsynchronized å…³é”®å­—å¯ä»¥ç”¨äºæŸä¸ªåŒºå—å‰é¢ï¼Œè¡¨ç¤ºåªå¯¹è¿™ä¸ªåŒºå—çš„èµ„æºå®è¡Œäº’æ–¥è®¿é—®ã€‚ æ ¼å¼:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;">(åŒæ­¥é”){</span></span>
<span class="line"><span style="color:#E1E4E8;">Â Â Â Â Â éœ€è¦åŒæ­¥æ“ä½œçš„ä»£ç </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;">(åŒæ­¥é”){</span></span>
<span class="line"><span style="color:#24292E;">Â Â Â Â Â éœ€è¦åŒæ­¥æ“ä½œçš„ä»£ç </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>**åŒæ­¥æ–¹æ³•ï¼š**synchronized å…³é”®å­—ç›´æ¥ä¿®é¥°æ–¹æ³•ï¼Œè¡¨ç¤ºåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹åœ¨å¤–é¢ç­‰ç€ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;">Â </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;">Â </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;">Â </span><span style="color:#B392F0;">method</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">Â Â Â  å¯èƒ½ä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜çš„ä»£ç </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;">Â </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;">Â </span><span style="color:#D73A49;">void</span><span style="color:#24292E;">Â </span><span style="color:#6F42C1;">method</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">Â Â Â  å¯èƒ½ä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜çš„ä»£ç </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_5-2-3-åŒæ­¥é”æœºåˆ¶" tabindex="-1">5.2.3 åŒæ­¥é”æœºåˆ¶ <a class="header-anchor" href="#_5-2-3-åŒæ­¥é”æœºåˆ¶" aria-label="Permalink to &quot;5.2.3 åŒæ­¥é”æœºåˆ¶&quot;">â€‹</a></h4><p>åœ¨ã€ŠThinking in Javaã€‹ä¸­ï¼Œæ˜¯è¿™ä¹ˆè¯´çš„ï¼šå¯¹äºå¹¶å‘å·¥ä½œï¼Œä½ éœ€è¦æŸç§æ–¹å¼æ¥é˜²æ­¢ä¸¤ä¸ªä»»åŠ¡è®¿é—®ç›¸åŒçš„èµ„æºï¼ˆå…¶å®å°±æ˜¯å…±äº«èµ„æºç«äº‰ï¼‰ã€‚ é˜²æ­¢è¿™ç§å†²çªçš„æ–¹æ³•å°±æ˜¯å½“èµ„æºè¢«ä¸€ä¸ªä»»åŠ¡ä½¿ç”¨æ—¶ï¼Œåœ¨å…¶ä¸ŠåŠ é”ã€‚ç¬¬ä¸€ä¸ªè®¿é—®æŸé¡¹èµ„æºçš„ä»»åŠ¡å¿…é¡»é”å®šè¿™é¡¹èµ„æºï¼Œä½¿å…¶ä»–ä»»åŠ¡åœ¨å…¶è¢«è§£é”ä¹‹å‰ï¼Œå°±æ— æ³•è®¿é—®å®ƒäº†ï¼Œè€Œåœ¨å…¶è¢«è§£é”ä¹‹æ—¶ï¼Œå¦ä¸€ä¸ªä»»åŠ¡å°±å¯ä»¥é”å®šå¹¶ä½¿ç”¨å®ƒäº†ã€‚</p><h4 id="_5-2-4-synchronizedçš„é”æ˜¯ä»€ä¹ˆ" tabindex="-1">5.2.4 synchronizedçš„é”æ˜¯ä»€ä¹ˆ <a class="header-anchor" href="#_5-2-4-synchronizedçš„é”æ˜¯ä»€ä¹ˆ" aria-label="Permalink to &quot;5.2.4 synchronizedçš„é”æ˜¯ä»€ä¹ˆ&quot;">â€‹</a></h4><p>åŒæ­¥é”å¯¹è±¡å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œä½†æ˜¯å¿…é¡»ä¿è¯ç«äº‰â€œåŒä¸€ä¸ªå…±äº«èµ„æºâ€çš„å¤šä¸ªçº¿ç¨‹å¿…é¡»ä½¿ç”¨åŒä¸€ä¸ªâ€œåŒæ­¥é”å¯¹è±¡â€ã€‚</p><p>å¯¹äºåŒæ­¥ä»£ç å—æ¥è¯´ï¼ŒåŒæ­¥é”å¯¹è±¡æ˜¯ç”±ç¨‹åºå‘˜æ‰‹åŠ¨æŒ‡å®šçš„ï¼ˆå¾ˆå¤šæ—¶å€™ä¹Ÿæ˜¯æŒ‡å®šä¸ºthisæˆ–ç±»å.classï¼‰ï¼Œä½†æ˜¯å¯¹äºåŒæ­¥æ–¹æ³•æ¥è¯´ï¼ŒåŒæ­¥é”å¯¹è±¡åªèƒ½æ˜¯é»˜è®¤çš„ï¼š</p><ul><li><p>é™æ€æ–¹æ³•ï¼šå½“å‰ç±»çš„Classå¯¹è±¡ï¼ˆç±»å.classï¼‰</p></li><li><p>éé™æ€æ–¹æ³•ï¼šthis</p></li></ul><h4 id="_5-2-5-åŒæ­¥æ“ä½œçš„æ€è€ƒé¡ºåº" tabindex="-1">5.2.5 åŒæ­¥æ“ä½œçš„æ€è€ƒé¡ºåº <a class="header-anchor" href="#_5-2-5-åŒæ­¥æ“ä½œçš„æ€è€ƒé¡ºåº" aria-label="Permalink to &quot;5.2.5 åŒæ­¥æ“ä½œçš„æ€è€ƒé¡ºåº&quot;">â€‹</a></h4><p>1ã€å¦‚ä½•æ‰¾é—®é¢˜ï¼Œå³ä»£ç æ˜¯å¦å­˜åœ¨çº¿ç¨‹å®‰å…¨ï¼Ÿï¼ˆéå¸¸é‡è¦ï¼‰ ï¼ˆ1ï¼‰æ˜ç¡®å“ªäº›ä»£ç æ˜¯å¤šçº¿ç¨‹è¿è¡Œçš„ä»£ç  ï¼ˆ2ï¼‰æ˜ç¡®å¤šä¸ªçº¿ç¨‹æ˜¯å¦æœ‰å…±äº«æ•°æ® ï¼ˆ3ï¼‰æ˜ç¡®å¤šçº¿ç¨‹è¿è¡Œä»£ç ä¸­æ˜¯å¦æœ‰å¤šæ¡è¯­å¥æ“ä½œå…±äº«æ•°æ®</p><p>2ã€å¦‚ä½•è§£å†³å‘¢ï¼Ÿï¼ˆéå¸¸é‡è¦ï¼‰ å¯¹å¤šæ¡æ“ä½œå…±äº«æ•°æ®çš„è¯­å¥ï¼Œåªèƒ½è®©ä¸€ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œå®Œï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–çº¿ç¨‹ä¸å¯ä»¥å‚ä¸æ‰§è¡Œã€‚ å³æ‰€æœ‰æ“ä½œå…±äº«æ•°æ®çš„è¿™äº›è¯­å¥éƒ½è¦æ”¾åœ¨åŒæ­¥èŒƒå›´ä¸­</p><p>3ã€åˆ‡è®°ï¼š</p><p>èŒƒå›´å¤ªå°ï¼šä¸èƒ½è§£å†³å®‰å…¨é—®é¢˜</p><p>èŒƒå›´å¤ªå¤§ï¼šå› ä¸ºä¸€æ—¦æŸä¸ªçº¿ç¨‹æŠ¢åˆ°é”ï¼Œå…¶ä»–çº¿ç¨‹å°±åªèƒ½ç­‰å¾…ï¼Œæ‰€ä»¥èŒƒå›´å¤ªå¤§ï¼Œæ•ˆç‡ä¼šé™ä½ï¼Œä¸èƒ½åˆç†åˆ©ç”¨CPUèµ„æºã€‚</p><h4 id="_5-2-6-ä»£ç æ¼”ç¤º" tabindex="-1">5.2.6 ä»£ç æ¼”ç¤º <a class="header-anchor" href="#_5-2-6-ä»£ç æ¼”ç¤º" aria-label="Permalink to &quot;5.2.6 ä»£ç æ¼”ç¤º&quot;">â€‹</a></h4><h5 id="ç¤ºä¾‹ä¸€-é™æ€æ–¹æ³•åŠ é”" tabindex="-1">ç¤ºä¾‹ä¸€ï¼šé™æ€æ–¹æ³•åŠ é” <a class="header-anchor" href="#ç¤ºä¾‹ä¸€-é™æ€æ–¹æ³•åŠ é”" aria-label="Permalink to &quot;ç¤ºä¾‹ä¸€ï¼šé™æ€æ–¹æ³•åŠ é”&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span><span style="color:#6A737D;">//ç›´æ¥é”è¿™é‡Œï¼Œè‚¯å®šä¸è¡Œï¼Œä¼šå¯¼è‡´ï¼Œåªæœ‰ä¸€ä¸ªçª—å£å–ç¥¨</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">saleOneTicket</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">saleOneTicket</span><span style="color:#E1E4E8;">(){</span><span style="color:#6A737D;">//é”å¯¹è±¡æ˜¯TicketSaleThreadç±»çš„Classå¯¹è±¡ï¼Œè€Œä¸€ä¸ªç±»çš„Classå¯¹è±¡åœ¨å†…å­˜ä¸­è‚¯å®šåªæœ‰ä¸€ä¸ª</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span><span style="color:#6A737D;">//ä¸åŠ æ¡ä»¶ï¼Œç›¸å½“äºæ¡ä»¶åˆ¤æ–­æ²¡æœ‰è¿›å…¥é”ç®¡æ§ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜å°±æ²¡æœ‰è§£å†³</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo3</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleThread t3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£3&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span><span style="color:#6A737D;">//ç›´æ¥é”è¿™é‡Œï¼Œè‚¯å®šä¸è¡Œï¼Œä¼šå¯¼è‡´ï¼Œåªæœ‰ä¸€ä¸ªçª—å£å–ç¥¨</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">saleOneTicket</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">saleOneTicket</span><span style="color:#24292E;">(){</span><span style="color:#6A737D;">//é”å¯¹è±¡æ˜¯TicketSaleThreadç±»çš„Classå¯¹è±¡ï¼Œè€Œä¸€ä¸ªç±»çš„Classå¯¹è±¡åœ¨å†…å­˜ä¸­è‚¯å®šåªæœ‰ä¸€ä¸ª</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span><span style="color:#6A737D;">//ä¸åŠ æ¡ä»¶ï¼Œç›¸å½“äºæ¡ä»¶åˆ¤æ–­æ²¡æœ‰è¿›å…¥é”ç®¡æ§ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜å°±æ²¡æœ‰è§£å†³</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo3</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleThread t3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleThread</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£3&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç¤ºä¾‹äºŒï¼šéé™æ€æ–¹æ³•åŠ é”</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo4</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        TicketSaleRunnable tr </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleRunnable</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£ä¸€&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£äºŒ&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(tr, </span><span style="color:#9ECBFF;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TicketSaleRunnable</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span><span style="color:#6A737D;">//ç›´æ¥é”è¿™é‡Œï¼Œè‚¯å®šä¸è¡Œï¼Œä¼šå¯¼è‡´ï¼Œåªæœ‰ä¸€ä¸ªçª—å£å–ç¥¨</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">saleOneTicket</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">saleOneTicket</span><span style="color:#E1E4E8;">() {</span><span style="color:#6A737D;">//é”å¯¹è±¡æ˜¯thisï¼Œè¿™é‡Œå°±æ˜¯TicketSaleRunnableå¯¹è±¡ï¼Œå› ä¸ºä¸Šé¢3ä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªTicketSaleRunnableå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span><span style="color:#6A737D;">//ä¸åŠ æ¡ä»¶ï¼Œç›¸å½“äºæ¡ä»¶åˆ¤æ–­æ²¡æœ‰è¿›å…¥é”ç®¡æ§ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜å°±æ²¡æœ‰è§£å†³</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo4</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        TicketSaleRunnable tr </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleRunnable</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£ä¸€&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£äºŒ&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Thread t3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(tr, </span><span style="color:#032F62;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TicketSaleRunnable</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span><span style="color:#6A737D;">//ç›´æ¥é”è¿™é‡Œï¼Œè‚¯å®šä¸è¡Œï¼Œä¼šå¯¼è‡´ï¼Œåªæœ‰ä¸€ä¸ªçª—å£å–ç¥¨</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">saleOneTicket</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">saleOneTicket</span><span style="color:#24292E;">() {</span><span style="color:#6A737D;">//é”å¯¹è±¡æ˜¯thisï¼Œè¿™é‡Œå°±æ˜¯TicketSaleRunnableå¯¹è±¡ï¼Œå› ä¸ºä¸Šé¢3ä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªTicketSaleRunnableå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span><span style="color:#6A737D;">//ä¸åŠ æ¡ä»¶ï¼Œç›¸å½“äºæ¡ä»¶åˆ¤æ–­æ²¡æœ‰è¿›å…¥é”ç®¡æ§ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜å°±æ²¡æœ‰è§£å†³</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç¤ºä¾‹ä¸‰ï¼šåŒæ­¥ä»£ç å—</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SaleTicketDemo5</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//2ã€åˆ›å»ºèµ„æºå¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        Ticket ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ticket</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//3ã€å¯åŠ¨å¤šä¸ªçº¿ç¨‹æ“ä½œèµ„æºç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£ä¸€&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span><span style="color:#6A737D;">//ä¸èƒ½ç»™run()ç›´æ¥åŠ é”ï¼Œå› ä¸ºt1,t2,t3çš„ä¸‰ä¸ªrunæ–¹æ³•åˆ†åˆ«å±äºä¸‰ä¸ªThreadç±»å¯¹è±¡ï¼Œ</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">// runæ–¹æ³•æ˜¯éé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆé”å¯¹è±¡é»˜è®¤é€‰thisï¼Œé‚£ä¹ˆé”å¯¹è±¡æ ¹æœ¬ä¸æ˜¯åŒä¸€ä¸ª</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (ticket) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        ticket.</span><span style="color:#B392F0;">sale</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;çª—å£äºŒ&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (ticket) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        ticket.</span><span style="color:#B392F0;">sale</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t3 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (ticket) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        ticket.</span><span style="color:#B392F0;">sale</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }, </span><span style="color:#9ECBFF;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t3.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//1ã€ç¼–å†™èµ„æºç±»</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ticket</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sale</span><span style="color:#E1E4E8;">() {</span><span style="color:#6A737D;">//ä¹Ÿå¯ä»¥ç›´æ¥ç»™è¿™ä¸ªæ–¹æ³•åŠ é”ï¼Œé”å¯¹è±¡æ˜¯thisï¼Œè¿™é‡Œå°±æ˜¯Ticketå¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> ticket);</span></span>
<span class="line"><span style="color:#E1E4E8;">            ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RuntimeException</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ²¡æœ‰ç¥¨äº†&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getTicket</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> ticket;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.safe;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SaleTicketDemo5</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//2ã€åˆ›å»ºèµ„æºå¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        Ticket ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ticket</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//3ã€å¯åŠ¨å¤šä¸ªçº¿ç¨‹æ“ä½œèµ„æºç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£ä¸€&quot;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span><span style="color:#6A737D;">//ä¸èƒ½ç»™run()ç›´æ¥åŠ é”ï¼Œå› ä¸ºt1,t2,t3çš„ä¸‰ä¸ªrunæ–¹æ³•åˆ†åˆ«å±äºä¸‰ä¸ªThreadç±»å¯¹è±¡ï¼Œ</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// runæ–¹æ³•æ˜¯éé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆé”å¯¹è±¡é»˜è®¤é€‰thisï¼Œé‚£ä¹ˆé”å¯¹è±¡æ ¹æœ¬ä¸æ˜¯åŒä¸€ä¸ª</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (ticket) {</span></span>
<span class="line"><span style="color:#24292E;">                        ticket.</span><span style="color:#6F42C1;">sale</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;çª—å£äºŒ&quot;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (ticket) {</span></span>
<span class="line"><span style="color:#24292E;">                        ticket.</span><span style="color:#6F42C1;">sale</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        Thread t3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (ticket) {</span></span>
<span class="line"><span style="color:#24292E;">                        ticket.</span><span style="color:#6F42C1;">sale</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }, </span><span style="color:#032F62;">&quot;çª—å£ä¸‰&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t3.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//1ã€ç¼–å†™èµ„æºç±»</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ticket</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sale</span><span style="color:#24292E;">() {</span><span style="color:#6A737D;">//ä¹Ÿå¯ä»¥ç›´æ¥ç»™è¿™ä¸ªæ–¹æ³•åŠ é”ï¼Œé”å¯¹è±¡æ˜¯thisï¼Œè¿™é‡Œå°±æ˜¯Ticketå¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å–å‡ºä¸€å¼ ç¥¨ï¼Œç¥¨å·:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> ticket);</span></span>
<span class="line"><span style="color:#24292E;">            ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RuntimeException</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ²¡æœ‰ç¥¨äº†&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getTicket</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ticket;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_5-3-ç»ƒä¹ " tabindex="-1">5.3 ç»ƒä¹  <a class="header-anchor" href="#_5-3-ç»ƒä¹ " aria-label="Permalink to &quot;5.3 ç»ƒä¹ &quot;">â€‹</a></h3><p>é“¶è¡Œæœ‰ä¸€ä¸ªè´¦æˆ·ã€‚ æœ‰ä¸¤ä¸ªå‚¨æˆ·åˆ†åˆ«å‘åŒä¸€ä¸ªè´¦æˆ·å­˜3000å…ƒï¼Œæ¯æ¬¡å­˜1000ï¼Œå­˜3æ¬¡ã€‚æ¯æ¬¡å­˜å®Œæ‰“å°è´¦æˆ·ä½™é¢ã€‚</p><p>é—®é¢˜ï¼šè¯¥ç¨‹åºæ˜¯å¦æœ‰å®‰å…¨é—®é¢˜ï¼Œå¦‚æœæœ‰ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ</p><p>ã€æç¤ºã€‘ 1ï¼Œæ˜ç¡®å“ªäº›ä»£ç æ˜¯å¤šçº¿ç¨‹è¿è¡Œä»£ç ï¼Œé¡»å†™å…¥run()æ–¹æ³• 2ï¼Œæ˜ç¡®ä»€ä¹ˆæ˜¯å…±äº«æ•°æ®ã€‚ 3ï¼Œæ˜ç¡®å¤šçº¿ç¨‹è¿è¡Œä»£ç ä¸­å“ªäº›è¯­å¥æ˜¯æ“ä½œå…±äº«æ•°æ®çš„ã€‚</p><p>ã€æ‹“å±•é—®é¢˜ã€‘å¯å¦å®ç°ä¸¤ä¸ªå‚¨æˆ·äº¤æ›¿å­˜é’±çš„æ“ä½œ</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">A</span><span style="color:#E1E4E8;">ccount</span><span style="color:#FDAEB7;font-style:italic;">T</span><span style="color:#E1E4E8;">est;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#F97583;">@author</span><span style="color:#6A737D;"> smallTiger</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">AccountTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Account acct </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Account</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Customer customer1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(acct,</span><span style="color:#9ECBFF;">&quot;ç”²&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Customer customer2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(acct,</span><span style="color:#9ECBFF;">&quot;ä¹™&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        customer1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        customer2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Account</span><span style="color:#E1E4E8;">{ </span><span style="color:#6A737D;">//è´¦æˆ·</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">double</span><span style="color:#E1E4E8;"> balance;</span><span style="color:#6A737D;">//ä½™é¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">deposit</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">double</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">amt</span><span style="color:#E1E4E8;">){ </span><span style="color:#6A737D;">//this:æ˜¯ä¸æ˜¯å”¯ä¸€çš„ï¼Ÿå³ä¸ºacct,æ˜¯å”¯ä¸€çš„ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(amt </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            balance </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> amt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> balance);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    Account account;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(Account </span><span style="color:#FFAB70;">acct</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.account </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> acct;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(Account </span><span style="color:#FFAB70;">acct</span><span style="color:#E1E4E8;">,String </span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">super</span><span style="color:#E1E4E8;">(name);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.account </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> acct;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">            } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            account.</span><span style="color:#B392F0;">deposit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">A</span><span style="color:#24292E;">ccount</span><span style="color:#B31D28;font-style:italic;">T</span><span style="color:#24292E;">est;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#D73A49;">@author</span><span style="color:#6A737D;"> smallTiger</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Account acct </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Account</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Customer customer1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(acct,</span><span style="color:#032F62;">&quot;ç”²&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Customer customer2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(acct,</span><span style="color:#032F62;">&quot;ä¹™&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        customer1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        customer2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Account</span><span style="color:#24292E;">{ </span><span style="color:#6A737D;">//è´¦æˆ·</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">double</span><span style="color:#24292E;"> balance;</span><span style="color:#6A737D;">//ä½™é¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">deposit</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">double</span><span style="color:#24292E;"> </span><span style="color:#E36209;">amt</span><span style="color:#24292E;">){ </span><span style="color:#6A737D;">//this:æ˜¯ä¸æ˜¯å”¯ä¸€çš„ï¼Ÿå³ä¸ºacct,æ˜¯å”¯ä¸€çš„ã€‚</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(amt </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            balance </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> amt;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> balance);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    Account account;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(Account </span><span style="color:#E36209;">acct</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.account </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> acct;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(Account </span><span style="color:#E36209;">acct</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">name</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">super</span><span style="color:#24292E;">(name);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.account </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> acct;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            account.</span><span style="color:#6F42C1;">deposit</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š1000.0</span></span>
<span class="line"><span style="color:#B392F0;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š2000.0</span></span>
<span class="line"><span style="color:#B392F0;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š3000.0</span></span>
<span class="line"><span style="color:#B392F0;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š4000.0</span></span>
<span class="line"><span style="color:#B392F0;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š5000.0</span></span>
<span class="line"><span style="color:#B392F0;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š6000.0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š1000.0</span></span>
<span class="line"><span style="color:#6F42C1;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š2000.0</span></span>
<span class="line"><span style="color:#6F42C1;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š3000.0</span></span>
<span class="line"><span style="color:#6F42C1;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š4000.0</span></span>
<span class="line"><span style="color:#6F42C1;">ç”²å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š5000.0</span></span>
<span class="line"><span style="color:#6F42C1;">ä¹™å­˜é’±1000å—ï¼Œä½™é¢ä¸ºï¼š6000.0</span></span></code></pre></div><h2 id="å…­ã€-å†è°ˆåŒæ­¥" tabindex="-1">å…­ã€ å†è°ˆåŒæ­¥ <a class="header-anchor" href="#å…­ã€-å†è°ˆåŒæ­¥" aria-label="Permalink to &quot;å…­ã€ å†è°ˆåŒæ­¥&quot;">â€‹</a></h2><h3 id="_6-1-å•ä¾‹è®¾è®¡æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1">6.1 å•ä¾‹è®¾è®¡æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ <a class="header-anchor" href="#_6-1-å•ä¾‹è®¾è®¡æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨é—®é¢˜" aria-label="Permalink to &quot;6.1 å•ä¾‹è®¾è®¡æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨é—®é¢˜&quot;">â€‹</a></h3><p>é¥¿æ±‰å¼ï¼šåœ¨ç±»åˆå§‹åŒ–æ—¶å°±ç›´æ¥åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œè€Œç±»åˆå§‹åŒ–è¿‡ç¨‹æ˜¯æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜çš„</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.single.hungry;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HungrySingle</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> HungrySingle INSTANCE </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HungrySingle</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">//å¯¹è±¡æ˜¯å¦å£°æ˜ä¸ºfinal éƒ½å¯ä»¥</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HungrySingle</span><span style="color:#E1E4E8;">(){}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> HungrySingle </span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> INSTANCE;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.single.hungry;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HungrySingle</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> HungrySingle INSTANCE </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HungrySingle</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">//å¯¹è±¡æ˜¯å¦å£°æ˜ä¸ºfinal éƒ½å¯ä»¥</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HungrySingle</span><span style="color:#24292E;">(){}</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> HungrySingle </span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> INSTANCE;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>æµ‹è¯•ç±»ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.single.hungry;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HungrySingleTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> HungrySingle hs1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> HungrySingle hs2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//æ¼”ç¤ºå­˜åœ¨çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">            @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                hs1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> HungrySingle.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">            @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">                hs2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> HungrySingle.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            t1.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            t2.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(hs1);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(hs2);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(hs1 </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> hs2);</span><span style="color:#6A737D;">//true</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.single.hungry;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HungrySingleTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> HungrySingle hs1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> HungrySingle hs2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ¼”ç¤ºå­˜åœ¨çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">            @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                hs1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> HungrySingle.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">            @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">                hs2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> HungrySingle.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            t1.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            t2.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(hs1);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(hs2);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(hs1 </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> hs2);</span><span style="color:#6A737D;">//true</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_6-1-2-æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1">6.1.2 æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨é—®é¢˜ <a class="header-anchor" href="#_6-1-2-æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨é—®é¢˜" aria-label="Permalink to &quot;6.1.2 æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨é—®é¢˜&quot;">â€‹</a></h4><p>æ‡’æ±‰å¼ï¼šå»¶è¿Ÿåˆ›å»ºå¯¹è±¡ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceæ–¹æ³•å†åˆ›å»ºå¯¹è±¡</p><p>å½¢å¼ä¸€ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazyOne</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> LazyOne instance;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazyOne</span><span style="color:#E1E4E8;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//æ–¹å¼1ï¼š</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> LazyOne </span><span style="color:#B392F0;">getInstance1</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(instance </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            instance </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazyOne</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> instance;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//æ–¹å¼2ï¼š</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> LazyOne </span><span style="color:#B392F0;">getInstance2</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;">(LazyOne.class) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (instance </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                instance </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazyOne</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> instance;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//æ–¹å¼3ï¼š</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> LazyOne </span><span style="color:#B392F0;">getInstance3</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(instance </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (LazyOne.class) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span><span style="color:#6A737D;">//åŠ è¿™ä¸ªä»£ç ï¼Œæš´éœ²é—®é¢˜</span></span>
<span class="line"><span style="color:#E1E4E8;">                } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                    e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(instance </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">                    instance </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazyOne</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> instance;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">    æ³¨æ„ï¼šä¸Šè¿°æ–¹å¼3ä¸­ï¼Œæœ‰æŒ‡ä»¤é‡æ’é—®é¢˜</span></span>
<span class="line"><span style="color:#6A737D;">    mem = allocate(); ä¸ºå•ä¾‹å¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</span></span>
<span class="line"><span style="color:#6A737D;">    instance = mem;   instanceå¼•ç”¨ç°åœ¨éç©ºï¼Œä½†è¿˜æœªåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">    ctorSingleton(instance); ä¸ºå•ä¾‹å¯¹è±¡é€šè¿‡instanceè°ƒç”¨æ„é€ å™¨</span></span>
<span class="line"><span style="color:#6A737D;">    ä»JDK2å¼€å§‹ï¼Œåˆ†é…ç©ºé—´ã€åˆå§‹åŒ–ã€è°ƒç”¨æ„é€ å™¨ä¼šåœ¨çº¿ç¨‹çš„å·¥ä½œå­˜å‚¨åŒºä¸€æ¬¡æ€§å®Œæˆï¼Œç„¶åå¤åˆ¶åˆ°ä¸»å­˜å‚¨åŒºã€‚ä½†æ˜¯éœ€è¦   </span></span>
<span class="line"><span style="color:#6A737D;">    volatileå…³é”®å­—ï¼Œé¿å…æŒ‡ä»¤é‡æ’ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">    */</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazyOne</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> LazyOne instance;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazyOne</span><span style="color:#24292E;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ–¹å¼1ï¼š</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> LazyOne </span><span style="color:#6F42C1;">getInstance1</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(instance </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            instance </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazyOne</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> instance;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ–¹å¼2ï¼š</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> LazyOne </span><span style="color:#6F42C1;">getInstance2</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;">(LazyOne.class) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (instance </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                instance </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazyOne</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> instance;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ–¹å¼3ï¼š</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> LazyOne </span><span style="color:#6F42C1;">getInstance3</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(instance </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (LazyOne.class) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                    Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span><span style="color:#6A737D;">//åŠ è¿™ä¸ªä»£ç ï¼Œæš´éœ²é—®é¢˜</span></span>
<span class="line"><span style="color:#24292E;">                } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(instance </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">                    instance </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazyOne</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> instance;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">    æ³¨æ„ï¼šä¸Šè¿°æ–¹å¼3ä¸­ï¼Œæœ‰æŒ‡ä»¤é‡æ’é—®é¢˜</span></span>
<span class="line"><span style="color:#6A737D;">    mem = allocate(); ä¸ºå•ä¾‹å¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</span></span>
<span class="line"><span style="color:#6A737D;">    instance = mem;   instanceå¼•ç”¨ç°åœ¨éç©ºï¼Œä½†è¿˜æœªåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">    ctorSingleton(instance); ä¸ºå•ä¾‹å¯¹è±¡é€šè¿‡instanceè°ƒç”¨æ„é€ å™¨</span></span>
<span class="line"><span style="color:#6A737D;">    ä»JDK2å¼€å§‹ï¼Œåˆ†é…ç©ºé—´ã€åˆå§‹åŒ–ã€è°ƒç”¨æ„é€ å™¨ä¼šåœ¨çº¿ç¨‹çš„å·¥ä½œå­˜å‚¨åŒºä¸€æ¬¡æ€§å®Œæˆï¼Œç„¶åå¤åˆ¶åˆ°ä¸»å­˜å‚¨åŒºã€‚ä½†æ˜¯éœ€è¦   </span></span>
<span class="line"><span style="color:#6A737D;">    volatileå…³é”®å­—ï¼Œé¿å…æŒ‡ä»¤é‡æ’ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">    */</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>å½¢å¼äºŒï¼šä½¿ç”¨å†…éƒ¨ç±»</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazySingle</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazySingle</span><span style="color:#E1E4E8;">(){}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> LazySingle </span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> Inner.INSTANCE;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Inner</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">final</span><span style="color:#E1E4E8;"> LazySingle INSTANCE </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">LazySingle</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazySingle</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazySingle</span><span style="color:#24292E;">(){}</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> LazySingle </span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> Inner.INSTANCE;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Inner</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> LazySingle INSTANCE </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LazySingle</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><blockquote><p>å†…éƒ¨ç±»åªæœ‰åœ¨å¤–éƒ¨ç±»è¢«è°ƒç”¨æ‰åŠ è½½ï¼Œäº§ç”ŸINSTANCEå®ä¾‹ï¼›åˆä¸ç”¨åŠ é”ã€‚</p><p>æ­¤æ¨¡å¼å…·æœ‰ä¹‹å‰ä¸¤ä¸ªæ¨¡å¼çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶å±è”½äº†å®ƒä»¬çš„ç¼ºç‚¹ï¼Œæ˜¯æœ€å¥½çš„å•ä¾‹æ¨¡å¼ã€‚</p><p>æ­¤æ—¶çš„å†…éƒ¨ç±»ï¼Œä½¿ç”¨enumè¿›è¡Œå®šä¹‰ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p></blockquote><p>æµ‹è¯•ç±»ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#E1E4E8;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> org.junit.Test;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestLazy</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test01</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        LazyOne s1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazyOne.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        LazyOne s2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazyOne.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s2);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1 </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> s2);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//æŠŠs1å’Œs2å£°æ˜åœ¨å¤–é¢ï¼Œæ˜¯æƒ³è¦åœ¨çº¿ç¨‹çš„åŒ¿åå†…éƒ¨ç±»ä¸­ä¸ºs1å’Œs2èµ‹å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">    LazyOne s1;</span></span>
<span class="line"><span style="color:#E1E4E8;">    LazyOne s2;</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test02</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">                s1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazyOne.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">                s2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazyOne.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            t1.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            t2.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s2);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1 </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> s2);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    LazySingle obj1;</span></span>
<span class="line"><span style="color:#E1E4E8;">    LazySingle obj2;</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Test</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test03</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">                obj1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazySingle.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">                obj2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LazySingle.</span><span style="color:#B392F0;">getInstance</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            t1.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            t2.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(obj1);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(obj2);</span></span>
<span class="line"><span style="color:#E1E4E8;">        System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(obj1 </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> obj2);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> com.atguigu.single.lazy;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.junit.Test;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestLazy</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test01</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        LazyOne s1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazyOne.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        LazyOne s2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazyOne.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s2);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1 </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> s2);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æŠŠs1å’Œs2å£°æ˜åœ¨å¤–é¢ï¼Œæ˜¯æƒ³è¦åœ¨çº¿ç¨‹çš„åŒ¿åå†…éƒ¨ç±»ä¸­ä¸ºs1å’Œs2èµ‹å€¼</span></span>
<span class="line"><span style="color:#24292E;">    LazyOne s1;</span></span>
<span class="line"><span style="color:#24292E;">    LazyOne s2;</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test02</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">                s1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazyOne.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">                s2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazyOne.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            t1.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            t2.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s2);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1 </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> s2);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    LazySingle obj1;</span></span>
<span class="line"><span style="color:#24292E;">    LazySingle obj2;</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test03</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">                obj1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazySingle.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">                obj2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LazySingle.</span><span style="color:#6F42C1;">getInstance</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            t1.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            t2.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(obj1);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(obj2);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(obj1 </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> obj2);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_6-2-æ­»é”" tabindex="-1">6.2 æ­»é” <a class="header-anchor" href="#_6-2-æ­»é”" aria-label="Permalink to &quot;6.2 æ­»é”&quot;">â€‹</a></h3><p>ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å ç”¨å¯¹æ–¹éœ€è¦çš„åŒæ­¥èµ„æºä¸æ”¾å¼ƒï¼Œéƒ½åœ¨ç­‰å¾…å¯¹æ–¹æ”¾å¼ƒè‡ªå·±éœ€è¦çš„åŒæ­¥èµ„æºï¼Œå°±å½¢æˆäº†çº¿ç¨‹çš„æ­»é”ã€‚</p><p><img src="`+B+`" alt="image-20231011121647445"></p><p>âš ï¸ ä¸€æ—¦å‡ºç°æ­»é”ï¼Œæ•´ä¸ªç¨‹åºæ—¢ä¸ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œä¹Ÿä¸ä¼šç»™å‡ºä»»ä½•æç¤ºï¼Œåªæ˜¯æ‰€æœ‰çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ— æ³•ç»§ç»­ã€‚</p><p>ä¸¾ä¾‹1ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DeadLockTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		StringBuilder s1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">StringBuilder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		StringBuilder s2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">StringBuilder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (s1) {</span></span>
<span class="line"><span style="color:#E1E4E8;">					s1.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;a&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					s2.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">						Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">						e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">					}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (s2) {</span></span>
<span class="line"><span style="color:#E1E4E8;">						s1.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;b&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">						s2.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">						System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1);</span></span>
<span class="line"><span style="color:#E1E4E8;">						System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">					}</span></span>
<span class="line"><span style="color:#E1E4E8;">				}</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (s2) {</span></span>
<span class="line"><span style="color:#E1E4E8;">					s1.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;c&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					s2.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;3&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">						Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">						e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">					}</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (s1) {</span></span>
<span class="line"><span style="color:#E1E4E8;">						s1.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;d&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">						s2.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;4&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">						System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s1);</span></span>
<span class="line"><span style="color:#E1E4E8;">						System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(s2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">					}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">				}</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeadLockTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		StringBuilder s1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">StringBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		StringBuilder s2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">StringBuilder</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (s1) {</span></span>
<span class="line"><span style="color:#24292E;">					s1.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					s2.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					</span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">						Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">						e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">					}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (s2) {</span></span>
<span class="line"><span style="color:#24292E;">						s1.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;b&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">						s2.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">						System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1);</span></span>
<span class="line"><span style="color:#24292E;">						System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">					}</span></span>
<span class="line"><span style="color:#24292E;">				}</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (s2) {</span></span>
<span class="line"><span style="color:#24292E;">					s1.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;c&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					s2.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;3&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">						Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">						e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">					}</span></span>
<span class="line"><span style="color:#24292E;">					</span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (s1) {</span></span>
<span class="line"><span style="color:#24292E;">						s1.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;d&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">						s2.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;4&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">						System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s1);</span></span>
<span class="line"><span style="color:#24292E;">						System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(s2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">					}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">				}</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ä¸¾ä¾‹2ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestDeadLock</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		Object g </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		Object m </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		Owner s </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Owner</span><span style="color:#E1E4E8;">(g,m);</span></span>
<span class="line"><span style="color:#E1E4E8;">		Customer c </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(g,m);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(s).</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(c).</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Owner</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Object goods;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Object money;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Owner</span><span style="color:#E1E4E8;">(Object </span><span style="color:#FFAB70;">goods</span><span style="color:#E1E4E8;">, Object </span><span style="color:#FFAB70;">money</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">super</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.goods </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> goods;</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.money </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> money;</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (goods) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å…ˆç»™é’±&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (money) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å‘è´§&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Object goods;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Object money;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;">(Object </span><span style="color:#FFAB70;">goods</span><span style="color:#E1E4E8;">, Object </span><span style="color:#FFAB70;">money</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">super</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.goods </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> goods;</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.money </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> money;</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (money) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å…ˆå‘è´§&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (goods) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å†ç»™é’±&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestDeadLock</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">		Object g </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		Object m </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		Owner s </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Owner</span><span style="color:#24292E;">(g,m);</span></span>
<span class="line"><span style="color:#24292E;">		Customer c </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(g,m);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(s).</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(c).</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Owner</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Object goods;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Object money;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Owner</span><span style="color:#24292E;">(Object </span><span style="color:#E36209;">goods</span><span style="color:#24292E;">, Object </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">super</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.goods </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> goods;</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.money </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> money;</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (goods) {</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å…ˆç»™é’±&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (money) {</span></span>
<span class="line"><span style="color:#24292E;">				System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å‘è´§&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Object goods;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Object money;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;">(Object </span><span style="color:#E36209;">goods</span><span style="color:#24292E;">, Object </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">super</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.goods </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> goods;</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.money </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> money;</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (money) {</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å…ˆå‘è´§&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (goods) {</span></span>
<span class="line"><span style="color:#24292E;">				System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å†ç»™é’±&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>è¯±å‘æ­»é”çš„åŸå› ï¼š</strong></p><ul><li>äº’æ–¥æ¡ä»¶</li><li>å ç”¨ä¸”ç­‰å¾…</li><li>ä¸å¯æŠ¢å¤ºï¼ˆæˆ–ä¸å¯æŠ¢å ï¼‰</li><li>å¾ªç¯ç­‰å¾…</li></ul><p>ä»¥ä¸Š4ä¸ªæ¡ä»¶ï¼ŒåŒæ—¶å‡ºç°å°±ä¼šè§¦å‘æ­»é”ã€‚</p><p><strong>è§£å†³æ­»é”ï¼š</strong></p><p>æ­»é”ä¸€æ—¦å‡ºç°ï¼ŒåŸºæœ¬å¾ˆéš¾äººä¸ºå¹²é¢„ï¼Œåªèƒ½å°½é‡è§„é¿ã€‚å¯ä»¥è€ƒè™‘æ‰“ç ´ä¸Šé¢çš„è¯±å‘æ¡ä»¶ã€‚</p><p>é’ˆå¯¹æ¡ä»¶1ï¼šäº’æ–¥æ¡ä»¶åŸºæœ¬ä¸Šæ— æ³•è¢«ç ´åã€‚å› ä¸ºçº¿ç¨‹éœ€è¦é€šè¿‡äº’æ–¥è§£å†³å®‰å…¨é—®é¢˜ã€‚</p><p>é’ˆå¯¹æ¡ä»¶2ï¼šå¯ä»¥è€ƒè™‘ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰æ‰€éœ€çš„èµ„æºï¼Œè¿™æ ·å°±ä¸å­˜åœ¨ç­‰å¾…çš„é—®é¢˜ã€‚</p><p>é’ˆå¯¹æ¡ä»¶3ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹åœ¨è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œå¦‚æœç”³è¯·ä¸åˆ°ï¼Œå°±ä¸»åŠ¨é‡Šæ”¾æ‰å·²ç»å ç”¨çš„èµ„æºã€‚</p><p>é’ˆå¯¹æ¡ä»¶4ï¼šå¯ä»¥å°†èµ„æºæ”¹ä¸ºçº¿æ€§é¡ºåºã€‚ç”³è¯·èµ„æºæ—¶ï¼Œå…ˆç”³è¯·åºå·è¾ƒå°çš„ï¼Œè¿™æ ·é¿å…å¾ªç¯ç­‰å¾…é—®é¢˜ã€‚</p><h3 id="_6-3-jdk5-0æ–°ç‰¹æ€§-lock-é”" tabindex="-1">6.3 JDK5.0æ–°ç‰¹æ€§ï¼šLock(é”) <a class="header-anchor" href="#_6-3-jdk5-0æ–°ç‰¹æ€§-lock-é”" aria-label="Permalink to &quot;6.3 JDK5.0æ–°ç‰¹æ€§ï¼šLock(é”)&quot;">â€‹</a></h3><ul><li><p>JDK5.0çš„æ–°å¢åŠŸèƒ½ï¼Œä¿è¯çº¿ç¨‹çš„å®‰å…¨ã€‚ä¸é‡‡ç”¨synchronizedç›¸æ¯”ï¼ŒLockå¯æä¾›å¤šç§é”æ–¹æ¡ˆï¼Œæ›´çµæ´»ã€æ›´å¼ºå¤§ã€‚Locké€šè¿‡æ˜¾å¼å®šä¹‰åŒæ­¥é”å¯¹è±¡æ¥å®ç°åŒæ­¥ã€‚åŒæ­¥é”ä½¿ç”¨Lockå¯¹è±¡å……å½“ã€‚</p></li><li><p>java.util.concurrent.locks.Lockæ¥å£æ˜¯æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„å·¥å…·ã€‚é”æä¾›äº†å¯¹å…±äº«èµ„æºçš„ç‹¬å è®¿é—®ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹Lockå¯¹è±¡åŠ é”ï¼Œçº¿ç¨‹å¼€å§‹è®¿é—®å…±äº«èµ„æºä¹‹å‰åº”å…ˆè·å¾—Lockå¯¹è±¡ã€‚</p></li><li><p>åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ§åˆ¶ä¸­ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯<code>ReentrantLock</code>ï¼Œå¯ä»¥æ˜¾å¼åŠ é”ã€é‡Šæ”¾é”ã€‚</p><ul><li>ReentrantLockç±»å®ç°äº† Lock æ¥å£ï¼Œå®ƒæ‹¥æœ‰ä¸ synchronized ç›¸åŒçš„å¹¶å‘æ€§å’Œå†…å­˜è¯­ä¹‰ï¼Œä½†æ˜¯æ·»åŠ äº†ç±»ä¼¼é”æŠ•ç¥¨ã€å®šæ—¶é”ç­‰å€™å’Œå¯ä¸­æ–­é”ç­‰å€™çš„ä¸€äº›ç‰¹æ€§ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†åœ¨æ¿€çƒˆäº‰ç”¨æƒ…å†µä¸‹æ›´ä½³çš„æ€§èƒ½ã€‚</li></ul></li><li><p>Locké”ä¹Ÿç§°åŒæ­¥é”ï¼ŒåŠ é”ä¸é‡Šæ”¾é”æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>public void lock() :åŠ åŒæ­¥é”ã€‚</li><li>public void unlock() :é‡Šæ”¾åŒæ­¥é”ã€‚</li></ul></li><li><p>ä»£ç ç»“æ„</p></li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">A</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//1. åˆ›å»ºLockçš„å®ä¾‹ï¼Œå¿…é¡»ç¡®ä¿å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªLockå®ä¾‹</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">final</span><span style="color:#E1E4E8;"> ReentrantLock lock </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ReenTrantLock</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">m</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//2. è°ƒåŠ¨lock()ï¼Œå®ç°éœ€å…±äº«çš„ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#E1E4E8;">		lock.</span><span style="color:#B392F0;">lock</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä»£ç ;</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">finally</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">//3. è°ƒç”¨unlock()ï¼Œé‡Šæ”¾å…±äº«ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#E1E4E8;">			lock.</span><span style="color:#B392F0;">unlock</span><span style="color:#E1E4E8;">();  </span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">A</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//1. åˆ›å»ºLockçš„å®ä¾‹ï¼Œå¿…é¡»ç¡®ä¿å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªLockå®ä¾‹</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> ReentrantLock lock </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ReenTrantLock</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">m</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//2. è°ƒåŠ¨lock()ï¼Œå®ç°éœ€å…±äº«çš„ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#24292E;">		lock.</span><span style="color:#6F42C1;">lock</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">try</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä»£ç ;</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">finally</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//3. è°ƒç”¨unlock()ï¼Œé‡Šæ”¾å…±äº«ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#24292E;">			lock.</span><span style="color:#6F42C1;">unlock</span><span style="color:#24292E;">();  </span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><blockquote><p>æ³¨æ„ï¼šå¦‚æœåŒæ­¥ä»£ç æœ‰å¼‚å¸¸ï¼Œè¦å°†unlock()å†™å…¥finallyè¯­å¥å—ã€‚</p></blockquote><p>ä¸¾ä¾‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> java.util.concurrent.locks.ReentrantLock;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> ticket </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//1. åˆ›å»ºLockçš„å®ä¾‹ï¼Œå¿…é¡»ç¡®ä¿å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªLockå®ä¾‹</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">final</span><span style="color:#E1E4E8;"> ReentrantLock lock </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ReentrantLock</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">//2. è°ƒåŠ¨lock()ï¼Œå®ç°éœ€å…±äº«çš„ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#E1E4E8;">				lock.</span><span style="color:#B392F0;">lock</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(ticket </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">						Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">					} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">						e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">					}</span></span>
<span class="line"><span style="color:#E1E4E8;">					System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(ticket</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">				}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">break</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">				}</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span><span style="color:#F97583;">finally</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">//3. è°ƒç”¨unlock()ï¼Œé‡Šæ”¾å…±äº«ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#E1E4E8;">				lock.</span><span style="color:#B392F0;">unlock</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ThreadLock</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		Window t </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Window</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(t);</span></span>
<span class="line"><span style="color:#E1E4E8;">		Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(t);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> java.util.concurrent.locks.ReentrantLock;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> ticket </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//1. åˆ›å»ºLockçš„å®ä¾‹ï¼Œå¿…é¡»ç¡®ä¿å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªLockå®ä¾‹</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> ReentrantLock lock </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ReentrantLock</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">while</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">try</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">//2. è°ƒåŠ¨lock()ï¼Œå®ç°éœ€å…±äº«çš„ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#24292E;">				lock.</span><span style="color:#6F42C1;">lock</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(ticket </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">						Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">					} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">						e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">					}</span></span>
<span class="line"><span style="color:#24292E;">					System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(ticket</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">				}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">break</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">				}</span></span>
<span class="line"><span style="color:#24292E;">			}</span><span style="color:#D73A49;">finally</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">//3. è°ƒç”¨unlock()ï¼Œé‡Šæ”¾å…±äº«ä»£ç çš„é”å®š</span></span>
<span class="line"><span style="color:#24292E;">				lock.</span><span style="color:#6F42C1;">unlock</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ThreadLock</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">		Window t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Window</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(t);</span></span>
<span class="line"><span style="color:#24292E;">		Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(t);</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>synchronizedä¸Lockçš„å¯¹æ¯”</strong></p><ol><li>Lockæ˜¯æ˜¾å¼é”ï¼ˆæ‰‹åŠ¨å¼€å¯å’Œå…³é—­é”ï¼Œåˆ«å¿˜è®°å…³é—­é”ï¼‰ï¼Œsynchronizedæ˜¯éšå¼é”ï¼Œå‡ºäº†ä½œç”¨åŸŸã€é‡åˆ°å¼‚å¸¸ç­‰è‡ªåŠ¨è§£é”</li><li>Lockåªæœ‰ä»£ç å—é”ï¼Œsynchronizedæœ‰ä»£ç å—é”å’Œæ–¹æ³•é”</li><li>ä½¿ç”¨Locké”ï¼ŒJVMå°†èŠ±è´¹è¾ƒå°‘çš„æ—¶é—´æ¥è°ƒåº¦çº¿ç¨‹ï¼Œæ€§èƒ½æ›´å¥½ã€‚å¹¶ä¸”å…·æœ‰æ›´å¥½çš„æ‰©å±•æ€§ï¼ˆæä¾›æ›´å¤šçš„å­ç±»ï¼‰ï¼Œæ›´ä½“ç°é¢å‘å¯¹è±¡ã€‚</li><li>ï¼ˆäº†è§£ï¼‰Locké”å¯ä»¥å¯¹è¯»ä¸åŠ é”ï¼Œå¯¹å†™åŠ é”ï¼Œsynchronizedä¸å¯ä»¥</li><li>ï¼ˆäº†è§£ï¼‰Locké”å¯ä»¥æœ‰å¤šç§è·å–é”çš„æ–¹å¼ï¼Œå¯ä»¥ä»sleepçš„çº¿ç¨‹ä¸­æŠ¢åˆ°é”ï¼Œsynchronizedä¸å¯ä»¥</li></ol><blockquote><p>è¯´æ˜ï¼šå¼€å‘å»ºè®®ä¸­å¤„ç†çº¿ç¨‹å®‰å…¨é—®é¢˜ä¼˜å…ˆä½¿ç”¨é¡ºåºä¸ºï¼š</p><p>â€¢ Lock ----&gt; åŒæ­¥ä»£ç å— ----&gt; åŒæ­¥æ–¹æ³•</p></blockquote><h2 id="ä¸ƒ-çº¿ç¨‹çš„é€šä¿¡" tabindex="-1">ä¸ƒ. çº¿ç¨‹çš„é€šä¿¡ <a class="header-anchor" href="#ä¸ƒ-çº¿ç¨‹çš„é€šä¿¡" aria-label="Permalink to &quot;ä¸ƒ. çº¿ç¨‹çš„é€šä¿¡&quot;">â€‹</a></h2><h3 id="_7-1-çº¿ç¨‹é—´é€šä¿¡" tabindex="-1">7.1 çº¿ç¨‹é—´é€šä¿¡ <a class="header-anchor" href="#_7-1-çº¿ç¨‹é—´é€šä¿¡" aria-label="Permalink to &quot;7.1 çº¿ç¨‹é—´é€šä¿¡&quot;">â€‹</a></h3><p><strong>ä¸ºä»€ä¹ˆè¦å¤„ç†çº¿ç¨‹é—´é€šä¿¡ï¼š</strong></p><p>å½“æˆ‘ä»¬<code>éœ€è¦å¤šä¸ªçº¿ç¨‹</code>æ¥å…±åŒå®Œæˆä¸€ä»¶ä»»åŠ¡ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ä»–ä»¬<code>æœ‰è§„å¾‹çš„æ‰§è¡Œ</code>ï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹ä¹‹é—´éœ€è¦ä¸€äº›é€šä¿¡æœºåˆ¶ï¼Œå¯ä»¥åè°ƒå®ƒä»¬çš„å·¥ä½œï¼Œä»¥æ­¤å®ç°å¤šçº¿ç¨‹å…±åŒæ“ä½œä¸€ä»½æ•°æ®ã€‚</p><p>æ¯”å¦‚ï¼šçº¿ç¨‹Aç”¨æ¥ç”Ÿäº§åŒ…å­çš„ï¼Œçº¿ç¨‹Bç”¨æ¥åƒåŒ…å­çš„ï¼ŒåŒ…å­å¯ä»¥ç†è§£ä¸ºåŒä¸€èµ„æºï¼Œçº¿ç¨‹Aä¸çº¿ç¨‹Bå¤„ç†çš„åŠ¨ä½œï¼Œä¸€ä¸ªæ˜¯ç”Ÿäº§ï¼Œä¸€ä¸ªæ˜¯æ¶ˆè´¹ï¼Œæ­¤æ—¶Bçº¿ç¨‹å¿…é¡»ç­‰åˆ°Açº¿ç¨‹å®Œæˆåæ‰èƒ½æ‰§è¡Œï¼Œé‚£ä¹ˆçº¿ç¨‹Aä¸çº¿ç¨‹Bä¹‹é—´å°±éœ€è¦çº¿ç¨‹é€šä¿¡ï¼Œå³â€”â€” <strong>ç­‰å¾…å”¤é†’æœºåˆ¶ã€‚</strong></p><h3 id="_7-2-ç­‰å¾…å”¤é†’æœºåˆ¶" tabindex="-1">7.2 ç­‰å¾…å”¤é†’æœºåˆ¶ <a class="header-anchor" href="#_7-2-ç­‰å¾…å”¤é†’æœºåˆ¶" aria-label="Permalink to &quot;7.2 ç­‰å¾…å”¤é†’æœºåˆ¶&quot;">â€‹</a></h3><p>è¿™æ˜¯å¤šä¸ªçº¿ç¨‹é—´çš„ä¸€ç§<code>åä½œæœºåˆ¶</code>ã€‚è°ˆåˆ°çº¿ç¨‹æˆ‘ä»¬ç»å¸¸æƒ³åˆ°çš„æ˜¯çº¿ç¨‹é—´çš„<code>ç«äº‰ï¼ˆraceï¼‰</code>ï¼Œæ¯”å¦‚å»äº‰å¤ºé”ï¼Œä½†è¿™å¹¶ä¸æ˜¯æ•…äº‹çš„å…¨éƒ¨ï¼Œçº¿ç¨‹é—´ä¹Ÿä¼šæœ‰åä½œæœºåˆ¶ã€‚</p><p>åœ¨ä¸€ä¸ªçº¿ç¨‹æ»¡è¶³æŸä¸ªæ¡ä»¶æ—¶ï¼Œå°±è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆ<code>wait() / wait(time)</code>ï¼‰ï¼Œ ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»–ä»¬çš„æŒ‡å®šä»£ç è¿‡åå†å°†å…¶å”¤é†’ï¼ˆ<code>notify()</code>ï¼‰;æˆ–å¯ä»¥æŒ‡å®šwaitçš„æ—¶é—´ï¼Œç­‰æ—¶é—´åˆ°äº†è‡ªåŠ¨å”¤é†’ï¼›åœ¨æœ‰å¤šä¸ªçº¿ç¨‹è¿›è¡Œç­‰å¾…æ—¶ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ <code>notifyAll()</code>æ¥å”¤é†’æ‰€æœ‰çš„ç­‰å¾…çº¿ç¨‹ã€‚wait/notify å°±æ˜¯çº¿ç¨‹é—´çš„ä¸€ç§åä½œæœºåˆ¶ã€‚</p><ol><li>waitï¼šçº¿ç¨‹ä¸å†æ´»åŠ¨ï¼Œä¸å†å‚ä¸è°ƒåº¦ï¼Œè¿›å…¥ <code>wait set</code> ä¸­ï¼Œå› æ­¤ä¸ä¼šæµªè´¹ CPU èµ„æºï¼Œä¹Ÿä¸ä¼šå»ç«äº‰é”äº†ï¼Œè¿™æ—¶çš„çº¿ç¨‹çŠ¶æ€æ˜¯ WAITING æˆ– TIMED_WAITINGã€‚å®ƒè¿˜è¦ç­‰ç€åˆ«çš„çº¿ç¨‹æ‰§è¡Œä¸€ä¸ª<code>ç‰¹åˆ«çš„åŠ¨ä½œ</code>ï¼Œä¹Ÿå³â€œ<code>é€šçŸ¥ï¼ˆnotifyï¼‰</code>â€æˆ–è€…ç­‰å¾…æ—¶é—´åˆ°ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸Šç­‰å¾…çš„çº¿ç¨‹ä»wait set ä¸­é‡Šæ”¾å‡ºæ¥ï¼Œé‡æ–°è¿›å…¥åˆ°è°ƒåº¦é˜Ÿåˆ—ï¼ˆ<code>ready queue</code>ï¼‰ä¸­</li><li>notifyï¼šåˆ™é€‰å–æ‰€é€šçŸ¥å¯¹è±¡çš„ wait set ä¸­çš„ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾ï¼›</li><li>notifyAllï¼šåˆ™é‡Šæ”¾æ‰€é€šçŸ¥å¯¹è±¡çš„ wait set ä¸Šçš„å…¨éƒ¨çº¿ç¨‹ã€‚</li></ol><blockquote><p>æ³¨æ„ï¼š</p><p>è¢«é€šçŸ¥çš„çº¿ç¨‹è¢«å”¤é†’åä¹Ÿä¸ä¸€å®šèƒ½ç«‹å³æ¢å¤æ‰§è¡Œï¼Œå› ä¸ºå®ƒå½“åˆä¸­æ–­çš„åœ°æ–¹æ˜¯åœ¨åŒæ­¥å—å†…ï¼Œè€Œæ­¤åˆ»å®ƒå·²ç»ä¸æŒæœ‰é”ï¼Œæ‰€ä»¥å®ƒéœ€è¦å†æ¬¡å°è¯•å»è·å–é”ï¼ˆå¾ˆå¯èƒ½é¢ä¸´å…¶å®ƒçº¿ç¨‹çš„ç«äº‰ï¼‰ï¼ŒæˆåŠŸåæ‰èƒ½åœ¨å½“åˆè°ƒç”¨ wait æ–¹æ³•ä¹‹åçš„åœ°æ–¹æ¢å¤æ‰§è¡Œã€‚</p><p>æ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœèƒ½è·å–é”ï¼Œçº¿ç¨‹å°±ä» WAITING çŠ¶æ€å˜æˆ RUNNABLEï¼ˆå¯è¿è¡Œï¼‰ çŠ¶æ€ï¼›</li><li>å¦åˆ™ï¼Œçº¿ç¨‹å°±ä» WAITING çŠ¶æ€åˆå˜æˆ BLOCKEDï¼ˆç­‰å¾…é”ï¼‰ çŠ¶æ€</li></ul></blockquote><h3 id="_7-3-ä¸¾ä¾‹" tabindex="-1">7.3 ä¸¾ä¾‹ <a class="header-anchor" href="#_7-3-ä¸¾ä¾‹" aria-label="Permalink to &quot;7.3 ä¸¾ä¾‹&quot;">â€‹</a></h3><p>ä¾‹é¢˜ï¼šä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ‰“å° 1-100ã€‚çº¿ç¨‹1, çº¿ç¨‹2 äº¤æ›¿æ‰“å°</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PrintNumber</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> number </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    Object obj </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//            synchronized (this) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> (obj) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                obj.</span><span style="color:#B392F0;">notify</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(number </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">                    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                    System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;:&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> number);</span></span>
<span class="line"><span style="color:#E1E4E8;">                    number</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        obj.</span><span style="color:#B392F0;">wait</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">//çº¿ç¨‹ä¸€æ—¦æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œå°±è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚åŒæ—¶ï¼Œä¼šé‡Šæ”¾å¯¹åŒæ­¥ç›‘è§†å™¨çš„è°ƒç”¨</span></span>
<span class="line"><span style="color:#E1E4E8;">                    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                        e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                    }</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">break</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">                }</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PrintNumberTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        PrintNumber p </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">PrintNumber</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(p,</span><span style="color:#9ECBFF;">&quot;çº¿ç¨‹1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        Thread t2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(p,</span><span style="color:#9ECBFF;">&quot;çº¿ç¨‹2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        t1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        t2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PrintNumber</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> number </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    Object obj </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">while</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//            synchronized (this) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> (obj) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                obj.</span><span style="color:#6F42C1;">notify</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(number </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                        Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                        e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;:&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> number);</span></span>
<span class="line"><span style="color:#24292E;">                    number</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                        obj.</span><span style="color:#6F42C1;">wait</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">//çº¿ç¨‹ä¸€æ—¦æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œå°±è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚åŒæ—¶ï¼Œä¼šé‡Šæ”¾å¯¹åŒæ­¥ç›‘è§†å™¨çš„è°ƒç”¨</span></span>
<span class="line"><span style="color:#24292E;">                    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                        e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                    }</span></span>
<span class="line"><span style="color:#24292E;">                }</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">break</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PrintNumberTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        PrintNumber p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">PrintNumber</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        Thread t1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(p,</span><span style="color:#032F62;">&quot;çº¿ç¨‹1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Thread t2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(p,</span><span style="color:#032F62;">&quot;çº¿ç¨‹2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        t1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        t2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-4-è°ƒç”¨waitå’Œnotifyéœ€æ³¨æ„çš„ç»†èŠ‚" tabindex="-1">7.4 è°ƒç”¨waitå’Œnotifyéœ€æ³¨æ„çš„ç»†èŠ‚ <a class="header-anchor" href="#_7-4-è°ƒç”¨waitå’Œnotifyéœ€æ³¨æ„çš„ç»†èŠ‚" aria-label="Permalink to &quot;7.4 è°ƒç”¨waitå’Œnotifyéœ€æ³¨æ„çš„ç»†èŠ‚&quot;">â€‹</a></h3><ol><li>waitæ–¹æ³•ä¸notifyæ–¹æ³•å¿…é¡»è¦ç”±<code>åŒä¸€ä¸ªé”å¯¹è±¡è°ƒç”¨</code></li><li>waitæ–¹æ³•ä¸notifyæ–¹æ³•æ˜¯å±äºObjectç±»çš„æ–¹æ³•çš„ã€‚å› ä¸ºï¼šé”å¯¹è±¡å¯ä»¥æ˜¯ä»»æ„å¯¹è±¡ï¼Œè€Œä»»æ„å¯¹è±¡çš„æ‰€å±ç±»éƒ½æ˜¯ç»§æ‰¿äº†Objectç±»çš„ã€‚</li><li>waitæ–¹æ³•ä¸notifyæ–¹æ³•å¿…é¡»è¦åœ¨<code>åŒæ­¥ä»£ç å—</code>æˆ–è€…æ˜¯<code>åŒæ­¥å‡½æ•°</code>ä¸­ä½¿ç”¨ã€‚å› ä¸ºï¼šå¿…é¡»è¦<code>é€šè¿‡é”å¯¹è±¡</code>è°ƒç”¨è¿™2ä¸ªæ–¹æ³•ã€‚å¦åˆ™ä¼šæŠ¥java.lang.IllegalMonitorStateExceptionå¼‚å¸¸ã€‚</li></ol><p><strong>ä¸¾ä¾‹</strong></p><p>ç”Ÿäº§è€…æ¶ˆè´¹è€…</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ConsumerProducerTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		Clerk clerk </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Clerk</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		Producer p1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Producer</span><span style="color:#E1E4E8;">(clerk);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		Consumer c1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Consumer</span><span style="color:#E1E4E8;">(clerk);</span></span>
<span class="line"><span style="color:#E1E4E8;">		Consumer c2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Consumer</span><span style="color:#E1E4E8;">(clerk);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		p1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ç”Ÿäº§è€…1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		c1.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ¶ˆè´¹è€…1&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		c2.</span><span style="color:#B392F0;">setName</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ¶ˆè´¹è€…2&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		p1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		c1.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		c2.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//ç”Ÿäº§è€…</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Producer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Clerk clerk;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Producer</span><span style="color:#E1E4E8;">(Clerk </span><span style="color:#FFAB70;">clerk</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.clerk </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> clerk;</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;=========ç”Ÿäº§è€…å¼€å§‹ç”Ÿäº§äº§å“========&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">40</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//è¦æ±‚clerkå»å¢åŠ äº§å“</span></span>
<span class="line"><span style="color:#E1E4E8;">			clerk.</span><span style="color:#B392F0;">addProduct</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//æ¶ˆè´¹è€…</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Consumer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> Clerk clerk;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Consumer</span><span style="color:#E1E4E8;">(Clerk </span><span style="color:#FFAB70;">clerk</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.clerk </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> clerk;</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	@</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;=========æ¶ˆè´¹è€…å¼€å§‹æ¶ˆè´¹äº§å“========&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				Thread.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">90</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//è¦æ±‚clerkå»å‡å°‘äº§å“</span></span>
<span class="line"><span style="color:#E1E4E8;">			clerk.</span><span style="color:#B392F0;">minusProduct</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//èµ„æºç±»</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Clerk</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> productNum </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">//äº§å“æ•°é‡</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">final</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> MAX_PRODUCT </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">final</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> MIN_PRODUCT </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//å¢åŠ äº§å“</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">addProduct</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(productNum </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> MAX_PRODUCT){</span></span>
<span class="line"><span style="color:#E1E4E8;">			productNum</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#9ECBFF;">&quot;ç”Ÿäº§äº†ç¬¬&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> productNum </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ä¸ªäº§å“&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//å”¤é†’æ¶ˆè´¹è€…</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">notifyAll</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">wait</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//å‡å°‘äº§å“</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">synchronized</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">minusProduct</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(productNum </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> MIN_PRODUCT){</span></span>
<span class="line"><span style="color:#E1E4E8;">			System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#9ECBFF;">&quot;æ¶ˆè´¹äº†ç¬¬&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> productNum </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ä¸ªäº§å“&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">			productNum</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//å”¤é†’ç”Ÿäº§è€…</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">notifyAll</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">wait</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			} </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ConsumerProducerTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">		Clerk clerk </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Clerk</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		Producer p1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Producer</span><span style="color:#24292E;">(clerk);</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		Consumer c1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Consumer</span><span style="color:#24292E;">(clerk);</span></span>
<span class="line"><span style="color:#24292E;">		Consumer c2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Consumer</span><span style="color:#24292E;">(clerk);</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		p1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ç”Ÿäº§è€…1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		c1.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ¶ˆè´¹è€…1&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		c2.</span><span style="color:#6F42C1;">setName</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ¶ˆè´¹è€…2&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		p1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		c1.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		c2.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//ç”Ÿäº§è€…</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Producer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Clerk clerk;</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Producer</span><span style="color:#24292E;">(Clerk </span><span style="color:#E36209;">clerk</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.clerk </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> clerk;</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;=========ç”Ÿäº§è€…å¼€å§‹ç”Ÿäº§äº§å“========&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">while</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">40</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">				e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//è¦æ±‚clerkå»å¢åŠ äº§å“</span></span>
<span class="line"><span style="color:#24292E;">			clerk.</span><span style="color:#6F42C1;">addProduct</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//æ¶ˆè´¹è€…</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Consumer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Clerk clerk;</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Consumer</span><span style="color:#24292E;">(Clerk </span><span style="color:#E36209;">clerk</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.clerk </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> clerk;</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;=========æ¶ˆè´¹è€…å¼€å§‹æ¶ˆè´¹äº§å“========&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">while</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				Thread.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">90</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">				e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//è¦æ±‚clerkå»å‡å°‘äº§å“</span></span>
<span class="line"><span style="color:#24292E;">			clerk.</span><span style="color:#6F42C1;">minusProduct</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//èµ„æºç±»</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Clerk</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> productNum </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">//äº§å“æ•°é‡</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> MAX_PRODUCT </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> MIN_PRODUCT </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//å¢åŠ äº§å“</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">addProduct</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(productNum </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> MAX_PRODUCT){</span></span>
<span class="line"><span style="color:#24292E;">			productNum</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#032F62;">&quot;ç”Ÿäº§äº†ç¬¬&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> productNum </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ä¸ªäº§å“&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//å”¤é†’æ¶ˆè´¹è€…</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">notifyAll</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">wait</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">				e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//å‡å°‘äº§å“</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">synchronized</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">minusProduct</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(productNum </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> MIN_PRODUCT){</span></span>
<span class="line"><span style="color:#24292E;">			System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#032F62;">&quot;æ¶ˆè´¹äº†ç¬¬&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> productNum </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ä¸ªäº§å“&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">			productNum</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//å”¤é†’ç”Ÿäº§è€…</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">notifyAll</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">wait</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			} </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">				e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_7-5-é¢è¯•é¢˜-åŒºåˆ†sleep-å’Œwait" tabindex="-1">7.5 é¢è¯•é¢˜ï¼šåŒºåˆ†sleep()å’Œwait() <a class="header-anchor" href="#_7-5-é¢è¯•é¢˜-åŒºåˆ†sleep-å’Œwait" aria-label="Permalink to &quot;7.5 é¢è¯•é¢˜ï¼šåŒºåˆ†sleep()å’Œwait()&quot;">â€‹</a></h3><p>ç›¸åŒç‚¹ï¼šä¸€æ—¦æ‰§è¡Œï¼Œéƒ½ä¼šä½¿å¾—å½“å‰çº¿ç¨‹ç»“æŸæ‰§è¡ŒçŠ¶æ€ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><p>ä¸åŒç‚¹ï¼š</p><p>â‘  å®šä¹‰æ–¹æ³•æ‰€å±çš„ç±»ï¼šsleep():Threadä¸­å®šä¹‰ã€‚ wait():Objectä¸­å®šä¹‰</p><p>â‘¡ ä½¿ç”¨èŒƒå›´çš„ä¸åŒï¼šsleep()å¯ä»¥åœ¨ä»»ä½•éœ€è¦ä½¿ç”¨çš„ä½ç½®è¢«è°ƒç”¨ï¼› wait():å¿…é¡»ä½¿ç”¨åœ¨åŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•ä¸­</p><p>â‘¢ éƒ½åœ¨åŒæ­¥ç»“æ„ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯å¦é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„æ“ä½œä¸åŒï¼šsleep():ä¸ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ ;wait():ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨</p><p>â‘£ ç»“æŸç­‰å¾…çš„æ–¹å¼ä¸åŒï¼šsleep()ï¼šæŒ‡å®šæ—¶é—´ä¸€åˆ°å°±ç»“æŸé˜»å¡ã€‚ wait():å¯ä»¥æŒ‡å®šæ—¶é—´ä¹Ÿå¯ä»¥æ— é™ç­‰å¾…ç›´åˆ°notifyæˆ–notifyAllã€‚</p><h3 id="_7-7-æ˜¯å¦é‡Šæ”¾é”çš„æ“ä½œ" tabindex="-1">7.7 æ˜¯å¦é‡Šæ”¾é”çš„æ“ä½œ <a class="header-anchor" href="#_7-7-æ˜¯å¦é‡Šæ”¾é”çš„æ“ä½œ" aria-label="Permalink to &quot;7.7 æ˜¯å¦é‡Šæ”¾é”çš„æ“ä½œ&quot;">â€‹</a></h3><p>ä»»ä½•çº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šï¼Œé‚£ä¹ˆä½•æ—¶ä¼šé‡Šæ”¾å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šå‘¢ï¼Ÿ</p><h4 id="_7-7-1-é‡Šæ”¾é”çš„æ“ä½œ" tabindex="-1">7.7.1 é‡Šæ”¾é”çš„æ“ä½œ <a class="header-anchor" href="#_7-7-1-é‡Šæ”¾é”çš„æ“ä½œ" aria-label="Permalink to &quot;7.7.1 é‡Šæ”¾é”çš„æ“ä½œ&quot;">â€‹</a></h4><p>å½“å‰çº¿ç¨‹çš„åŒæ­¥æ–¹æ³•ã€åŒæ­¥ä»£ç å—æ‰§è¡Œç»“æŸã€‚</p><p>å½“å‰çº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¸­é‡åˆ°breakã€returnç»ˆæ­¢äº†è¯¥ä»£ç å—ã€è¯¥æ–¹æ³•çš„ç»§ç»­æ‰§è¡Œã€‚</p><p>å½“å‰çº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¸­å‡ºç°äº†æœªå¤„ç†çš„Erroræˆ–Exceptionï¼Œå¯¼è‡´å½“å‰çº¿ç¨‹å¼‚å¸¸ç»“æŸã€‚</p><p>å½“å‰çº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¸­æ‰§è¡Œäº†é”å¯¹è±¡çš„wait()æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹è¢«æŒ‚èµ·ï¼Œå¹¶é‡Šæ”¾é”ã€‚</p><h4 id="_7-7-2-ä¸ä¼šé‡Šæ”¾é”çš„æ“ä½œ" tabindex="-1">7.7.2 ä¸ä¼šé‡Šæ”¾é”çš„æ“ä½œ <a class="header-anchor" href="#_7-7-2-ä¸ä¼šé‡Šæ”¾é”çš„æ“ä½œ" aria-label="Permalink to &quot;7.7.2 ä¸ä¼šé‡Šæ”¾é”çš„æ“ä½œ&quot;">â€‹</a></h4><p>çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•æ—¶ï¼Œç¨‹åºè°ƒç”¨Thread.sleep()ã€Thread.yield()æ–¹æ³•æš‚åœå½“å‰çº¿ç¨‹çš„æ‰§è¡Œã€‚</p><p>çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¯¥çº¿ç¨‹çš„suspend()æ–¹æ³•å°†è¯¥è¯¥çº¿ç¨‹æŒ‚èµ·ï¼Œè¯¥çº¿ç¨‹ä¸ä¼šé‡Šæ”¾é”ï¼ˆåŒæ­¥ç›‘è§†å™¨ï¼‰ã€‚</p><ul><li>åº”å°½é‡é¿å…ä½¿ç”¨suspend()å’Œresume()è¿™æ ·çš„è¿‡æ—¶æ¥æ§åˆ¶çº¿ç¨‹ã€‚</li></ul><h2 id="å…«ã€jdk5-0æ–°å¢çº¿ç¨‹åˆ›å»ºæ–¹å¼" tabindex="-1">å…«ã€JDK5.0æ–°å¢çº¿ç¨‹åˆ›å»ºæ–¹å¼ <a class="header-anchor" href="#å…«ã€jdk5-0æ–°å¢çº¿ç¨‹åˆ›å»ºæ–¹å¼" aria-label="Permalink to &quot;å…«ã€JDK5.0æ–°å¢çº¿ç¨‹åˆ›å»ºæ–¹å¼&quot;">â€‹</a></h2><h3 id="_8-1-æ–°å¢æ–¹å¼ä¸€-å®ç°callableæ¥å£" tabindex="-1">8.1 æ–°å¢æ–¹å¼ä¸€ï¼šå®ç°Callableæ¥å£ <a class="header-anchor" href="#_8-1-æ–°å¢æ–¹å¼ä¸€-å®ç°callableæ¥å£" aria-label="Permalink to &quot;8.1 æ–°å¢æ–¹å¼ä¸€ï¼šå®ç°Callableæ¥å£&quot;">â€‹</a></h3><ul><li>ä¸ä½¿ç”¨Runnableç›¸æ¯”ï¼Œ CallableåŠŸèƒ½æ›´å¼ºå¤§äº› <ul><li>ç›¸æ¯”run()æ–¹æ³•ï¼Œå¯ä»¥æœ‰è¿”å›å€¼</li><li>æ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸</li><li>æ”¯æŒæ³›å‹çš„è¿”å›å€¼ï¼ˆéœ€è¦å€ŸåŠ©FutureTaskç±»ï¼Œè·å–è¿”å›ç»“æœï¼‰</li></ul></li><li>Futureæ¥å£ï¼ˆäº†è§£ï¼‰ <ul><li>å¯ä»¥å¯¹å…·ä½“Runnableã€Callableä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœç­‰ã€‚</li><li>FutureTaskæ˜¯Futrueæ¥å£çš„å”¯ä¸€çš„å®ç°ç±»</li><li>FutureTask åŒæ—¶å®ç°äº†Runnable, Futureæ¥å£ã€‚å®ƒæ—¢å¯ä»¥ä½œä¸ºRunnableè¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸ºFutureå¾—åˆ°Callableçš„è¿”å›å€¼</li></ul></li><li>ç¼ºç‚¹ï¼šåœ¨è·å–åˆ†çº¿ç¨‹æ‰§è¡Œç»“æœçš„æ—¶å€™ï¼Œå½“å‰çº¿ç¨‹ï¼ˆæˆ–æ˜¯ä¸»çº¿ç¨‹ï¼‰å—é˜»å¡ï¼Œæ•ˆç‡è¾ƒä½ã€‚</li><li>ä»£ç ä¸¾ä¾‹</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;"> * åˆ›å»ºå¤šçº¿ç¨‹çš„æ–¹å¼ä¸‰ï¼šå®ç°Callable ï¼ˆjdk5.0æ–°å¢çš„ï¼‰</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#6A737D;">//1.åˆ›å»ºä¸€ä¸ªå®ç°Callableçš„å®ç°ç±»</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Callable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">//2.å®ç°callæ–¹æ³•ï¼Œå°†æ­¤çº¿ç¨‹éœ€è¦æ‰§è¡Œçš„æ“ä½œå£°æ˜åœ¨call()ä¸­</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Object </span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">throws</span><span style="color:#E1E4E8;"> Exception {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> sum </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(i);</span></span>
<span class="line"><span style="color:#E1E4E8;">                sum </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> i;</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> sum;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CallableTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        NumThread numThread </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumThread</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        FutureTask futureTask </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">FutureTask</span><span style="color:#E1E4E8;">(numThread);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡ï¼Œå¹¶è°ƒç”¨start()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Thread</span><span style="color:#E1E4E8;">(futureTask).</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//      æ¥æ”¶è¿”å›å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">//6.è·å–Callableä¸­callæ–¹æ³•çš„è¿”å›å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">//get()è¿”å›å€¼å³ä¸ºFutureTaskæ„é€ å™¨å‚æ•°Callableå®ç°ç±»é‡å†™çš„call()çš„è¿”å›å€¼ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">            Object sum </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> futureTask.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ€»å’Œä¸ºï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> sum);</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (InterruptedException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (ExecutionException </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;"> * åˆ›å»ºå¤šçº¿ç¨‹çš„æ–¹å¼ä¸‰ï¼šå®ç°Callable ï¼ˆjdk5.0æ–°å¢çš„ï¼‰</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#6A737D;">//1.åˆ›å»ºä¸€ä¸ªå®ç°Callableçš„å®ç°ç±»</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Callable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//2.å®ç°callæ–¹æ³•ï¼Œå°†æ­¤çº¿ç¨‹éœ€è¦æ‰§è¡Œçš„æ“ä½œå£°æ˜åœ¨call()ä¸­</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">call</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Exception {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> sum </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">%</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(i);</span></span>
<span class="line"><span style="color:#24292E;">                sum </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> i;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> sum;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CallableTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        NumThread numThread </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumThread</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        FutureTask futureTask </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">FutureTask</span><span style="color:#24292E;">(numThread);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡ï¼Œå¹¶è°ƒç”¨start()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Thread</span><span style="color:#24292E;">(futureTask).</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//      æ¥æ”¶è¿”å›å€¼</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//6.è·å–Callableä¸­callæ–¹æ³•çš„è¿”å›å€¼</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//get()è¿”å›å€¼å³ä¸ºFutureTaskæ„é€ å™¨å‚æ•°Callableå®ç°ç±»é‡å†™çš„call()çš„è¿”å›å€¼ã€‚</span></span>
<span class="line"><span style="color:#24292E;">            Object sum </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> futureTask.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ€»å’Œä¸ºï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> sum);</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (ExecutionException </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_8-2-æ–°å¢æ–¹å¼äºŒ-ä½¿ç”¨çº¿ç¨‹æ± " tabindex="-1">8.2 æ–°å¢æ–¹å¼äºŒï¼šä½¿ç”¨çº¿ç¨‹æ±  <a class="header-anchor" href="#_8-2-æ–°å¢æ–¹å¼äºŒ-ä½¿ç”¨çº¿ç¨‹æ± " aria-label="Permalink to &quot;8.2 æ–°å¢æ–¹å¼äºŒï¼šä½¿ç”¨çº¿ç¨‹æ± &quot;">â€‹</a></h3><p><strong>ç°æœ‰é—®é¢˜ï¼š</strong></p><p>å¦‚æœå¹¶å‘çš„çº¿ç¨‹æ•°é‡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯æ‰§è¡Œä¸€ä¸ªæ—¶é—´å¾ˆçŸ­çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œè¿™æ ·é¢‘ç¹åˆ›å»ºçº¿ç¨‹å°±ä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éœ€è¦æ—¶é—´ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§åŠæ³•ä½¿å¾—çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œå³æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡ï¼Ÿ</p><p>**æ€è·¯ï¼š**æå‰åˆ›å»ºå¥½å¤šä¸ªçº¿ç¨‹ï¼Œæ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼Œä½¿ç”¨å®Œæ”¾å›æ± ä¸­ã€‚å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ã€å®ç°é‡å¤åˆ©ç”¨ã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­çš„å…¬å…±äº¤é€šå·¥å…·ã€‚</p><p><img src="`+g+`" alt="image-20231016161333269"></p><p><strong>å¥½å¤„ï¼š</strong></p><ul><li><p>æé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´ï¼‰</p></li><li><p>é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºï¼‰</p></li><li><p>ä¾¿äºçº¿ç¨‹ç®¡ç†</p><ul><li>corePoolSizeï¼šæ ¸å¿ƒæ± çš„å¤§å°</li><li>maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°</li><li>keepAliveTimeï¼šçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ—¶æœ€å¤šä¿æŒå¤šé•¿æ—¶é—´åä¼šç»ˆæ­¢</li><li>â€¦</li></ul></li></ul><p><strong>çº¿ç¨‹æ± ç›¸å…³API</strong></p><ul><li>JDK5.0ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚ä»JDK5.0å¼€å§‹ï¼ŒJavaå†…ç½®çº¿ç¨‹æ± ç›¸å…³çš„APIã€‚åœ¨java.util.concurrentåŒ…ä¸‹æä¾›äº†çº¿ç¨‹æ± ç›¸å…³APIï¼š<code>ExecutorService</code> å’Œ <code>Executors</code>ã€‚</li><li><code>ExecutorService</code>ï¼šçœŸæ­£çš„çº¿ç¨‹æ± æ¥å£ã€‚å¸¸è§å­ç±»ThreadPoolExecutor <ul><li><code>void execute(Runnable command)</code> ï¼šæ‰§è¡Œä»»åŠ¡/å‘½ä»¤ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡ŒRunnable</li><li><code>&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task)</code>ï¼šæ‰§è¡Œä»»åŠ¡ï¼Œæœ‰è¿”å›å€¼ï¼Œä¸€èˆ¬åˆæ¥æ‰§è¡ŒCallable</li><li><code>void shutdown()</code> ï¼šå…³é—­è¿æ¥æ± </li></ul></li><li><code>Executors</code>ï¼šä¸€ä¸ªçº¿ç¨‹æ± çš„å·¥å‚ç±»ï¼Œé€šè¿‡æ­¤ç±»çš„é™æ€å·¥å‚æ–¹æ³•å¯ä»¥åˆ›å»ºå¤šç§ç±»å‹çš„çº¿ç¨‹æ± å¯¹è±¡ã€‚ <ul><li><code>Executors.newCachedThreadPool()</code>ï¼šåˆ›å»ºä¸€ä¸ªå¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± </li><li><code>Executors.newFixedThreadPool(int nThreads)</code>; åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± </li><li><code>Executors.newSingleThreadExecutor()</code> ï¼šåˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </li><li><code>Executors.newScheduledThreadPool(int corePoolSize)</code>ï¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå®ƒå¯å®‰æ’åœ¨ç»™å®šå»¶è¿Ÿåè¿è¡Œå‘½ä»¤æˆ–è€…å®šæœŸåœ°æ‰§è¡Œã€‚</li></ul></li></ul><p><strong>ä»£ç ä¸¾ä¾‹ï¼š</strong></p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(i </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">                System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Runnable</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(i </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">                System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(Thread.</span><span style="color:#B392F0;">currentThread</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> i);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Callable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    @</span><span style="color:#F97583;">Override</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> Object </span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">throws</span><span style="color:#E1E4E8;"> Exception {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> evenSum </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span><span style="color:#6A737D;">//è®°å½•å¶æ•°çš„å’Œ</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;i </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(i </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">                evenSum </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> i;</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> evenSum;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ThreadPoolTest</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">String</span><span style="color:#E1E4E8;">[] </span><span style="color:#FFAB70;">args</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//1. æä¾›æŒ‡å®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± </span></span>
<span class="line"><span style="color:#E1E4E8;">        ExecutorService service </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Executors.</span><span style="color:#B392F0;">newFixedThreadPool</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        ThreadPoolExecutor service1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (ThreadPoolExecutor) service;</span></span>
<span class="line"><span style="color:#6A737D;">//        //è®¾ç½®çº¿ç¨‹æ± çš„å±æ€§</span></span>
<span class="line"><span style="color:#6A737D;">//        System.out.println(service.getClass());//ThreadPoolExecutor</span></span>
<span class="line"><span style="color:#E1E4E8;">        service1.</span><span style="color:#B392F0;">setMaximumPoolSize</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">//è®¾ç½®çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°çš„ä¸Šé™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//2.æ‰§è¡ŒæŒ‡å®šçš„çº¿ç¨‹çš„æ“ä½œã€‚éœ€è¦æä¾›å®ç°Runnableæ¥å£æˆ–Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">        service.</span><span style="color:#B392F0;">execute</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread</span><span style="color:#E1E4E8;">());</span><span style="color:#6A737D;">//é€‚ç”¨äºRunnable</span></span>
<span class="line"><span style="color:#E1E4E8;">        service.</span><span style="color:#B392F0;">execute</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread1</span><span style="color:#E1E4E8;">());</span><span style="color:#6A737D;">//é€‚ç”¨äºRunnable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            Future future </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> service.</span><span style="color:#B392F0;">submit</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NumberThread2</span><span style="color:#E1E4E8;">());</span><span style="color:#6A737D;">//é€‚åˆä½¿ç”¨äºCallable</span></span>
<span class="line"><span style="color:#E1E4E8;">            System.out.</span><span style="color:#B392F0;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;æ€»å’Œä¸ºï¼š&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> future.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (Exception </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            e.</span><span style="color:#B392F0;">printStackTrace</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//3.å…³é—­è¿æ¥æ± </span></span>
<span class="line"><span style="color:#E1E4E8;">        service.</span><span style="color:#B392F0;">shutdown</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(i </span><span style="color:#D73A49;">%</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Runnable</span><span style="color:#24292E;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(i </span><span style="color:#D73A49;">%</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Thread.</span><span style="color:#6F42C1;">currentThread</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> i);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Callable</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">call</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Exception {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> evenSum </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">//è®°å½•å¶æ•°çš„å’Œ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;i </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(i </span><span style="color:#D73A49;">%</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">                evenSum </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> i;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> evenSum;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ThreadPoolTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//1. æä¾›æŒ‡å®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± </span></span>
<span class="line"><span style="color:#24292E;">        ExecutorService service </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Executors.</span><span style="color:#6F42C1;">newFixedThreadPool</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        ThreadPoolExecutor service1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (ThreadPoolExecutor) service;</span></span>
<span class="line"><span style="color:#6A737D;">//        //è®¾ç½®çº¿ç¨‹æ± çš„å±æ€§</span></span>
<span class="line"><span style="color:#6A737D;">//        System.out.println(service.getClass());//ThreadPoolExecutor</span></span>
<span class="line"><span style="color:#24292E;">        service1.</span><span style="color:#6F42C1;">setMaximumPoolSize</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">//è®¾ç½®çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°çš„ä¸Šé™</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//2.æ‰§è¡ŒæŒ‡å®šçš„çº¿ç¨‹çš„æ“ä½œã€‚éœ€è¦æä¾›å®ç°Runnableæ¥å£æˆ–Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        service.</span><span style="color:#6F42C1;">execute</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread</span><span style="color:#24292E;">());</span><span style="color:#6A737D;">//é€‚ç”¨äºRunnable</span></span>
<span class="line"><span style="color:#24292E;">        service.</span><span style="color:#6F42C1;">execute</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread1</span><span style="color:#24292E;">());</span><span style="color:#6A737D;">//é€‚ç”¨äºRunnable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            Future future </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> service.</span><span style="color:#6F42C1;">submit</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NumberThread2</span><span style="color:#24292E;">());</span><span style="color:#6A737D;">//é€‚åˆä½¿ç”¨äºCallable</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ€»å’Œä¸ºï¼š&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> future.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (Exception </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            e.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//3.å…³é—­è¿æ¥æ± </span></span>
<span class="line"><span style="color:#24292E;">        service.</span><span style="color:#6F42C1;">shutdown</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div>`,278),k=[m];function T(v,q,S,w,f,j){return n(),a("div",null,k)}const x=s(b,[["render",T]]);export{_ as __pageData,x as default};
