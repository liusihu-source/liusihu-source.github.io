import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.a7175731.js";const o="/assets/image-20231115132159260.366d40ca.png",p="/assets/image-20231116101608425.26c8d060.png",e="/assets/image-20231116101627983.50f6ea32.png",t="/assets/image-20231116101646993.ba5234b1.png",c="/assets/image-20231116095510711.eeaff2c4.png",A=JSON.parse('{"title":"Blob --ç¬”è®°","description":"","frontmatter":{},"headers":[],"relativePath":"æ•°æ®åº“/å¸¸è¯†/Blob.md","filePath":"æ•°æ®åº“/å¸¸è¯†/Blob.md","lastUpdated":null}'),r={name:"æ•°æ®åº“/å¸¸è¯†/Blob.md"},E=l('<h1 id="blob-ç¬”è®°" tabindex="-1">Blob --ç¬”è®° <a class="header-anchor" href="#blob-ç¬”è®°" aria-label="Permalink to &quot;Blob --ç¬”è®°&quot;">â€‹</a></h1><h2 id="ä¸€ã€blob-æ¦‚å¿µ" tabindex="-1">ä¸€ã€Blob æ¦‚å¿µ <a class="header-anchor" href="#ä¸€ã€blob-æ¦‚å¿µ" aria-label="Permalink to &quot;ä¸€ã€Blob æ¦‚å¿µ&quot;">â€‹</a></h2><ul><li>Blobï¼ˆBinary Large Objectï¼‰è¡¨ç¤ºäºŒè¿›åˆ¶ç±»å‹çš„å¤§å¯¹è±¡</li><li>åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå°†äºŒè¿›åˆ¶æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªå•ä¸€ä¸ªä½“çš„é›†åˆã€‚Blob é€šå¸¸æ˜¯å½±åƒã€å£°éŸ³æˆ–å¤šåª’ä½“æ–‡ä»¶ã€‚</li><li><strong>åœ¨ JavaScript ä¸­ Blob ç±»å‹çš„å¯¹è±¡è¡¨ç¤ºä¸å¯å˜çš„ç±»ä¼¼æ–‡ä»¶å¯¹è±¡çš„åŸå§‹æ•°æ®ã€‚</strong></li></ul><h2 id="äºŒã€blob-apiç®€ä»‹" tabindex="-1">äºŒã€Blob APIç®€ä»‹ <a class="header-anchor" href="#äºŒã€blob-apiç®€ä»‹" aria-label="Permalink to &quot;äºŒã€Blob APIç®€ä»‹&quot;">â€‹</a></h2><p><img src="'+o+`" alt="image-20231115132159260"></p><h3 id="_2-1-æ„é€ å‡½æ•°" tabindex="-1">2.1 æ„é€ å‡½æ•° <a class="header-anchor" href="#_2-1-æ„é€ å‡½æ•°" aria-label="Permalink to &quot;2.1 æ„é€ å‡½æ•°&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> aBlob </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Blob</span><span style="color:#E1E4E8;">(blobParts, options);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> aBlob </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Blob</span><span style="color:#24292E;">(blobParts, options);</span></span></code></pre></div><ul><li><p>blobPartsï¼šå®ƒæ˜¯ä¸€ä¸ªç”± ArrayBufferï¼ŒArrayBufferViewï¼ŒBlobï¼ŒDOMString ç­‰å¯¹è±¡æ„æˆçš„æ•°ç»„ã€‚DOMStrings ä¼šè¢«ç¼–ç ä¸º UTF-8ã€‚</p></li><li><p>optionsï¼šä¸€ä¸ªå¯é€‰çš„å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹ä¸¤ä¸ªå±æ€§ï¼š</p></li><li><ul><li>type â€”â€” é»˜è®¤å€¼ä¸º <code>&quot;&quot;</code>ï¼Œå®ƒä»£è¡¨äº†å°†ä¼šè¢«æ”¾å…¥åˆ° blob ä¸­çš„æ•°ç»„å†…å®¹çš„ MIME ç±»å‹ã€‚</li><li>endings â€”â€” é»˜è®¤å€¼ä¸º <code>&quot;transparent&quot;</code>ï¼Œç”¨äºæŒ‡å®šåŒ…å«è¡Œç»“æŸç¬¦ <code>\\n</code> çš„å­—ç¬¦ä¸²å¦‚ä½•è¢«å†™å…¥ã€‚å®ƒæ˜¯ä»¥ä¸‹ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªï¼š<code>&quot;native&quot;</code>ï¼Œä»£è¡¨è¡Œç»“æŸç¬¦ä¼šè¢«æ›´æ”¹ä¸ºé€‚åˆå®¿ä¸»æ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¢è¡Œç¬¦ï¼Œæˆ–è€… <code>&quot;transparent&quot;</code>ï¼Œä»£è¡¨ä¼šä¿æŒ blob ä¸­ä¿å­˜çš„ç»“æŸç¬¦ä¸å˜ã€‚</li></ul></li></ul><h3 id="_2-2-ä½¿ç”¨ç¤ºä¾‹" tabindex="-1">2.2 ä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#_2-2-ä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to &quot;2.2 ä½¿ç”¨ç¤ºä¾‹&quot;">â€‹</a></h3><p>ä»å­—ç¬¦ä¸²åˆ›å»ºBlob</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> myBlobParts </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&#39;&lt;html&gt;&lt;h2&gt;Hello Semlinker&lt;/h2&gt;&lt;/html&gt;&#39;</span><span style="color:#E1E4E8;">]; </span><span style="color:#6A737D;">// an array consisting of a single DOMString</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> myBlob </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Blob</span><span style="color:#E1E4E8;">(myBlobParts, {type : </span><span style="color:#9ECBFF;">&#39;text/html&#39;</span><span style="color:#E1E4E8;">, endings: </span><span style="color:#9ECBFF;">&quot;transparent&quot;</span><span style="color:#E1E4E8;">}); </span><span style="color:#6A737D;">// the blob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(myBlob.size </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; bytes size&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// Output: 37 bytes size</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(myBlob.type </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; is the type&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// Output: text/html is the type</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> myBlobParts </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&#39;&lt;html&gt;&lt;h2&gt;Hello Semlinker&lt;/h2&gt;&lt;/html&gt;&#39;</span><span style="color:#24292E;">]; </span><span style="color:#6A737D;">// an array consisting of a single DOMString</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> myBlob </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Blob</span><span style="color:#24292E;">(myBlobParts, {type : </span><span style="color:#032F62;">&#39;text/html&#39;</span><span style="color:#24292E;">, endings: </span><span style="color:#032F62;">&quot;transparent&quot;</span><span style="color:#24292E;">}); </span><span style="color:#6A737D;">// the blob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(myBlob.size </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; bytes size&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// Output: 37 bytes size</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(myBlob.type </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; is the type&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// Output: text/html is the type</span></span></code></pre></div><p>ä»ç±»å‹åŒ–æ•°ç»„å’Œå­—ç¬¦ä¸²åˆ›å»º Blob</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> hello </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Uint8Array</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">72</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">101</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">108</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">108</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">111</span><span style="color:#E1E4E8;">]); </span><span style="color:#6A737D;">// äºŒè¿›åˆ¶æ ¼å¼çš„ &quot;hello&quot;</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> blob </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Blob</span><span style="color:#E1E4E8;">([hello, </span><span style="color:#9ECBFF;">&#39; &#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;semlinker&#39;</span><span style="color:#E1E4E8;">], {type: </span><span style="color:#9ECBFF;">&#39;text/plain&#39;</span><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> hello </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Uint8Array</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">72</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">101</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">108</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">108</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">111</span><span style="color:#24292E;">]); </span><span style="color:#6A737D;">// äºŒè¿›åˆ¶æ ¼å¼çš„ &quot;hello&quot;</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> blob </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Blob</span><span style="color:#24292E;">([hello, </span><span style="color:#032F62;">&#39; &#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;semlinker&#39;</span><span style="color:#24292E;">], {type: </span><span style="color:#032F62;">&#39;text/plain&#39;</span><span style="color:#24292E;">});</span></span></code></pre></div><p>ğŸ’¡ <code>Uint8Array</code> æ˜¯ JavaScript ä¸­çš„ä¸€ç§ç±»å‹åŒ–æ•°ç»„ï¼ˆTypedArrayï¼‰ã€‚åœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ä¸­ï¼Œ<code>new Uint8Array([72, 101, 108, 108, 111])</code> åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ•°å­—æ•°ç»„ <code>[72, 101, 108, 108, 111]</code> çš„ <code>Uint8Array</code> å®ä¾‹ã€‚</p><p>è¿™ä¸ªæ•°ç»„å­˜å‚¨çš„æ˜¯ 8 ä½æ— ç¬¦å·æ•´æ•°å€¼ï¼ˆå–å€¼èŒƒå›´æ˜¯ 0 åˆ° 255ï¼‰ï¼Œå› æ­¤ <code>Uint8Array</code> è¡¨ç¤ºäº†ä¸€ä¸ªåŒ…å« ASCII å€¼çš„æ•°ç»„ã€‚è¿™äº› ASCII å€¼å¯¹åº”çš„å­—ç¬¦æ˜¯ <code>&#39;H&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;</code>ï¼Œå› ä¸º ASCII ä¸­çš„ <code>72</code> å¯¹åº” <code>&#39;H&#39;</code>ï¼Œ<code>101</code> å¯¹åº” <code>&#39;e&#39;</code>ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>æ‰€ä»¥ï¼Œ<code>let hello = new Uint8Array([72, 101, 108, 108, 111]);</code> è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸² <code>&#39;Hello&#39;</code> å¯¹åº” ASCII ç å€¼çš„ <code>Uint8Array</code> æ•°ç»„ã€‚</p><h3 id="_2-3-å±æ€§" tabindex="-1">2.3 å±æ€§ <a class="header-anchor" href="#_2-3-å±æ€§" aria-label="Permalink to &quot;2.3 å±æ€§&quot;">â€‹</a></h3><ul><li>sizeï¼ˆåªè¯»ï¼‰ï¼šè¡¨ç¤º <code>Blob</code> å¯¹è±¡ä¸­æ‰€åŒ…å«æ•°æ®çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li><li>typeï¼ˆåªè¯»ï¼‰ï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜è¯¥ <code>Blob</code> å¯¹è±¡æ‰€åŒ…å«æ•°æ®çš„ MIME ç±»å‹ã€‚å¦‚æœç±»å‹æœªçŸ¥ï¼Œåˆ™è¯¥å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li></ul><h3 id="_2-4-æ–¹æ³•" tabindex="-1">2.4 æ–¹æ³• <a class="header-anchor" href="#_2-4-æ–¹æ³•" aria-label="Permalink to &quot;2.4 æ–¹æ³•&quot;">â€‹</a></h3><ul><li>slice([start[, end[, contentType]]])ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ Blob å¯¹è±¡ï¼ŒåŒ…å«äº†æº Blob å¯¹è±¡ä¸­æŒ‡å®šèŒƒå›´å†…çš„æ•°æ®ã€‚</li><li>stream()ï¼šè¿”å›ä¸€ä¸ªèƒ½è¯»å– blob å†…å®¹çš„ <code>ReadableStream</code>ã€‚</li><li>text()ï¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ä¸”åŒ…å« blob æ‰€æœ‰å†…å®¹çš„ UTF-8 æ ¼å¼çš„ <code>USVString</code>ã€‚</li><li>arrayBuffer()ï¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ä¸”åŒ…å« blob æ‰€æœ‰å†…å®¹çš„äºŒè¿›åˆ¶æ ¼å¼çš„ <code>ArrayBuffer</code>ã€‚</li></ul><p>ğŸ’¡ è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong><code>Blob</code> å¯¹è±¡æ˜¯ä¸å¯æ”¹å˜çš„</strong>ã€‚æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ä¸€ä¸ª Blob ä¸­æ›´æ”¹æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ª Blob è¿›è¡Œåˆ†å‰²ï¼Œä»å…¶ä¸­åˆ›å»ºæ–°çš„ Blob å¯¹è±¡ï¼Œå°†å®ƒä»¬æ··åˆåˆ°ä¸€ä¸ªæ–°çš„ Blob ä¸­ã€‚è¿™ç§è¡Œä¸ºç±»ä¼¼äº JavaScript å­—ç¬¦ä¸²ï¼šæˆ‘ä»¬æ— æ³•æ›´æ”¹å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œä½†å¯ä»¥åˆ›å»ºæ–°çš„æ›´æ­£åçš„å­—ç¬¦ä¸²ã€‚</p><h2 id="ä¸‰ã€blobä½¿ç”¨åœºæ™¯" tabindex="-1">ä¸‰ã€Blobä½¿ç”¨åœºæ™¯ <a class="header-anchor" href="#ä¸‰ã€blobä½¿ç”¨åœºæ™¯" aria-label="Permalink to &quot;ä¸‰ã€Blobä½¿ç”¨åœºæ™¯&quot;">â€‹</a></h2><blockquote><p>Blob åˆ™è¡¨ç¤ºâ€œå…·æœ‰ç±»å‹çš„äºŒè¿›åˆ¶æ•°æ®â€ã€‚</p><p>è¿™æ ·å¯ä»¥æ–¹ä¾¿ <code>Blob</code> ç”¨äºåœ¨æµè§ˆå™¨ä¸­éå¸¸å¸¸è§çš„ä¸Šä¼ /ä¸‹è½½æ“ä½œã€‚</p></blockquote><h3 id="_3-1-æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ " tabindex="-1">3.1 æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼  <a class="header-anchor" href="#_3-1-æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ " aria-label="Permalink to &quot;3.1 æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ &quot;">â€‹</a></h3><p>File å¯¹è±¡æ˜¯ç‰¹æ®Šç±»å‹çš„ Blobï¼Œä¸”å¯ä»¥ç”¨åœ¨ä»»æ„çš„ Blob ç±»å‹çš„ä¸Šä¸‹æ–‡ä¸­ã€‚æ‰€ä»¥é’ˆå¯¹å¤§æ–‡ä»¶ä¼ è¾“çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ slice æ–¹æ³•å¯¹å¤§æ–‡ä»¶è¿›è¡Œåˆ‡å‰²ï¼Œç„¶ååˆ†ç‰‡è¿›è¡Œä¸Šä¼ ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">file</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">File</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&quot;a&quot;</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000000</span><span style="color:#E1E4E8;">)], </span><span style="color:#9ECBFF;">&quot;test.txt&quot;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">//åˆ›å»ºäº†ä¸€ä¸ªåä¸º test.txt çš„æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ç”± a å­—ç¬¦ä¸²é‡å¤ç»„æˆçš„ 1,000,000 å­—ç¬¦ä¸²ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">chunkSize</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">40000</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">//å®šä¹‰äº†æ¯ä¸ªæ–‡ä»¶åˆ†å—çš„å¤§å°ä¸º 40,000 å­—èŠ‚ã€‚</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;https://httpbin.org/post&quot;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">//å£°æ˜äº†ä¸Šä¼ æ–‡ä»¶çš„ç›®æ ‡ URLã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">chunkedUpload</span><span style="color:#E1E4E8;">() { </span><span style="color:#6A737D;">//å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° chunkedUploadï¼Œå®ƒç”¨äºå°†æ–‡ä»¶åˆ†å—ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> start </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; start </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> file.size; start </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> chunkSize) {  </span><span style="color:#6A737D;">//å¾ªç¯éå†æ–‡ä»¶å†…å®¹ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ†å—ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">chunk</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> file.</span><span style="color:#B392F0;">slice</span><span style="color:#E1E4E8;">(start, start </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> chunkSize </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">//ä»æ–‡ä»¶ä¸­åˆ‡å‰²å‡ºä¸€ä¸ªå¤§å°ä¸º chunkSize çš„æ–‡ä»¶åˆ†å—ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">fd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">FormData</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">      fd.</span><span style="color:#B392F0;">append</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;data&quot;</span><span style="color:#E1E4E8;">, chunk);</span><span style="color:#6A737D;">//åˆ›å»ºä¸€ä¸ª FormData å¯¹è±¡å¹¶å°†æ–‡ä»¶åˆ†å—æ·»åŠ åˆ°å…¶ä¸­ï¼Œä»¥ä¾¿ç”¨äº HTTP POST è¯·æ±‚ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(url, { method: </span><span style="color:#9ECBFF;">&quot;post&quot;</span><span style="color:#E1E4E8;">, body: fd }).</span><span style="color:#B392F0;">then</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">res</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        res.</span><span style="color:#B392F0;">text</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">      );</span><span style="color:#6A737D;">//ä½¿ç”¨ Fetch API å‘é€ POST è¯·æ±‚å°†æ–‡ä»¶åˆ†å—ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ res.text() æ–¹æ³•è¯»å–æœåŠ¡å™¨å“åº”çš„æ–‡æœ¬æ•°æ®ã€‚await å…³é”®å­—ç¡®ä¿æ¯ä¸ªåˆ†å—éƒ½ä¸Šä¼ å®Œæ¯•åå†ç»§ç»­ä¸‹ä¸€ä¸ªåˆ†å—çš„ä¸Šä¼ ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">file</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000000</span><span style="color:#24292E;">)], </span><span style="color:#032F62;">&quot;test.txt&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">//åˆ›å»ºäº†ä¸€ä¸ªåä¸º test.txt çš„æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ç”± a å­—ç¬¦ä¸²é‡å¤ç»„æˆçš„ 1,000,000 å­—ç¬¦ä¸²ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">chunkSize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">40000</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">//å®šä¹‰äº†æ¯ä¸ªæ–‡ä»¶åˆ†å—çš„å¤§å°ä¸º 40,000 å­—èŠ‚ã€‚</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;https://httpbin.org/post&quot;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">//å£°æ˜äº†ä¸Šä¼ æ–‡ä»¶çš„ç›®æ ‡ URLã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">chunkedUpload</span><span style="color:#24292E;">() { </span><span style="color:#6A737D;">//å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•° chunkedUploadï¼Œå®ƒç”¨äºå°†æ–‡ä»¶åˆ†å—ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> start </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; start </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> file.size; start </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> chunkSize) {  </span><span style="color:#6A737D;">//å¾ªç¯éå†æ–‡ä»¶å†…å®¹ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ†å—ã€‚</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">chunk</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> file.</span><span style="color:#6F42C1;">slice</span><span style="color:#24292E;">(start, start </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> chunkSize </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">//ä»æ–‡ä»¶ä¸­åˆ‡å‰²å‡ºä¸€ä¸ªå¤§å°ä¸º chunkSize çš„æ–‡ä»¶åˆ†å—ã€‚</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">fd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">FormData</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">      fd.</span><span style="color:#6F42C1;">append</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;data&quot;</span><span style="color:#24292E;">, chunk);</span><span style="color:#6A737D;">//åˆ›å»ºä¸€ä¸ª FormData å¯¹è±¡å¹¶å°†æ–‡ä»¶åˆ†å—æ·»åŠ åˆ°å…¶ä¸­ï¼Œä»¥ä¾¿ç”¨äº HTTP POST è¯·æ±‚ã€‚</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(url, { method: </span><span style="color:#032F62;">&quot;post&quot;</span><span style="color:#24292E;">, body: fd }).</span><span style="color:#6F42C1;">then</span><span style="color:#24292E;">((</span><span style="color:#E36209;">res</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">        res.</span><span style="color:#6F42C1;">text</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">      );</span><span style="color:#6A737D;">//ä½¿ç”¨ Fetch API å‘é€ POST è¯·æ±‚å°†æ–‡ä»¶åˆ†å—ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ res.text() æ–¹æ³•è¯»å–æœåŠ¡å™¨å“åº”çš„æ–‡æœ¬æ•°æ®ã€‚await å…³é”®å­—ç¡®ä¿æ¯ä¸ªåˆ†å—éƒ½ä¸Šä¼ å®Œæ¯•åå†ç»§ç»­ä¸‹ä¸€ä¸ªåˆ†å—çš„ä¸Šä¼ ã€‚</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_3-2-blob-ç”¨ä½œ-url-ä¸‹è½½äº’è”ç½‘æ•°æ®" tabindex="-1">3.2 Blob ç”¨ä½œ URL â­ ä¸‹è½½äº’è”ç½‘æ•°æ® <a class="header-anchor" href="#_3-2-blob-ç”¨ä½œ-url-ä¸‹è½½äº’è”ç½‘æ•°æ®" aria-label="Permalink to &quot;3.2 Blob ç”¨ä½œ URL :star: ä¸‹è½½äº’è”ç½‘æ•°æ®&quot;">â€‹</a></h3><p>ğŸ’¡ <strong>Blob URL/Object URL</strong></p><p>Blob URL/Object URL æ˜¯ä¸€ç§ä¼ªåè®®ï¼Œå…è®¸ Blob å’Œ File å¯¹è±¡ç”¨ä½œå›¾åƒï¼Œä¸‹è½½äºŒè¿›åˆ¶æ•°æ®é“¾æ¥ç­‰çš„ URL æºã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>URL.createObjectURL</code> æ–¹æ³•æ¥åˆ›å»º Blob URLï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ª <code>Blob</code> å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ URLï¼Œå…¶å½¢å¼ä¸º <code>blob:&lt;origin&gt;/&lt;uuid&gt;</code>ï¼Œå¯¹åº”çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">blob:https://example.org/40a5fb5a-d56d-4a33-b4e2-0acf6a8e5f641</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">blob:https://example.org/40a5fb5a-d56d-4a33-b4e2-0acf6a8e5f641</span></span></code></pre></div><p>å½“ fetch è¯·æ±‚æˆåŠŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬è°ƒç”¨ response å¯¹è±¡çš„ <code>blob()</code> æ–¹æ³•ï¼Œä» response å¯¹è±¡ä¸­è¯»å–ä¸€ä¸ª Blob å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ <code>createObjectURL()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ª objectURLï¼Œç„¶åæŠŠå®ƒèµ‹å€¼ç»™ <code>img</code> å…ƒç´ çš„ <code>src</code> å±æ€§ä»è€Œæ˜¾ç¤ºè¿™å¼ å›¾ç‰‡ã€‚</p><p>æµè§ˆå™¨å†…éƒ¨ä¸ºæ¯ä¸ªé€šè¿‡ <code>URL.createObjectURL</code> ç”Ÿæˆçš„ URL å­˜å‚¨äº†ä¸€ä¸ª URL â†’ Blob æ˜ å°„ã€‚å› æ­¤ï¼Œæ­¤ç±» URL è¾ƒçŸ­ï¼Œä½†å¯ä»¥è®¿é—® <code>Blob</code>ã€‚ç”Ÿæˆçš„ URL ä»…åœ¨å½“å‰æ–‡æ¡£æ‰“å¼€çš„çŠ¶æ€ä¸‹æ‰æœ‰æ•ˆã€‚å®ƒå…è®¸å¼•ç”¨ <code>&lt;img&gt;</code>ã€<code>&lt;a&gt;</code> ä¸­çš„ <code>Blob</code>ï¼Œä½†å¦‚æœä½ è®¿é—®çš„ Blob URL ä¸å†å­˜åœ¨ï¼Œåˆ™ä¼šä»æµè§ˆå™¨ä¸­æ”¶åˆ° 404 é”™è¯¯ã€‚</p><p>ä¸Šè¿°çš„ Blob URL çœ‹ä¼¼å¾ˆä¸é”™ï¼Œä½†å®é™…ä¸Šå®ƒä¹Ÿæœ‰å‰¯ä½œç”¨ã€‚è™½ç„¶å­˜å‚¨äº† URL â†’ Blob çš„æ˜ å°„ï¼Œä½† Blob æœ¬èº«ä»é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œæµè§ˆå™¨æ— æ³•é‡Šæ”¾å®ƒã€‚æ˜ å°„åœ¨æ–‡æ¡£å¸è½½æ—¶è‡ªåŠ¨æ¸…é™¤ï¼Œå› æ­¤ Blob å¯¹è±¡éšåè¢«é‡Šæ”¾ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå¯¿å‘½å¾ˆé•¿ï¼Œé‚£ä¸ä¼šå¾ˆå¿«å‘ç”Ÿã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Blob URLï¼Œå³ä½¿ä¸å†éœ€è¦è¯¥ Blobï¼Œå®ƒä¹Ÿä¼šå­˜åœ¨å†…å­˜ä¸­ã€‚</p><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>URL.revokeObjectURL(url)</code> æ–¹æ³•ï¼Œä»å†…éƒ¨æ˜ å°„ä¸­åˆ é™¤å¼•ç”¨ï¼Œä»è€Œå…è®¸åˆ é™¤ Blobï¼ˆå¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼‰ï¼Œå¹¶é‡Šæ”¾å†…å­˜ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Blob æ–‡ä»¶ä¸‹è½½çš„å…·ä½“ç¤ºä¾‹ã€‚</p><p>blobæ–‡ä»¶ä¸‹è½½ç¤ºä¾‹</p><p><strong>index.html</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;!</span><span style="color:#79B8FF;">DOCTYPE</span><span style="color:#E1E4E8;"> html</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">html</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#B392F0;">head</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">meta charset</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;UTF-8&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#B392F0;">title</span><span style="color:#E1E4E8;">&gt;Blob æ–‡ä»¶ä¸‹è½½ç¤ºä¾‹</span><span style="color:#F97583;">&lt;/</span><span style="color:#E1E4E8;">title</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">&lt;/</span><span style="color:#E1E4E8;">head</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#B392F0;">body</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">button id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;downloadBtn&quot;</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">æ–‡ä»¶ä¸‹è½½</span><span style="color:#F97583;">&lt;/</span><span style="color:#E1E4E8;">button</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">script src</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;index.js&quot;</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">&lt;/</span><span style="color:#B392F0;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">&lt;/</span><span style="color:#E1E4E8;">body</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">&lt;/</span><span style="color:#E1E4E8;">html</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;!</span><span style="color:#005CC5;">DOCTYPE</span><span style="color:#24292E;"> html</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">html</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#6F42C1;">head</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">meta charset</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;UTF-8&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#6F42C1;">title</span><span style="color:#24292E;">&gt;Blob æ–‡ä»¶ä¸‹è½½ç¤ºä¾‹</span><span style="color:#D73A49;">&lt;/</span><span style="color:#24292E;">title</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">&lt;/</span><span style="color:#24292E;">head</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#6F42C1;">body</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">button id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;downloadBtn&quot;</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">æ–‡ä»¶ä¸‹è½½</span><span style="color:#D73A49;">&lt;/</span><span style="color:#24292E;">button</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">script src</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;index.js&quot;</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">&lt;/</span><span style="color:#6F42C1;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">&lt;/</span><span style="color:#24292E;">body</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">&lt;/</span><span style="color:#24292E;">html</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p><strong>index.js</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">download</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">fileName</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">blob</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">link</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">createElement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;a&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  link.href </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">URL</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">createObjectURL</span><span style="color:#E1E4E8;">(blob);</span></span>
<span class="line"><span style="color:#E1E4E8;">  link.download </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> fileName;</span></span>
<span class="line"><span style="color:#E1E4E8;">  link.</span><span style="color:#B392F0;">click</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  link.</span><span style="color:#B392F0;">remove</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">URL</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">revokeObjectURL</span><span style="color:#E1E4E8;">(link.href);</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">downloadBtn</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">querySelector</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;#downloadBtn&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">downloadBtn.</span><span style="color:#B392F0;">addEventListener</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;click&quot;</span><span style="color:#E1E4E8;">, (</span><span style="color:#FFAB70;">event</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">fileName</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;blob.txt&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">myBlob</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Blob</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&quot;ä¸€æ–‡å½»åº•æŒæ¡ Blob Web API&quot;</span><span style="color:#E1E4E8;">], { type: </span><span style="color:#9ECBFF;">&quot;text/plain&quot;</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">download</span><span style="color:#E1E4E8;">(fileName, myBlob);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">download</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">fileName</span><span style="color:#24292E;">, </span><span style="color:#E36209;">blob</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">link</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;a&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  link.href </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">URL</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">createObjectURL</span><span style="color:#24292E;">(blob);</span></span>
<span class="line"><span style="color:#24292E;">  link.download </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> fileName;</span></span>
<span class="line"><span style="color:#24292E;">  link.</span><span style="color:#6F42C1;">click</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  link.</span><span style="color:#6F42C1;">remove</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">URL</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">revokeObjectURL</span><span style="color:#24292E;">(link.href);</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">downloadBtn</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">querySelector</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;#downloadBtn&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">downloadBtn.</span><span style="color:#6F42C1;">addEventListener</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;click&quot;</span><span style="color:#24292E;">, (</span><span style="color:#E36209;">event</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">fileName</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;blob.txt&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">myBlob</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Blob</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&quot;ä¸€æ–‡å½»åº•æŒæ¡ Blob Web API&quot;</span><span style="color:#24292E;">], { type: </span><span style="color:#032F62;">&quot;text/plain&quot;</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">download</span><span style="color:#24292E;">(fileName, myBlob);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><p>åœ¨ç¤ºä¾‹ä¸­ï¼Œé€šè¿‡è°ƒç”¨ Blob çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºç±»å‹ä¸º <strong>&quot;text/plain&quot;</strong> çš„ Blob å¯¹è±¡ï¼Œç„¶åé€šè¿‡åŠ¨æ€åˆ›å»º <code>a</code> æ ‡ç­¾æ¥å®ç°æ–‡ä»¶çš„ä¸‹è½½ã€‚</p><p><img src="`+p+'" alt="image-20231116101608425"></p><p><img src="'+e+'" alt="image-20231116101627983"></p><p><img src="'+t+'" alt="image-20231116101646993"></p><h3 id="_3-3-blob-è½¬æ¢ä¸º-base64-ä¸Šä¼ " tabindex="-1">3.3 Blob è½¬æ¢ä¸º Base64 â­ ä¸Šä¼  <a class="header-anchor" href="#_3-3-blob-è½¬æ¢ä¸º-base64-ä¸Šä¼ " aria-label="Permalink to &quot;3.3 Blob è½¬æ¢ä¸º Base64 :star: ä¸Šä¼ &quot;">â€‹</a></h3><p>åœ¨ç¼–å†™ HTML ç½‘é¡µæ—¶ï¼Œå¯¹äºä¸€äº›ç®€å•å›¾ç‰‡ï¼Œé€šå¸¸ä¼šé€‰æ‹©å°†å›¾ç‰‡å†…å®¹ç›´æ¥å†…åµŒåœ¨ç½‘é¡µä¸­ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯å›¾ç‰‡æ•°æ®æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè¯¥æ€ä¹ˆåµŒå…¥å‘¢ï¼Ÿç»å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒä¸€ç§åä¸º <code>Data URLs</code> çš„ç‰¹æ€§ï¼Œå…è®¸ä½¿ç”¨ base64 å¯¹å›¾ç‰‡æˆ–å…¶ä»–æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç ï¼Œå°†å…¶ä½œä¸ºæ–‡æœ¬å­—ç¬¦ä¸²åµŒå…¥ç½‘é¡µä¸­ã€‚</p><p>ğŸ’¡ Data URLs ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼šå‰ç¼€ï¼ˆ<code>data:</code>ï¼‰ã€æŒ‡ç¤ºæ•°æ®ç±»å‹çš„ MIME ç±»å‹ã€å¦‚æœéæ–‡æœ¬åˆ™ä¸ºå¯é€‰çš„ <code>base64</code> æ ‡è®°ã€æ•°æ®æœ¬èº«ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</span></span></code></pre></div><p><code>mediatype</code> æ˜¯ä¸ª MIME ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &quot;<code>image/jpeg</code>&quot; è¡¨ç¤º JPEG å›¾åƒæ–‡ä»¶ã€‚å¦‚æœè¢«çœç•¥ï¼Œåˆ™é»˜è®¤å€¼ä¸º <code>text/plain;charset=US-ASCII</code>ã€‚å¦‚æœæ•°æ®æ˜¯æ–‡æœ¬ç±»å‹ï¼Œä½ å¯ä»¥ç›´æ¥å°†æ–‡æœ¬åµŒå…¥ï¼ˆæ ¹æ®æ–‡æ¡£ç±»å‹ï¼Œä½¿ç”¨åˆé€‚çš„å®ä½“å­—ç¬¦æˆ–è½¬ä¹‰å­—ç¬¦ï¼‰ã€‚å¦‚æœæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ å¯ä»¥å°†æ•°æ®è¿›è¡Œ base64 ç¼–ç ä¹‹åå†è¿›è¡ŒåµŒå…¥ã€‚æ¯”å¦‚åµŒå…¥ä¸€å¼ å›¾ç‰‡ï¼š</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">img</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">alt</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;logo&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">src</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUg...&quot;</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">img</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">alt</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;logo&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUg...&quot;</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p><img src="'+c+`" alt="image-20231116095510711"></p><p>âš ï¸ <strong>å¦‚æœå›¾ç‰‡è¾ƒå¤§ï¼Œå›¾ç‰‡çš„è‰²å½©å±‚æ¬¡æ¯”è¾ƒä¸°å¯Œï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºè¯¥å›¾ç‰‡ç»è¿‡ base64 ç¼–ç åçš„å­—ç¬¦ä¸²éå¸¸å¤§ï¼Œä¼šæ˜æ˜¾å¢å¤§ HTML é¡µé¢çš„å¤§å°ï¼Œä»è€Œå½±å“åŠ è½½é€Ÿåº¦ã€‚</strong></p><p>æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">input</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;file&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">accept</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;image/*&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">onchange</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#B392F0;">loadFile</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">event</span><span style="color:#9ECBFF;">)&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">img</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;output&quot;</span><span style="color:#E1E4E8;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loadFile</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">event</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">reader</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">FileReader</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    reader.</span><span style="color:#B392F0;">onload</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">output</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">querySelector</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;output&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      output.src </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> reader.result;</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"><span style="color:#E1E4E8;">    reader.</span><span style="color:#B392F0;">readAsDataURL</span><span style="color:#E1E4E8;">(event.target.files[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#E1E4E8;">  };</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">input</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;file&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">accept</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;image/*&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onchange</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#6F42C1;">loadFile</span><span style="color:#032F62;">(</span><span style="color:#24292E;">event</span><span style="color:#032F62;">)&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">img</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;output&quot;</span><span style="color:#24292E;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loadFile</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">event</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">reader</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">FileReader</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    reader.</span><span style="color:#6F42C1;">onload</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">output</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">querySelector</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;output&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      output.src </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> reader.result;</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"><span style="color:#24292E;">    reader.</span><span style="color:#6F42C1;">readAsDataURL</span><span style="color:#24292E;">(event.target.files[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>åœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œä¸º file ç±»å‹è¾“å…¥æ¡†ç»‘å®š <code>onchange</code> äº‹ä»¶å¤„ç†å‡½æ•° <code>loadFile</code>ï¼Œåœ¨è¯¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª FileReader å¯¹è±¡å¹¶ä¸ºè¯¥å¯¹è±¡ç»‘å®š <code>onload</code> ç›¸åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œç„¶åè°ƒç”¨ FileReader å¯¹è±¡çš„ <code>readAsDataURL()</code> æ–¹æ³•ï¼ŒæŠŠæœ¬åœ°å›¾ç‰‡å¯¹åº”çš„ File å¯¹è±¡è½¬æ¢ä¸º Data URLã€‚</p><p>åœ¨å®Œæˆæœ¬åœ°å›¾ç‰‡é¢„è§ˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå›¾ç‰‡å¯¹åº”çš„ Data URLs æ•°æ®æäº¤åˆ°æœåŠ¡å™¨ã€‚é’ˆå¯¹è¿™ç§æƒ…å½¢ï¼ŒæœåŠ¡ç«¯éœ€è¦åšä¸€äº›ç›¸å…³å¤„ç†ï¼Œæ‰èƒ½æ­£å¸¸ä¿å­˜ä¸Šä¼ çš„å›¾ç‰‡ï¼Œè¿™é‡Œä»¥ Express ä¸ºä¾‹ï¼Œå…·ä½“å¤„ç†ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">app</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;express&#39;</span><span style="color:#E1E4E8;">)();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">app.</span><span style="color:#B392F0;">post</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;/upload&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">req</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">res</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> imgData </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> req.body.imgData; </span><span style="color:#6A737D;">// è·å–POSTè¯·æ±‚ä¸­çš„base64å›¾ç‰‡æ•°æ®</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> base64Data </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> imgData.</span><span style="color:#B392F0;">replace</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">/</span><span style="color:#F97583;">^</span><span style="color:#DBEDFF;">data:image</span><span style="color:#85E89D;font-weight:bold;">\\/</span><span style="color:#79B8FF;">\\w</span><span style="color:#F97583;">+</span><span style="color:#DBEDFF;">;base64,</span><span style="color:#9ECBFF;">/</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> dataBuffer </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(base64Data, </span><span style="color:#9ECBFF;">&#39;base64&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    fs.</span><span style="color:#B392F0;">writeFile</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;image.png&quot;</span><span style="color:#E1E4E8;">, dataBuffer, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(err){</span></span>
<span class="line"><span style="color:#E1E4E8;">          res.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">          res.</span><span style="color:#B392F0;">send</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">app</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;express&#39;</span><span style="color:#24292E;">)();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">app.</span><span style="color:#6F42C1;">post</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/upload&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">req</span><span style="color:#24292E;">, </span><span style="color:#E36209;">res</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> imgData </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> req.body.imgData; </span><span style="color:#6A737D;">// è·å–POSTè¯·æ±‚ä¸­çš„base64å›¾ç‰‡æ•°æ®</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> base64Data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> imgData.</span><span style="color:#6F42C1;">replace</span><span style="color:#24292E;">(</span><span style="color:#032F62;">/</span><span style="color:#D73A49;">^</span><span style="color:#032F62;">data:image</span><span style="color:#22863A;font-weight:bold;">\\/</span><span style="color:#005CC5;">\\w</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">;base64,/</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> dataBuffer </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Buffer.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(base64Data, </span><span style="color:#032F62;">&#39;base64&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    fs.</span><span style="color:#6F42C1;">writeFile</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;image.png&quot;</span><span style="color:#24292E;">, dataBuffer, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">err</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(err){</span></span>
<span class="line"><span style="color:#24292E;">          res.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(err);</span></span>
<span class="line"><span style="color:#24292E;">        }</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">          res.</span><span style="color:#6F42C1;">send</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div>`,57),y=[E];function i(d,F,u,b,g,B){return a(),n("div",null,y)}const C=s(r,[["render",i]]);export{A as __pageData,C as default};
